<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JahawğŸ¥</title>
  
  
  <link href="https://jahaw.github.io/atom.xml" rel="self"/>
  
  <link href="https://jahaw.github.io/"/>
  <updated>2024-01-05T14:04:24.262Z</updated>
  <id>https://jahaw.github.io/</id>
  
  <author>
    <name>JahawğŸ¥</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.262Z</published>
    <updated>2024-01-05T14:04:24.262Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç›‘å¬-æµè§ˆå™¨-Tab-åˆ‡æ¢">ç›‘å¬ æµè§ˆå™¨ Tab åˆ‡æ¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * åˆ‡æ¢æµè§ˆå™¨çª—å£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">changeWindowsTab</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// chrome sougou</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;webkitVisibilityState&quot;</span> <span class="keyword">in</span> <span class="variable language_">document</span>) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;webkitvisibilitychange&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">webkitVisibilityState</span> === <span class="string">&quot;hidden&quot;</span>) &#123;</span><br><span class="line"><span class="comment">// ç¦»å¼€äº†ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚å…³é—­æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">true</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// å›æ¥äº†ï¼Œå¯¹æ•°æ®å¤„ç†ï¼Œå¦‚å¼€å¯æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">false</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// IE</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;msvisibilitychange&quot;</span> <span class="keyword">in</span> <span class="variable language_">document</span>) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;msvisibilitychange&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">msVisibilityState</span> === <span class="string">&quot;hidden&quot;</span>) &#123;</span><br><span class="line"><span class="comment">// ç¦»å¼€äº†ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚å…³é—­æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">true</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">// å›æ¥äº†ï¼Œå¯¹æ•°æ®å¤„ç†ï¼Œå¦‚å¼€å¯æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">false</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// FF</span></span><br><span class="line">  <span class="keyword">if</span>(<span class="string">&quot;mozvisibilitychange&quot;</span> <span class="keyword">in</span> <span class="variable language_">document</span>) &#123;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mozvisibilitychange&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">mozVisibilityState</span> === <span class="string">&quot;hidden&quot;</span>) &#123;</span><br><span class="line"><span class="comment">// ç¦»å¼€äº†ï¼Œå¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚å…³é—­æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">true</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">// å›æ¥äº†ï¼Œå¯¹æ•°æ®å¤„ç†ï¼Œå¦‚å¼€å¯æµ</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">postMessage</span>(&#123;<span class="attr">leave</span>: <span class="literal">false</span>&#125;, <span class="string">&quot;*&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç›‘å¬æµè§ˆå™¨åˆ·æ–°åŠå…³é—­">ç›‘å¬æµè§ˆå™¨åˆ·æ–°åŠå…³é—­</h3><blockquote><p>onbeforeunload å’Œ onunload éƒ½æ˜¯åœ¨é¡µé¢åˆ·æ–°æˆ–é€€å‡ºæ—¶è§¦å‘çš„äº‹ä»¶</p></blockquote><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æ³•ï¼š</span><br><span class="line"></span><br><span class="line">äº‹ä»¶ç”¨æ³•</span><br><span class="line"><span class="variable">onunload</span><span class="variable">window.onunload</span>=<span class="function"><span class="title">function</span>()&#123;<span class="variable">SomeJavaScriptCode</span>&#125;;</span></span><br><span class="line"><span class="function"><span class="variable">onbeforeunload</span><span class="variable">window.onbeforeunload</span>=<span class="title">function</span>()&#123;<span class="variable">SomeJavaScriptCode</span>&#125;;</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">åŒºåˆ«ï¼š</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">unbeforeunload</span>()æ˜¯åœ¨é¡µé¢åˆ·æ–°æˆ–å…³é—­ä¹‹å‰è§¦å‘çš„äº‹ä»¶ï¼Œè€Œ<span class="title">onubload</span>()æ˜¯åœ¨é¡µé¢åˆ·æ–°æˆ–å…³é—­ä¹‹åæ‰ä¼šè§¦å‘çš„ã€‚</span></span><br><span class="line"><span class="function"><span class="title">unbeforeunload</span>()äº‹ä»¶æ‰§è¡Œçš„é¡ºåºåœ¨<span class="title">onunload</span>()äº‹ä»¶ä¹‹å‰å‘ç”Ÿã€‚</span></span><br><span class="line"><span class="function"><span class="title">unbeforeunload</span>()äº‹ä»¶å¯ä»¥ç¦æ­¢<span class="title">onunload</span>()äº‹ä»¶çš„è§¦å‘ã€‚</span></span><br><span class="line"><span class="function"><span class="title">onunload</span>()äº‹ä»¶æ˜¯æ— æ³•é˜»æ­¢é¡µé¢å…³é—­çš„ã€‚</span></span><br><span class="line"><span class="function"></span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ç›‘å¬-æµè§ˆå™¨-Tab-åˆ‡æ¢&quot;&gt;ç›‘å¬ æµè§ˆå™¨ Tab åˆ‡æ¢&lt;/h3&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.262Z</published>
    <updated>2024-01-05T14:04:24.262Z</updated>
    
    <content type="html"><![CDATA[<h2 id="SVG">SVG</h2><blockquote><p>å¯ç¼©æ”¾çŸ¢é‡å›¾</p></blockquote><h4 id="SVG-æ–‡æ¡£åŸºæœ¬ç»“æ„">SVG æ–‡æ¡£åŸºæœ¬ç»“æ„</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&#x27;140&#x27;</span> <span class="attr">heiight</span>=<span class="string">&#x27;170&#x27;</span> <span class="attr">xmlns</span>=<span class="string">&#x27;http://wwww.w3.org/2000/svg&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Cat<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">desc</span>&gt;</span>Stick Figure of Cat<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- åœ¨è¿™é‡Œç»˜åˆ¶å›¾åƒ --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><svg> ä»¥åƒç´ ä¸ºå•ä½å®šä¹‰äº†æ•´ä¸ªå›¾åƒçš„ width å’Œ heightï¼Œè¿˜é€šè¿‡ xmlns å±æ€§å®šä¹‰äº† SVG çš„å‘½åç©ºé—´</p><title> å…ƒç´ çš„å†…å®¹å¯ä»¥è¢«é˜…è¯»å™¨æ˜¾ç¤ºåœ¨æ ‡é¢˜æ ä¸Šæˆ–è€…æ˜¯ä½œä¸ºé¼ æ ‡æŒ‡é’ˆæŒ‡å‘å›¾åƒæ—¶çš„æç¤º<desc> å…ƒç´ å…è®¸å’±ä»¬ä¸ºå›¾åƒå®šä¹‰å®Œæ•´çš„æè¿°ä¿¡æ¯<h4 id="åŸºæœ¬å½¢çŠ¶å’Œå±æ€§">åŸºæœ¬å½¢çŠ¶å’Œå±æ€§</h4><ul><li>åŸºæœ¬å›¾å½¢</li></ul><p><rect>ã€<circle>ã€<ellipse>ã€<line>ã€<polyline>ã€<polygon></p><ul><li>åŸºæœ¬å±æ€§</li></ul><p>fillã€strokeã€stroke-widthã€transform</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;SVG&quot;&gt;SVG&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;å¯ç¼©æ”¾çŸ¢é‡å›¾&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;SVG-æ–‡æ¡£åŸºæœ¬ç»“æ„&quot;&gt;SVG æ–‡æ¡£åŸºæœ¬ç»“æ„&lt;/h4&gt;
&lt;figure class=&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.261Z</published>
    <updated>2024-01-05T14:04:24.261Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Stylelint">Stylelint</h2><h3 id="è¯´æ˜">è¯´æ˜</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;stylelint-config-prettier&quot;</span>: è§£å†³ prettier ä¸ stylelint çš„å†²çª</span><br><span class="line"><span class="string">&quot;stylelint-config-standard&quot;</span>: å®ƒæ‰©å±•äº† stylelint-config-recommendedï¼Œå¹¶å¼€å¯äº†é™„åŠ è§„åˆ™ï¼Œä»¥æ‰§è¡Œ CSS è§„èŒƒä¸­çš„ç°ä»£çº¦å®šã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Stylelint&quot;&gt;Stylelint&lt;/h2&gt;
&lt;h3 id=&quot;è¯´æ˜&quot;&gt;è¯´æ˜&lt;/h3&gt;
&lt;figure class=&quot;highlight arduino&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.260Z</published>
    <updated>2024-01-05T14:04:24.261Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Commitlint">Commitlint</h2><blockquote><p>ä¸€ä¸ª git commit æ ¡éªŒçº¦æŸå·¥å…·ï¼Œå°±æ˜¯å½“æˆ‘ä»¬è¿è¡Œgit commmit -m 'xxxâ€™æ—¶ï¼Œæ¥æ£€æŸ¥â€™xxxâ€™æ˜¯ä¸æ˜¯æ»¡è¶³å›¢é˜Ÿçº¦å®šå¥½çš„æäº¤è§„èŒƒçš„å·¥å…·ã€‚</p></blockquote><h4 id="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–</h4><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pnpm install @commitlint/<span class="built_in">config</span>-conventional @commitlint/cli -D -w</span><br><span class="line"></span><br><span class="line">@commitlint/cli</span><br><span class="line">commitlintå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåœ¨é¡¹ç›®ä¸­å¿«é€Ÿå¼•å…¥ commit message è§„èŒƒå’Œ commitlint ç›¸å…³é…ç½®è§„èŒƒ</span><br><span class="line"></span><br><span class="line">@commitlint/<span class="built_in">config</span>-conventional</span><br><span class="line">commitlintè§„åˆ™é›†(é€šå¸¸é€šè¿‡commitlint.<span class="built_in">config</span>.jsæŒ‡å®š)</span><br><span class="line"></span><br><span class="line">commitizen</span><br><span class="line">å¯¹åº”<span class="built_in">package</span>.json <span class="built_in">config</span> commitizen, æ ¼å¼åŒ–commmit messageçš„å·¥å…·(ä»commitç”ŸæˆChange <span class="built_in">log</span>)</span><br><span class="line"></span><br><span class="line">cz-conventional-changelog</span><br><span class="line">æ—¥å¿—å˜æ›´æ ‡å‡†</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="é…ç½®commitlint-hook">é…ç½®commitlint hook</h3><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">npx</span> husky add .husky/commit-msg <span class="string">&#x27;npx commitlint --edit <span class="variable">$1</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">commitlint --edit &lt;æ–‡ä»¶å&gt;ï¼šæ‰§è¡Œ commitlint å‘½ä»¤è¡Œå·¥å…·ï¼Œå¹¶ä½¿ç”¨ --edit é€‰é¡¹ï¼Œä»ä¸€ä¸ªæ–‡ä»¶é‡Œæå– commit å†…å®¹æ¥è¿›è¡Œæ ¡éªŒã€‚æ ¡éªŒè§„åˆ™ç”± commitlint.config.js é…ç½®æ–‡ä»¶æ¥æŒ‡å®šï¼Œreference-cli</span></span><br><span class="line"><span class="string"><span class="variable">$1</span>ï¼šåœ¨æ–°ç‰ˆçš„ husky ä¸­ <span class="variable">$HUSKY_GIT_PARAMS</span> å˜é‡å·²ä¸å†ä½¿ç”¨ï¼Œå–è€Œä»£ä¹‹æ˜¯ <span class="variable">$1</span> </span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Commitlint&quot;&gt;Commitlint&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ª git commit æ ¡éªŒçº¦æŸå·¥å…·ï¼Œå°±æ˜¯å½“æˆ‘ä»¬è¿è¡Œgit commmit -m &#39;xxxâ€™æ—¶ï¼Œæ¥æ£€æŸ¥â€™xxxâ€™æ˜¯ä¸æ˜¯æ»¡è¶³å›¢é˜Ÿçº¦å®šå¥½çš„æäº¤è§„èŒƒçš„å·¥å…·ã€‚&lt;/p&gt;
&lt;/bloc</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-05T14:04:24.259Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Git-ç›¸å…³é—®é¢˜">Git ç›¸å…³é—®é¢˜</h2><p><strong>Git è¿œç¨‹ä»“åº“æ–‡ä»¶åå¤§å°å†™</strong></p><ul><li>è®¾ç½®æœ¬åœ°gitç¯å¢ƒè¯†åˆ«å¤§å°å†™</li></ul><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config core.ignorecase <span class="literal">false</span></span><br></pre></td></tr></table></figure><ul><li>åˆ é™¤å¤šä½™çš„æ–‡ä»¶</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">git <span class="built_in">rm</span> --cached src/components/Header -r</span></span><br></pre></td></tr></table></figure><ul><li>åŒæ­¥ï¼Œæäº¤åˆ°è¿œç¨‹ä»“åº“</li></ul><figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">add</span> . <span class="variable">&amp;&amp;</span> git commit -m <span class="string">&quot;è§„èŒƒç»„ä»¶å‘½å&quot;</span> <span class="variable">&amp;&amp;</span> git push origin dev</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Git-ç›¸å…³é—®é¢˜&quot;&gt;Git ç›¸å…³é—®é¢˜&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Git è¿œç¨‹ä»“åº“æ–‡ä»¶åå¤§å°å†™&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¾ç½®æœ¬åœ°gitç¯å¢ƒè¯†åˆ«å¤§å°å†™&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight arduino&quot;&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-05T14:04:24.259Z</updated>
    
    <content type="html"><![CDATA[<ul><li>PeerTube æ˜¯ä¸€æ¬¾å¼€æºçš„å»ä¸­å¿ƒåŒ–è§†é¢‘åˆ†äº«å¹³å°</li><li>Fluent-ffmpeg åŸºäºFFmpegçš„JavaScriptæ¥å£ï¼Œç”¨äºå¤„ç†éŸ³é¢‘å’Œè§†é¢‘</li></ul><p>æµåª’ä½“å¼€å‘åº“</p><ul><li>Hls.js å®ç°HTTP Live Streamingå®¢æˆ·ç«¯ã€‚ å®ƒä¾é HTML5è§†é¢‘å’ŒMediaSourceæ‰©å±•è¿›è¡Œæ’­æ”¾</li><li>MediaStreamRecorder: ç”¨äºå½•åˆ¶éŸ³é¢‘å’Œè§†é¢‘çš„JavaScriptåº“</li><li>WebTorrent æµè§ˆå™¨ä¸­å®ç°çš„BitTorrentå®¢æˆ·ç«¯ï¼Œæ”¯æŒå®æ—¶æµåª’ä½“ï¼Œè¾¹ä¸‹è¾¹æ’­</li><li>video.js å¼€æºHTML5å’ŒFlashè§†é¢‘æ’­æ”¾å™¨</li></ul><p>å¼¹å¹•</p><ul><li>danmaku2ass å°†å¼¹å¹•è½¬æ¢ä¸ºASSå­—å¹•æ ¼å¼ï¼Œé€‚ç”¨äºæ’­æ”¾å™¨å¦‚mpvï¼ŒåŸºäºPython</li><li>åŸç”ŸJS:<ul><li>æ¨ªå‘ï¼š<a href="https://github.com/hugeorange/BulletJs.git">https://github.com/hugeorange/BulletJs.git</a></li><li>çºµå‘ï¼š<a href="https://segmentfault.com/a/1190000022634959">https://segmentfault.com/a/1190000022634959</a></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* h5 ç›´æ’­é—´å¼¹å¹•åˆ—è¡¨ç»„ä»¶</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* ä½¿ç”¨æ–¹å¼</span></span><br><span class="line"><span class="comment">* &#123;liveInfo.danmuChannel &amp;&amp; &lt;DanmuPanel ref=&#123;ref =&gt; this.danmuRef = ref&#125; wrapH=&#123;DANMUWRAPH&#125;/&gt; &#125;</span></span><br><span class="line"><span class="comment">* çˆ¶ç»„ä»¶socketæ‹¿åˆ°æ•°æ®é€šè¿‡ç»„ä»¶ ref å®ä¾‹è°ƒç”¨ addDanmu(data)</span></span><br><span class="line"><span class="comment">* </span></span><br><span class="line"><span class="comment">* å¦‚éœ€æ ·å¼è°ƒæ•´è¯·è‡ªè¡Œä¿®æ”¹lessæ ·å¼</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> classnames <span class="keyword">from</span> <span class="string">&quot;classnames&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; debounce, isScrollBottom &#125; <span class="keyword">from</span> <span class="string">&quot;@/util/index&quot;</span>; <span class="comment">// è‡ªè¡Œå®ç°æˆ–å‚è€ƒæˆ‘ä¸‹é¢çš„ä»£ç </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.less&quot;</span>;</span><br><span class="line"></span><br><span class="line">interface propsType &#123;</span><br><span class="line">    wrapH?: string; <span class="comment">// å¼¹å¹•å®¹å™¨é«˜åº¦</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼¹å¹•å¯¹è±¡ç±»å‹</span></span><br><span class="line">type contentType = &#123;</span><br><span class="line">    <span class="attr">name</span>: string;</span><br><span class="line">    <span class="attr">content</span>: string;</span><br><span class="line">    <span class="attr">key</span>: string;</span><br><span class="line">    reactId?: any; <span class="comment">// åˆ—è¡¨å”¯ä¸€æ ‡è¯†ï¼Œå¦‚ä¸ä¼ ä¼šè‡ªåŠ¨æ·»åŠ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">DanmuPanel</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&lt;propsType, any&gt; &#123;</span><br><span class="line">    <span class="attr">danmuWrapHeight</span>: number; <span class="comment">// å¼¹å¹•å®¹å™¨domé«˜åº¦</span></span><br><span class="line">    <span class="attr">danmuWrapRef</span>: <span class="title class_">HTMLElement</span>; <span class="comment">// å¼¹å¹•å®¹å™¨dom</span></span><br><span class="line">    <span class="attr">danmuListRef</span>: <span class="title class_">HTMLElement</span>; <span class="comment">// å¼¹å¹•åˆ—è¡¨dom</span></span><br><span class="line">    <span class="attr">restNums</span>: number;</span><br><span class="line">    <span class="attr">reactId</span>: number; <span class="comment">// å¼¹å¹•åˆ—è¡¨ key</span></span><br><span class="line">    <span class="attr">debounceCb</span>: <span class="title class_">Function</span>;</span><br><span class="line">    <span class="attr">isBindScrolled</span>: boolean;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">        <span class="variable language_">super</span>(props)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">            <span class="attr">danmuList</span>: [],</span><br><span class="line">            <span class="attr">restDanmu</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">restNums</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">reactId</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">debounceCb</span> = <span class="title function_">debounce</span>(<span class="variable language_">this</span>.<span class="property">danmuScroll</span>, <span class="number">200</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">initDom</span>();</span><br><span class="line">        <span class="comment">// this.testAddDanmu();</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æµ‹è¯•ä»£ç ï¼ŒåæœŸåˆ æ‰</span></span><br><span class="line">    <span class="title function_">testAddDanmu</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            ++i</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">addDanmu</span>(&#123;</span><br><span class="line">                <span class="attr">name</span>: i + <span class="string">&#x27;-æˆ‘æ˜¯åå­—&#x27;</span>,</span><br><span class="line">                <span class="attr">content</span>: i + <span class="string">&#x27;-æˆ‘æ˜¯å†…å®¹&#x27;</span>,</span><br><span class="line">                <span class="attr">key</span>: <span class="string">&quot;danmu&quot;</span>,</span><br><span class="line">                <span class="attr">reactId</span>: i</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;, <span class="number">100</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private <span class="title function_">initDom</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.danmu-wrap&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">danmuListRef</span> = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.danmu-wrap .list&quot;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">danmuWrapHeight</span> = <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="property">offsetHeight</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private addScroll = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">debounceCb</span>();</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">isBindScrolled</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¼¹å¹•åˆ—è¡¨æ»šåŠ¨åˆ°åº•éƒ¨å›è°ƒ</span></span><br><span class="line">    private danmuScroll = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="attr">ele</span>: <span class="title class_">HTMLElement</span> = <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>;</span><br><span class="line">        <span class="keyword">const</span> isBottom = <span class="title function_">isScrollBottom</span>(ele, ele.<span class="property">clientHeight</span>);</span><br><span class="line">        <span class="keyword">if</span> (isBottom) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">restNums</span> = <span class="number">0</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">restDanmu</span>: <span class="number">0</span> &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¾›çˆ¶ç»„ä»¶è°ƒç”¨ socketæ‹¿åˆ°ç»“æœåè°ƒç”¨</span></span><br><span class="line">    public addDanmu = <span class="function">(<span class="params">data: contentType</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; danmuList &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">        data.<span class="property">reactId</span> = ++<span class="variable language_">this</span>.<span class="property">reactId</span>;</span><br><span class="line">        <span class="keyword">if</span> (danmuList.<span class="property">length</span> &gt;= <span class="number">150</span>) &#123;</span><br><span class="line">            danmuList.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">50</span>)</span><br><span class="line">        &#125;;</span><br><span class="line">        danmuList.<span class="title function_">push</span>(data);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; danmuList &#125;, <span class="variable language_">this</span>.<span class="property">renderDanmu</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private renderDanmu = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> listH = <span class="variable language_">this</span>.<span class="property">danmuListRef</span>.<span class="property">offsetHeight</span>;</span><br><span class="line">        <span class="keyword">const</span> diff = listH - <span class="variable language_">this</span>.<span class="property">danmuWrapHeight</span>;</span><br><span class="line">        <span class="keyword">const</span> top = <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="property">scrollTop</span>;</span><br><span class="line">        <span class="keyword">if</span> (diff - top &lt; <span class="number">50</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (diff &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">isBindScrolled</span>) &#123;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">isBindScrolled</span> = <span class="literal">false</span>;</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">addScroll</span>)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="title function_">scrollTo</span>(&#123; <span class="attr">top</span>: diff + <span class="number">40</span>, <span class="attr">left</span>: <span class="number">0</span>, <span class="attr">behavior</span>: <span class="string">&#x27;smooth&#x27;</span> &#125;);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">restNums</span> = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ++<span class="variable language_">this</span>.<span class="property">restNums</span>;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">isBindScrolled</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">isBindScrolled</span> = <span class="literal">true</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>, <span class="variable language_">this</span>.<span class="property">addScroll</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">restDanmu</span>: <span class="variable language_">this</span>.<span class="property">restNums</span> &gt;= <span class="number">99</span> ? <span class="string">&#x27;99+&#x27;</span> : <span class="variable language_">this</span>.<span class="property">restNums</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private scrollBottom = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">restNums</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; <span class="attr">restDanmu</span>: <span class="variable language_">this</span>.<span class="property">restNums</span> &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">danmuWrapRef</span>.<span class="title function_">scrollTo</span>(&#123; <span class="attr">top</span>: <span class="variable language_">this</span>.<span class="property">danmuListRef</span>.<span class="property">offsetHeight</span>, <span class="attr">left</span>: <span class="number">0</span>, <span class="attr">behavior</span>: <span class="string">&#x27;smooth&#x27;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; danmuList, restDanmu &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;danmu-panel&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;danmu-wrap&quot;</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">height:</span> <span class="attr">this.props.wrapH</span> &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">className</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123;</span></span><br><span class="line"><span class="language-xml">                            danmuList.map((v) =&gt; (</span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;v.reactId&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;name&quot;</span>&gt;</span>&#123;v.name&#125;ï¼š<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;classnames(</span>&quot;<span class="attr">content</span>&quot;, <span class="attr">v.key</span>)&#125;&gt;</span>&#123;v.content&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                            ))</span></span><br><span class="line"><span class="language-xml">                        &#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                    !!restDanmu &amp;&amp;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;rest-nums&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.scrollBottom&#125;</span>&gt;</span>&#123; restDanmu &#125;æ¡æ–°æ¶ˆæ¯<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// debounce isScrollBottom å®ç°å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* é˜²æŠ–å‡½æ•°</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> fn </span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> wait </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn:<span class="built_in">Function</span>, wait:number = <span class="number">500</span></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="attr">timeout</span>:number = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// æ¯æ¬¡è§¦å‘ scroll handler æ—¶å…ˆæ¸…é™¤å®šæ—¶å™¨</span></span><br><span class="line">        <span class="built_in">clearTimeout</span>(timeout);</span><br><span class="line">        <span class="comment">// æŒ‡å®š xx ms åè§¦å‘çœŸæ­£æƒ³è¿›è¡Œçš„æ“ä½œ handler</span></span><br><span class="line">        timeout = <span class="built_in">setTimeout</span>(fn, wait);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* æ˜¯å¦æ»šåˆ°åˆ°å®¹å™¨åº•éƒ¨</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> ele æ»šåŠ¨å®¹å™¨</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> wrapHeight å®¹å™¨é«˜åº¦</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">isScrollBottom</span>(<span class="params">ele: HTMLElement, wrapHeight:number, threshold: number = <span class="number">30</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> h1 = ele.<span class="property">scrollHeight</span> - ele.<span class="property">scrollTop</span>;</span><br><span class="line">    <span class="keyword">const</span> h2 = wrapHeight + threshold;</span><br><span class="line">    <span class="keyword">const</span> isBottom = h1 &lt;= h2;</span><br><span class="line">    <span class="comment">// console.log(&#x27;--&gt;&#x27;, isBottom, ele.scrollHeight, ele.scrollTop, h2)</span></span><br><span class="line">    <span class="keyword">return</span> isBottom;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>h5ç›´æ’­æ‹‰æµé¡µé¢è°ƒç ”: <a href="https://segmentfault.com/a/1190000037750253">https://segmentfault.com/a/1190000037750253</a></li></ul></li><li>æ–—é±¼å¼¹å¹•æŠ“å–åŠå¯è§†åŒ–ç®¡ç†å¹³å°ï¼š <a href="https://github.com/Crawler995/DouyuBarrage-Pro.git">https://github.com/Crawler995/DouyuBarrage-Pro.git</a></li><li>a-barrage: <a href="https://github.com/logcas/a-barrage.git">https://github.com/logcas/a-barrage.git</a></li></ul><p>ç›´æ’­é—´</p><ul><li>LiveRoom<ul><li>åœ°å€<ul><li>å‰ç«¯ï¼š<a href="https://github.com/jack-hoo/LiveRoomDemo_Client.git">https://github.com/jack-hoo/LiveRoomDemo_Client.git</a><ul><li>æ ¸å¿ƒæŠ€æœ¯ç‚¹ï¼šhls.jsã€websocketã€</li></ul></li><li>åç«¯ï¼š<a href="https://github.com/jack-hoo/LiveRoomDemo_Server.git">https://github.com/jack-hoo/LiveRoomDemo_Server.git</a></li></ul></li></ul></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;PeerTube æ˜¯ä¸€æ¬¾å¼€æºçš„å»ä¸­å¿ƒåŒ–è§†é¢‘åˆ†äº«å¹³å°&lt;/li&gt;
&lt;li&gt;Fluent-ffmpeg åŸºäºFFmpegçš„JavaScriptæ¥å£ï¼Œç”¨äºå¤„ç†éŸ³é¢‘å’Œè§†é¢‘&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æµåª’ä½“å¼€å‘åº“&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Hls.js å®ç°HTTP Li</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-05T14:04:24.260Z</updated>
    
    <content type="html"><![CDATA[<h3 id="localtunnel">localtunnel</h3><p><strong>å…¨å±€å®‰è£…</strong></p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> -g localtunnel</span><br></pre></td></tr></table></figure><p><strong>ç”³è¯·é€šé“URL</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lt <span class="comment">--port 8000</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;localtunnel&quot;&gt;localtunnel&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å…¨å±€å®‰è£…&lt;/strong&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight cmake&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-11T12:39:14.978Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://nic.eu.org">https://nic.eu.org</a></p><p><a href="https://www.fakenamegenerator.com">https://www.fakenamegenerator.com</a></p><p><a href="https://sjc.alpha3cloud.com">https://sjc.alpha3cloud.com</a></p><p>userInfo</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">United</span> <span class="string">Kingdom</span></span><br><span class="line"></span><br><span class="line"><span class="string">Jason</span> <span class="string">M.</span> <span class="string">Rodriguez</span></span><br><span class="line"><span class="number">34</span> <span class="string">Lamphey</span> <span class="string">Road</span></span><br><span class="line"><span class="string">THE</span> <span class="string">BRATCH</span></span><br><span class="line"><span class="string">WV5</span> <span class="string">3SR</span></span><br><span class="line"><span class="number">078</span> <span class="number">0832 </span><span class="number">9954</span></span><br><span class="line"></span><br><span class="line"><span class="string">Elizabeth</span> <span class="string">B.</span> <span class="string">Mercier</span></span><br><span class="line"><span class="number">87</span> <span class="string">Park</span> <span class="string">Place</span></span><br><span class="line"><span class="string">CARTMEL</span></span><br><span class="line"><span class="string">LA11</span> <span class="string">9SG</span></span><br><span class="line"><span class="number">070</span> <span class="number">3303 </span><span class="number">8997</span></span><br><span class="line"></span><br><span class="line"><span class="string">Donna</span> <span class="string">S.</span> <span class="string">Hedges</span></span><br><span class="line"><span class="number">75</span> <span class="string">Simone</span> <span class="string">Weil</span> <span class="string">Avenue</span></span><br><span class="line"><span class="string">WEARE</span> <span class="string">GIFFARD</span></span><br><span class="line"><span class="string">EX39</span> <span class="string">1NX</span></span><br><span class="line"><span class="number">078</span> <span class="number">5843 </span><span class="number">7176</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">Cheryl</span> <span class="string">H.</span> <span class="string">Davis</span></span><br><span class="line"><span class="number">70</span> <span class="string">Bootham</span> <span class="string">Crescent</span></span><br><span class="line"><span class="string">RIDLINGTON</span></span><br><span class="line"><span class="string">NR28</span> <span class="string">2SU</span></span><br><span class="line"><span class="number">077</span> <span class="number">6454 </span><span class="number">6457</span></span><br><span class="line"></span><br><span class="line"><span class="string">Account</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">JMR76-FREE</span></span><br></pre></td></tr></table></figure><p>LocalTunnel ï¼š<a href="https://theboroer.github.io/localtunnel-www/">https://theboroer.github.io/localtunnel-www/</a> å…è®¸ç”¨æˆ·é€šè¿‡å…¬ç½‘ URL è®¿é—®æœ¬åœ°ä¸»æœºã€‚</p><p>ä¸´æ—¶é‚®ç®±ç½‘ç«™<br><a href="https://temp-mail.org">https://temp-mail.org</a></p><p>privatevpn</p><p>æŸ¥çœ‹IPåœ°å€<br><a href="http://www.whoer.net">www.whoer.net</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://nic.eu.org&quot;&gt;https://nic.eu.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.fakenamegenerator.com&quot;&gt;https://www.fakenamegenerator.com&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-05T14:04:24.259Z</updated>
    
    <content type="html"><![CDATA[<h3 id="æ°¸ä¹…å…è´¹vpsç”³è¯·ï¼Œè¶…å¼ºé…ç½®ï¼Œ8æ ¸å¿ƒï¼Œ32Gå†…å­˜">æ°¸ä¹…å…è´¹vpsç”³è¯·ï¼Œè¶…å¼ºé…ç½®ï¼Œ8æ ¸å¿ƒï¼Œ32Gå†…å­˜</h3><p>æ°¸ä¹…äº‘æœåŠ¡å™¨ç”³è¯·è¿æ¥ï¼š<a href="https://dashboard.render.com/">https://dashboard.render.com/</a></p><p>Githubeæ³¨å†Œè¿æ¥ï¼š<a href="https://github.com/">https://github.com/</a></p><p>Dockerä»£ç ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ Ubuntu 22.04 ä½œä¸ºåŸºç¡€é•œåƒ</span></span><br><span class="line">FROM ubuntu:22.04</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Shellinabox</span></span><br><span class="line">RUN apt-get update &amp;&amp; \</span><br><span class="line">    apt-get install -y shellinabox &amp;&amp; \</span><br><span class="line">    apt-get clean &amp;&amp; \</span><br><span class="line">    <span class="built_in">rm</span> -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® root ç”¨æˆ·çš„å¯†ç ä¸º &#x27;root&#x27;</span></span><br><span class="line">RUN <span class="built_in">echo</span> <span class="string">&#x27;root:frepai&#x27;</span> | chpasswd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ² 22 ç«¯å£</span></span><br><span class="line">EXPOSE 22</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ Shellinabox</span></span><br><span class="line">CMD [<span class="string">&quot;/usr/bin/shellinaboxd&quot;</span>, <span class="string">&quot;-t&quot;</span>, <span class="string">&quot;-s&quot;</span>, <span class="string">&quot;/:LOGIN&quot;</span>]</span><br></pre></td></tr></table></figure><p>VPSç”³è¯·å®Œæˆä¹‹åï¼Œéœ€è¦å®‰è£…æœ€åŸºç¡€çš„è½¯ä»¶åŒ…ï¼Œå› ä¸ºæˆ‘ä»¬ç”³è¯·çš„æ˜¯åº•å±‚çš„unbutuæ“ä½œç³»ç»Ÿï¼Œæ“ä½œæ€§éå¸¸å¼ºï¼Œéœ€è¦ä»€ä¹ˆå°±å®‰è£…ä»€ä¹ˆï¼</p><p>æ›´æ–°ç³»ç»Ÿï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br></pre></td></tr></table></figure><p>å®‰è£…åŸºç¡€è½¯ä»¶åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install sudo curl wget nano screen git</span><br></pre></td></tr></table></figure><p>å®‰è£…neofetchå·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install neofetch</span><br></pre></td></tr></table></figure><p>è°ƒç”¨æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">neofetch</span><br></pre></td></tr></table></figure><p>[<a href="https://frepai.com/">https://frepai.com/</a>]</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;æ°¸ä¹…å…è´¹vpsç”³è¯·ï¼Œè¶…å¼ºé…ç½®ï¼Œ8æ ¸å¿ƒï¼Œ32Gå†…å­˜&quot;&gt;æ°¸ä¹…å…è´¹vpsç”³è¯·ï¼Œè¶…å¼ºé…ç½®ï¼Œ8æ ¸å¿ƒï¼Œ32Gå†…å­˜&lt;/h3&gt;
&lt;p&gt;æ°¸ä¹…äº‘æœåŠ¡å™¨ç”³è¯·è¿æ¥ï¼š&lt;a href=&quot;https://dashboard.render.com/&quot;&gt;https://dashboard.rend</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2024-01-05T14:04:24.259Z</published>
    <updated>2024-01-05T14:04:24.259Z</updated>
    
    <content type="html"><![CDATA[<h3 id="bpmn-js">bpmn.js</h3><p><strong>åŸºæœ¬æ¦‚å¿µ</strong></p><ul><li>diagram element å›¾è¡¨å…ƒç´ </li></ul><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="symbol">id:</span> <span class="string">&quot;StartEvent_1y45yut&quot;</span>,</span><br><span class="line"><span class="symbol">type:</span> <span class="string">&quot;bpmn:StartEvent&quot;</span>,</span><br><span class="line"><span class="symbol">businessObject:</span> <span class="punctuation">&#123;</span></span><br><span class="line">$type: <span class="string">&quot;bpmn:StartEvent&quot;</span>,</span><br><span class="line"><span class="symbol">name:</span> <span class="string">&quot;å¼€å§‹&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><ul><li>xml æ ‡ç­¾ç§°ä¹‹ä¸ºBPMN element</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;startEvent <span class="attribute">id</span>=<span class="string">&quot;StartEvent_1y45yut&quot;</span> <span class="attribute">name</span>=<span class="string">&quot;å¼€å§‹&quot;</span>&gt;&lt;/startEvent&gt;</span><br></pre></td></tr></table></figure><ul><li>å®˜æ–¹ Panel</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span> è¿™é‡Œå¼•å…¥çš„æ˜¯å³ä¾§å±æ€§æ è¿™ä¸ªæ¡†</span><br><span class="line">import propertiesPanelModule from <span class="string">&#x27;bpmn-js-properties-panel&#x27;</span></span><br><span class="line"><span class="regexp">//</span> è€Œè¿™ä¸ªå¼•å…¥çš„æ˜¯å³ä¾§å±æ€§æ é‡Œçš„å†…å®¹</span><br><span class="line">import propertiesProviderModule from <span class="string">&#x27;bpmn-js-properties-panel/lib/provider/camunda&#x27;</span></span><br><span class="line"></span><br><span class="line">additionalModules: [</span><br><span class="line">  propertiesPanelModule,</span><br><span class="line">  propertiesProviderModule</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="regexp">//</span> propertiesPanelModule è¡¨ç¤ºçš„æ˜¯å±æ€§æ è¿™ä¸ªæ¡†, å°±æ˜¯å‘Šè¯‰åˆ«äººè¿™é‡Œè¦æœ‰ä¸ªå±æ€§æ ;</span><br><span class="line"><span class="regexp">//</span> propertiesProviderModule è¡¨ç¤ºçš„æ˜¯å±æ€§æ é‡Œçš„å†…å®¹, ä¹Ÿå°±æ˜¯ç‚¹å‡»ä¸åŒçš„elementè¯¥æ˜¾ç¤ºä»€ä¹ˆå†…å®¹.</span><br></pre></td></tr></table></figure><ul><li>ä¸¤è€…çš„ä¸€äº›å±æ€§å…³è”èµ·æ¥é çš„æ˜¯ä¸€ä¸ªå«åšbusinessObjectçš„å±æ€§</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;bpmn-js&quot;&gt;bpmn.js&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;åŸºæœ¬æ¦‚å¿µ&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;diagram element å›¾è¡¨å…ƒç´ &lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight dts&quot;&gt;&lt;table&gt;&lt;tr</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2023-07-22T05:48:18.729Z</published>
    <updated>2023-07-22T05:48:19.350Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç»Ÿè®¡ä»£ç è¡Œæ•°">ç»Ÿè®¡ä»£ç è¡Œæ•°</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --format=<span class="string">&#x27;%aN&#x27;</span> | <span class="built_in">sort</span> -u | <span class="keyword">while</span> <span class="built_in">read</span> name; <span class="keyword">do</span> <span class="built_in">echo</span> -en <span class="string">&quot;<span class="variable">$name</span>\t&quot;</span>; git <span class="built_in">log</span> --author=<span class="string">&quot;<span class="variable">$name</span>&quot;</span> --pretty=tformat: --since ==2022â€“01-01 --<span class="keyword">until</span>=2022-12-30 --numstat | awk <span class="string">&#x27;&#123; add += $1; subs += $2; loc += $1 - $2 &#125; END &#123; printf &quot;added lines: %s, removed lines: %s, total lines: %s\n&quot;, add, subs, loc &#125;&#x27;</span> -; <span class="keyword">done</span></span><br></pre></td></tr></table></figure><h3 id="Git-Tag-ç®¡ç†">Git Tag ç®¡ç†</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">tag</span> <span class="title">åˆ—å‡ºæ‰€æœ‰tag</span></span><br><span class="line"></span><br><span class="line">git fetch --tags ä¸‹è½½æ‰€æœ‰ <span class="keyword">tag</span> <span class="title">è‡³æœ¬åœ°</span></span><br><span class="line"><span class="title"></span></span><br><span class="line"><span class="title">git</span> checkout tagName åˆ‡æ¢è‡³æŒ‡å®š<span class="keyword">tag</span></span><br><span class="line"></span><br><span class="line"><span class="title">git</span> <span class="keyword">tag</span> <span class="title">-l</span> | xargs git <span class="keyword">tag</span> <span class="title">-d</span> <span class="comment">#åˆ é™¤æ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git fetch origin --prune <span class="comment">#ä»è¿œç¨‹æ‹‰å–æ‰€æœ‰ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥è¯¢è¿œç¨‹tagsçš„å‘½ä»¤å¦‚ä¸‹ï¼š</span></span><br><span class="line">git ls-remote --tags origin</span><br><span class="line"></span><br><span class="line"><span class="keyword">tag</span>å¸¸ç”¨gitå‘½ä»¤ï¼š</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">#åˆ—å‡ºæ‰€æœ‰tag</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-l</span> v1.* <span class="comment">#åˆ—å‡ºç¬¦åˆæ¡ä»¶çš„tagï¼ˆç­›é€‰ä½œç”¨ï¼‰</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">#åˆ›å»ºè½»é‡tag</span>ï¼ˆæ— -mæ ‡æ³¨ä¿¡æ¯ï¼‰</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> -m â€˜first <span class="keyword">version</span>â€™ <span class="comment">#åˆ›å»ºå«æ ‡æ³¨tag</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> f1bb97a(commit id) <span class="comment">#ä¸ºä¹‹å‰æäº¤æ‰“tag</span></span><br><span class="line"></span><br><span class="line">git push origin --tags <span class="comment">#æ¨é€æ‰€æœ‰æœ¬åœ°tagåˆ°è¿œç¨‹</span></span><br><span class="line">git push origin <span class="comment">#æ¨é€æŒ‡å®šæœ¬åœ°tagåˆ°è¿œç¨‹</span></span><br><span class="line"></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-d</span> <span class="comment">#åˆ é™¤æœ¬åœ°æŒ‡å®štag</span></span><br><span class="line">git push origin --delete tagName <span class="comment">#åˆ é™¤è¿œç¨‹æŒ‡å®štag</span></span><br><span class="line"></span><br><span class="line">git fetch origin <span class="comment">#æ‹‰å–è¿œç¨‹æŒ‡å®štag</span></span><br><span class="line">git show <span class="comment">#æ˜¾ç¤ºæŒ‡å®štagè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸´æ—¶å‚è€ƒ">ä¸´æ—¶å‚è€ƒ</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">git å¦‚ä½•åœ¨æœ¬åœ°åŒæ­¥è¿œç¨‹åˆ†æ”¯å’Œ<span class="keyword">tag</span></span><br><span class="line"></span><br><span class="line"><span class="title">1</span>.gitå¦‚ä½•åŒæ­¥æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹originçš„åˆ†æ”¯</span><br><span class="line">é—®é¢˜åœºæ™¯<span class="number">1</span>ï¼š</span><br><span class="line">åŒäº‹Aåˆ›å»ºäº†æœ¬åœ°åˆ†æ”¯branchAå¹¶pushåˆ°äº†è¿œç¨‹-&gt;åŒäº‹Båœ¨æœ¬åœ°æ‹‰å–(git fetch)äº†å’Œè¿œç¨‹branchAåŒæ­¥çš„æœ¬åœ°åˆ†æ”¯branchA-&gt;åŒäº‹Aå¼€å‘å®Œæˆå°†è¿œç¨‹åˆ†æ”¯branchAåˆ é™¤ï¼ˆè¿œç¨‹ä»“åº“å·²ç»ä¸å­˜åœ¨åˆ†æ”¯branchAï¼‰-&gt;åŒäº‹Bç”¨git fetchåŒæ­¥è¿œç«¯åˆ†æ”¯ï¼Œgit branch -rå‘ç°æœ¬åœ°ä»ç„¶è®°å½•æœ‰branchAçš„è¿œç¨‹åˆ†æ”¯</span><br><span class="line"></span><br><span class="line">åˆ†æï¼šè¿œç«¯æœ‰æ–°å¢åˆ†æ”¯ï¼Œgit fetchå¯ä»¥åŒæ­¥åˆ°æ–°çš„åˆ†æ”¯åˆ°æœ¬åœ°ï¼Œä½†æ˜¯è¿œç«¯æœ‰åˆ é™¤åˆ†æ”¯ï¼Œç›´æ¥<span class="string">&quot;git fetch&quot;</span>æ˜¯ä¸èƒ½å°†è¿œç¨‹å·²ç»ä¸å­˜åœ¨çš„branchç­‰åœ¨æœ¬åœ°åˆ é™¤çš„</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ³•ï¼š</span><br><span class="line">git fetch --prune <span class="comment">#è¿™æ ·å°±å¯ä»¥å®ç°åœ¨æœ¬åœ°åˆ é™¤è¿œç¨‹å·²ç»ä¸å­˜åœ¨çš„åˆ†æ”¯</span></span><br><span class="line">æˆ–è€…ç®€ç•¥ï¼š</span><br><span class="line">git fetch -p</span><br><span class="line">git fetch -p origin</span><br><span class="line">git remote prune origin</span><br><span class="line"></span><br><span class="line">branchå¸¸ç”¨çš„å‘½ä»¤ï¼š</span><br><span class="line">git branch -a <span class="comment">#æŸ¥çœ‹æœ¬åœ°å’Œè¿œç¨‹æ‰€æœ‰çš„åˆ†æ”¯</span></span><br><span class="line">git branch -r <span class="comment">#æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line">git branch <span class="comment">#æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git branch -d -r origin/branchA <span class="comment">#åˆ é™¤è¿œç¨‹åˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line">å…¶ä»–è¾ƒå¸¸ç”¨çš„å‘½ä»¤</span><br><span class="line">git fetch <span class="comment">#å°†æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹ä¿æŒåŒæ­¥</span></span><br><span class="line">git checkout -b æœ¬åœ°åˆ†æ”¯åx origin/è¿œç¨‹åˆ†æ”¯åx <span class="comment">#æ‹‰å–è¿œç¨‹åˆ†æ”¯å¹¶åŒæ—¶åˆ›å»ºå¯¹åº”çš„æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line">é—®é¢˜åœºæ™¯<span class="number">2</span>ï¼š</span><br><span class="line">æœ¬åœ°åˆ†æ”¯æç¤ºï¼šGit Your branch is ahead of â€˜origin/<span class="literal">master</span>â€™ by X commitsï¼Œä½ æƒ³è®©æœ¬åœ°ç›´æ¥å’Œè¿œç¨‹ä¿æŒåŒæ­¥ï¼Œæƒ³è®©ä¸å†æç¤ºè¿™ä¸ªè®¨åŒä¿¡æ¯ï¼Œé‚£ä¹ˆå¦‚æœä½ æœ¬åœ°çš„commitç¡®ä¿ä¸æƒ³è¦ï¼Œå¯ä»¥å¦‚ä¸‹æ“ä½œï¼š</span><br><span class="line">è§£å†³æ–¹æ³•ï¼š</span><br><span class="line"><span class="number">1</span>ï¼‰git reset --hard origin/<span class="keyword">master</span></span><br><span class="line"></span><br><span class="line"><span class="title">æˆ–è€…è¿˜æœ‰ä¸€ä¸ªå°†æœ¬åœ°ä»£ç ä¸æœåŠ¡å™¨ä»£ç æ›´æ–°ä¸€è‡´çš„è¯­å¥</span></span><br><span class="line"><span class="title">2</span>ï¼‰git branch -u origin/<span class="keyword">master</span></span><br><span class="line"></span><br><span class="line"><span class="title">å¦‚æœæƒ³ç›´æ¥å›é€€ç‰ˆæœ¬è®©è¿œç¨‹å’Œæœ¬åœ°ä»£ç ä¿æŒä¸€è‡´ï¼Œé‚£å°±ç¡®ä¿æœ¬åœ°ä»£ç æ²¡é—®é¢˜ä¹‹åå¼ºåˆ¶æ¨åˆ°è¿œç¨‹</span></span><br><span class="line"><span class="title">git</span> push -f origin <span class="keyword">master</span></span><br><span class="line"></span><br><span class="line"><span class="title">2</span>.git å¦‚ä½•åŒæ­¥æœ¬åœ°<span class="keyword">tag</span>ä¸è¿œç¨‹<span class="keyword">tag</span></span><br><span class="line"><span class="title">é—®é¢˜åœºæ™¯ï¼š</span></span><br><span class="line"><span class="title">åŒäº‹A</span>åœ¨æœ¬åœ°åˆ›å»ºtagAå¹¶pushåŒæ­¥åˆ°äº†è¿œç¨‹-&gt;åŒäº‹Båœ¨æœ¬åœ°æ‹‰å–äº†è¿œç¨‹tagA(git fetch)-&gt;åŒäº‹Aå·¥ä½œéœ€è¦å°†è¿œç¨‹æ ‡ç­¾tagAåˆ é™¤-&gt;åŒäº‹Bç”¨git fetchåŒæ­¥è¿œç«¯ä¿¡æ¯ï¼Œgit <span class="keyword">tag</span>åå‘ç°æœ¬åœ°ä»ç„¶è®°å½•æœ‰tagA</span><br><span class="line"></span><br><span class="line">åˆ†æï¼šå¯¹äºè¿œç¨‹repositoryä¸­å·²ç»åˆ é™¤äº†çš„<span class="keyword">tag</span>ï¼Œå³ä½¿ä½¿ç”¨git fetch --pruneï¼Œç”šè‡³<span class="string">&quot;git fetch --tags&quot;</span>ç¡®ä¿ä¸‹è½½æ‰€æœ‰tagsï¼Œä¹Ÿä¸ä¼šè®©å…¶åœ¨æœ¬åœ°ä¹Ÿå°†å…¶åˆ é™¤çš„ã€‚è€Œä¸”ï¼Œä¼¼ä¹gitç›®å‰ä¹Ÿæ²¡æœ‰æä¾›ä¸€ä¸ªç›´æ¥çš„å‘½ä»¤å’Œå‚æ•°é€‰é¡¹å¯ä»¥åˆ é™¤æœ¬åœ°çš„åœ¨è¿œç¨‹å·²ç»ä¸å­˜åœ¨çš„<span class="keyword">tag</span>ï¼ˆæˆ‘ç›®å‰æ˜¯æ²¡æ‰¾åˆ°æœ‰å…³è¿™ç±»<span class="keyword">tag</span>é—®é¢˜çš„gitå‘½ä»¤~~ï¼Œæœ‰çŸ¥é“çš„åŒå­¦å¯ä»¥å‘ŠçŸ¥æˆ‘ä¸‹ï¼Œäº’ç›¸è¿›æ­¥ï¼‰ã€‚</span><br><span class="line">è§£å†³æ–¹æ³•ï¼š</span><br><span class="line"></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-l</span> | xargs git <span class="keyword">tag</span> <span class="title">-d</span> <span class="comment">#åˆ é™¤æ‰€æœ‰æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">git fetch origin --prune <span class="comment">#ä»è¿œç¨‹æ‹‰å–æ‰€æœ‰ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŸ¥è¯¢è¿œç¨‹tagsçš„å‘½ä»¤å¦‚ä¸‹ï¼š</span></span><br><span class="line">git ls-remote --tags origin</span><br><span class="line"></span><br><span class="line"><span class="keyword">tag</span>å¸¸ç”¨gitå‘½ä»¤ï¼š</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">#åˆ—å‡ºæ‰€æœ‰tag</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-l</span> v1.* <span class="comment">#åˆ—å‡ºç¬¦åˆæ¡ä»¶çš„tagï¼ˆç­›é€‰ä½œç”¨ï¼‰</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">#åˆ›å»ºè½»é‡tag</span>ï¼ˆæ— -mæ ‡æ³¨ä¿¡æ¯ï¼‰</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> -m â€˜first <span class="keyword">version</span>â€™ <span class="comment">#åˆ›å»ºå«æ ‡æ³¨tag</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> f1bb97a(commit id) <span class="comment">#ä¸ºä¹‹å‰æäº¤æ‰“tag</span></span><br><span class="line"></span><br><span class="line">git push origin --tags <span class="comment">#æ¨é€æ‰€æœ‰æœ¬åœ°tagåˆ°è¿œç¨‹</span></span><br><span class="line">git push origin <span class="comment">#æ¨é€æŒ‡å®šæœ¬åœ°tagåˆ°è¿œç¨‹</span></span><br><span class="line"></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-d</span> <span class="comment">#åˆ é™¤æœ¬åœ°æŒ‡å®štag</span></span><br><span class="line">git push origin :refs/tags/ <span class="comment">#åˆ é™¤è¿œç¨‹æŒ‡å®štag</span></span><br><span class="line"></span><br><span class="line">git fetch origin <span class="comment">#æ‹‰å–è¿œç¨‹æŒ‡å®štag</span></span><br><span class="line">git show <span class="comment">#æ˜¾ç¤ºæŒ‡å®štagè¯¦ç»†ä¿¡æ¯</span></span><br></pre></td></tr></table></figure><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è½»é‡æ ‡ç­¾</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">tagname</span></span><br><span class="line">eg: git <span class="keyword">tag</span> <span class="title">v1</span>.<span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é™„æ³¨æ ‡ç­¾</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> tagname -m &#x27;<span class="keyword">tag</span> <span class="title">describe</span>&#x27;</span><br><span class="line">eg: git <span class="keyword">tag</span> <span class="title">-a</span> v1.<span class="number">4</span> -m &#x27;my <span class="keyword">version</span> <span class="number">1.4</span>&#x27;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹æŸä¸ªå†å²æäº¤æ‰“æ ‡ç­¾</span></span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-a</span> <span class="tag">&lt;tagname&gt;</span> <span class="tag">&lt;sha-1&gt;</span></span><br><span class="line">eg: git <span class="keyword">tag</span> <span class="title">-a</span> v1.<span class="number">2</span> <span class="number">9</span>fceb02</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git <span class="keyword">tag</span></span><br><span class="line"></span><br><span class="line"><span class="title"># æŸ¥çœ‹1</span>.<span class="number">8</span>ç³»åˆ—</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-l</span> &#x27;v1.<span class="number">8</span>.*&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åˆ é™¤æ ‡ç­¾</span><br><span class="line">git <span class="keyword">tag</span> <span class="title">-d</span> <span class="tag">&lt;tagname&gt;</span></span><br><span class="line">eg: git <span class="keyword">tag</span> <span class="title">-d</span> v1.<span class="number">4</span>-lw</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### å…±äº«æ ‡ç­¾</span></span><br><span class="line">é»˜è®¤æƒ…å†µä¸‹ï¼Œgit push å‘½ä»¤å¹¶ä¸ä¼šä¼ é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“æœåŠ¡å™¨ä¸Šã€‚</span><br><span class="line">å¦‚æœè¦å…±äº«æ ‡ç­¾ï¼Œå¿…é¡»æ˜¾ç¤ºçš„æ¨é€æ ‡ç­¾åˆ°è¿œç¨‹ä»“åº“ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€å•ä¸ªæ ‡ç­¾</span></span><br><span class="line">git push origin <span class="tag">&lt;tagname&gt;</span></span><br><span class="line">eg: git push origin v1.<span class="number">5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">git push origin --tags</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤è¿œç¨‹æ ‡ç­¾</span></span><br><span class="line">git push origin --delete <span class="tag">&lt;tagname&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>git logï¼šè¯¥å‘½ä»¤æ˜¾ç¤ºä»æœ€è¿‘åˆ°æœ€è¿œçš„æäº¤æ—¥å¿—ã€‚</p><p>git log - -pretty=onelineï¼šå°†åªä¼šæ˜¾ç¤ºæäº¤çš„commit idå·å’Œå¯¹åº”çš„æ³¨é‡Šã€‚(è¿™é‡Œæ˜¯ä¸¤ä¸ª-ï¼ŒMarkdownæ˜¾ç¤ºä¸¤ä¸ª-ä¸ºä¸€ä¸ª-)</p><p>å¦‚æœä½ åœ¨æœ¬åœ°åšäº†é”™è¯¯æäº¤ï¼Œé‚£ä¹ˆå›é€€ç‰ˆæœ¬çš„æ–¹æ³•å¾ˆç®€å•<br>1.å…ˆç”¨ä¸‹é¢å‘½ä»¤æ‰¾åˆ°è¦å›é€€çš„ç‰ˆæœ¬çš„commit idï¼šgit reflog<br>2.æ¥ç€å›é€€ç‰ˆæœ¬: git reset â€“hard commit id</p><p>å›é€€è¿œç¨‹åˆ†æ”¯</p><ol><li>git push -f origin master</li></ol>]]></content>
    
    
      
      
    <summary type="html">&lt;h3 id=&quot;ç»Ÿè®¡ä»£ç è¡Œæ•°&quot;&gt;ç»Ÿè®¡ä»£ç è¡Œæ•°&lt;/h3&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td </summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2023-07-19T13:44:02.762Z</published>
    <updated>2023-07-19T13:44:03.089Z</updated>
    
    <content type="html"><![CDATA[<h1>kong</h1><blockquote><p>ç½‘å…³æ˜¯å¾®æœåŠ¡ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ‰¿è½½äº†æ‰€æœ‰è¯·æ±‚æµé‡å…¥å£ï¼Œå‚æ•°éªŒè¯æ‹¦æˆªï¼Œç”¨æˆ·æƒé™éªŒè¯ï¼Œä½†æ˜¯é™¤äº†JAVAçš„spring cloudä¹‹å¤–ï¼Œå…¬å…±ç½‘å…³å±ˆæŒ‡å¯æ•°ï¼Œå…¶ä¸­æœ€å—å…³æ³¨çš„å°±æ˜¯KONGäº†</p></blockquote><h1>ä¸‹è½½kongé•œåƒ</h1><p>docker pull kong</p><h1>å‘½å kong</h1><p>docker tag kong kong</p><h1>ä¸‹è½½konga</h1><p>docker pull pantsel/konga</p><h1>å£°æ˜ç½‘ç»œ</h1><p>docker network create kong-net</p><h1>æŸ¥çœ‹ç½‘ç»œ</h1><p>docker network ls</p><h1>ä¸‹è½½æ•°æ®åº“</h1><p>docker pull postgres:9.6</p><h1>åˆ›å»ºæ•°æ®åº“å­˜å‚¨å·</h1><p>docker volume create kong-volume</p><h1>è¿è¡Œæ•°æ®åº“ï¼ˆä½¿ç”¨ postgresï¼‰</h1><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name kong-database --network=kong-net  -v kong-volume:/var/lib/postgresql/data   -p <span class="number">5432</span>:<span class="number">5432</span>   -e <span class="string">&quot;POSTGRES_USER=kong&quot;</span>   -e <span class="string">&quot;POSTGRES_DB=kong&quot;</span>   -e <span class="string">&quot;POSTGRES_PASSWORD=kong&quot;</span>   postgres:<span class="number">9</span>.<span class="number">6</span></span><br></pre></td></tr></table></figure><h1>å‡†å¤‡æ•°æ®åº“æ•°æ®å’Œé…ç½®</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">run</span> --rm <span class="attribute">--network</span>=kong-net -e <span class="string">&quot;KONG_DATABASE=postgres&quot;</span> -e <span class="string">&quot;KONG_PG_HOST=172.27.48.1&quot;</span> -e <span class="string">&quot;KONG_PG_PASSWORD=kong&quot;</span> -e <span class="string">&quot;KONG_PASSWORD=kong&quot;</span> -e <span class="string">&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span> kong:latest kong migrations bootstrap</span><br></pre></td></tr></table></figure><h1>å¯åŠ¨ kong-service</h1><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker</span> run -d --name kong --network=kong-net -e <span class="string">&quot;KONG_DATABASE=postgres&quot;</span> -e <span class="string">&quot;KONG_PG_HOST=kong-database&quot;</span> -e <span class="string">&quot;KONG_CASSANDRA_CONTACT_POINTS=kong-database&quot;</span> -e <span class="string">&quot;KONG_PROXY_ACCESS_LOG=/dev/stdout&quot;</span> -e <span class="string">&quot;KONG_ADMIN_ACCESS_LOG=/dev/stdout&quot;</span> -e <span class="string">&quot;KONG_PROXY_ERROR_LOG=/dev/stderr&quot;</span> -e <span class="string">&quot;KONG_ADMIN_ERROR_LOG=/dev/stderr&quot;</span> -e <span class="string">&quot;KONG_ADMIN_LISTEN=0.0.0.0:8001, 0.0.0.0:8444 ssl&quot;</span> -p <span class="number">8443</span>:<span class="number">8443</span> -p <span class="number">127.0.0.1:8001</span>:<span class="number">8001</span> -p <span class="number">127.0.0.1:8444</span>:<span class="number">8444</span> kong</span><br></pre></td></tr></table></figure><h1>ä¸º konga åˆ›å»ºæ•°æ®è¡¨</h1><p>docker run --rm pantsel/konga -c prepare -a postgres -u postgresql://kong:kong@172.27.48.1/konga</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;kong&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;ç½‘å…³æ˜¯å¾®æœåŠ¡ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ‰¿è½½äº†æ‰€æœ‰è¯·æ±‚æµé‡å…¥å£ï¼Œå‚æ•°éªŒè¯æ‹¦æˆªï¼Œç”¨æˆ·æƒé™éªŒè¯ï¼Œä½†æ˜¯é™¤äº†JAVAçš„spring cloudä¹‹å¤–ï¼Œå…¬å…±ç½‘å…³å±ˆæŒ‡å¯æ•°ï¼Œå…¶ä¸­æœ€å—å…³æ³¨çš„å°±æ˜¯KONGäº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="https://jahaw.github.io/posts/0.html"/>
    <id>https://jahaw.github.io/posts/0.html</id>
    <published>2023-07-18T13:37:03.330Z</published>
    <updated>2023-07-18T13:37:03.330Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ajreport</strong><br><strong>chudayun</strong><br><strong>datagear</strong><br><strong>jimureport</strong></p><h3 id="åŸºäº-HTML5-Canvas-çš„äº¤äº’å¼åœ°é“çº¿è·¯å›¾">åŸºäº HTML5 Canvas çš„äº¤äº’å¼åœ°é“çº¿è·¯å›¾</h3><ul><li><a href="https://www.hightopo.com/demo/subway/index.html">https://www.hightopo.com/demo/subway/index.html</a></li></ul><p>PC æ‰«ç åŸç†ï¼Ÿ</p><p>ç½‘é¡µç«¯å±•ç¤ºäºŒç»´ç ï¼ŒåŒæ—¶ä¸æ–­çš„å‘æœåŠ¡ç«¯å‘é€è¯·æ±‚è¯¢é—®è¯¥äºŒç»´ç çš„çŠ¶æ€ï¼›<br>æ‰‹æœºç«¯æ‰«æäºŒç»´ç ï¼Œè¯»å–äºŒç»´ç æˆåŠŸåï¼Œè·³è½¬è‡³ç¡®è®¤ç™»å½•é¡µï¼Œè‹¥ç”¨æˆ·ç¡®è®¤ç™»å½•ï¼Œåˆ™æœåŠ¡å™¨ä¿®æ”¹äºŒç»´ç çŠ¶æ€ï¼Œå¹¶è¿”å›ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼›<br>ç½‘é¡µç«¯æ”¶åˆ°æœåŠ¡å™¨ç«¯äºŒç»´ç çŠ¶æ€æ”¹å˜ï¼Œåˆ™è·³è½¬ç™»å½•åé¡µé¢ï¼›<br>è‹¥è¶…è¿‡ä¸€å®šæ—¶é—´ç”¨æˆ·æœªæ“ä½œï¼Œç½‘é¡µç«¯äºŒç»´ç å¤±æ•ˆï¼Œéœ€è¦é‡æ–°åˆ·æ–°ç”Ÿæˆæ–°çš„äºŒç»´ç ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;ajreport&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;chudayun&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;datagear&lt;/strong&gt;&lt;br&gt;
&lt;strong&gt;jimureport&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;åŸºäº-HTML</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Cookieã€Sessionã€Token ä¸ JWT è§£æ</title>
    <link href="https://jahaw.github.io/posts/379ad06d.html"/>
    <id>https://jahaw.github.io/posts/379ad06d.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<h1>Cookieã€Sessionã€Token ä¸ JWT è§£æ</h1><h2 id="è®¤è¯ã€æˆæƒä¸å‡­è¯">è®¤è¯ã€æˆæƒä¸å‡­è¯</h2><h3 id="ä»€ä¹ˆæ˜¯è®¤è¯ï¼ˆAuthenticationï¼‰ï¼Ÿ"><strong>ä»€ä¹ˆæ˜¯è®¤è¯ï¼ˆAuthenticationï¼‰ï¼Ÿ</strong></h3><ul><li>é€šä¿—åœ°è®²å°±æ˜¯<strong>éªŒè¯å½“å‰ç”¨æˆ·çš„èº«ä»½æ˜¯å¦åˆæ³•çš„è¿‡ç¨‹</strong>ï¼Œå³ä½ æ˜¯è°ï¼Ÿè¯æ˜â€œä½ æ˜¯ä½ è‡ªå·±â€ï¼ˆæ¯”å¦‚ï¼šä½ æ¯å¤©ä¸Šä¸‹ç­æ‰“å¡ï¼Œéƒ½éœ€è¦é€šè¿‡æŒ‡çº¹æ‰“å¡ï¼Œå½“ä½ çš„æŒ‡çº¹å’Œç³»ç»Ÿé‡Œå½•å…¥çš„æŒ‡çº¹ç›¸åŒ¹é…æ—¶ï¼Œå°±æ‰“å¡æˆåŠŸï¼‰</li><li>äº’è”ç½‘ä¸­çš„è®¤è¯ï¼š**ç”¨æˆ·åå¯†ç ç™»å½•ï¼›é‚®ç®±å‘é€ç™»å½•é“¾æ¥ï¼›æ‰‹æœºå·æ¥æ”¶éªŒè¯ç ã€‚**åªè¦ä½ èƒ½æ”¶åˆ°é‚®ç®±/éªŒè¯ç ï¼Œå°±é»˜è®¤ä½ æ˜¯è´¦å·çš„ä¸»äººï¼è®¤è¯ä¸»è¦æ˜¯ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„éšç§æ•°æ®ä¸èµ„æºã€‚</li><li>æ‹“å±•ï¼šä»€ä¹ˆæ˜¯ä¼šè¯ï¼Ÿè®¤è¯é€šè¿‡åï¼Œä¸ºäº†é¿å…ç”¨æˆ·æ¯æ¬¡æ“ä½œéƒ½è¿›è¡Œè®¤è¯ï¼ˆé™¤é“¶è¡Œè½¬è´¦ç­‰ï¼‰ï¼Œå¯ä»¥å°†ç”¨æˆ·ä¿¡æ¯ä¿å­˜åœ¨ä¼šè¯ä¸­ï¼Œ<strong>ä¼šè¯å°±æ˜¯ç³»ç»Ÿä¸ºäº†ä¿å­˜å½“å‰ç”¨æˆ·çš„ç™»å½•çŠ¶æ€æ‰€æä¾›çš„æœºåˆ¶</strong>ï¼Œå¸¸è§çš„æœ‰åŸºäº Session å’Œ token çš„æ–¹å¼ï¼Œå…·ä½“è§ä¸‹æ–‡ã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯æˆæƒï¼ˆAuthorizationï¼‰ï¼Ÿ"><strong>ä»€ä¹ˆæ˜¯æˆæƒï¼ˆAuthorizationï¼‰ï¼Ÿ</strong></h3><ul><li>ç®€å•æ¥è®²å°±æ˜¯<strong>è°ï¼ˆwhoï¼‰å¯¹ä»€ä¹ˆï¼ˆwhatï¼‰è¿›è¡Œäº†ä»€ä¹ˆæ“ä½œï¼ˆhowï¼‰</strong>ã€‚è®¤è¯æ˜¯ä¿è¯ç”¨æˆ·çš„åˆæ³•æ€§ï¼Œæˆæƒåˆ™æ˜¯ä¸ºäº†æ›´ç»†ç²’åº¦çš„å¯¹éšç§æ•°æ®çš„åˆ’åˆ†ã€‚<strong>*æˆæƒæ˜¯åœ¨è®¤è¯é€šè¿‡åï¼Œæ§åˆ¶ä¸åŒçš„ç”¨æˆ·è®¿é—®ä¸åŒçš„èµ„æºã€‚</strong></li><li><strong>ç”¨æˆ·æˆäºˆç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®è¯¥ç”¨æˆ·æŸäº›èµ„æºçš„æƒé™</strong>ã€‚æ¯”å¦‚ï¼Œä½ åœ¨å®‰è£…æ‰‹æœºåº”ç”¨çš„æ—¶å€™ï¼ŒAPP ä¼šè¯¢é—®æ˜¯å¦å…è®¸æˆäºˆæƒé™ï¼ˆè®¿é—®ç›¸å†Œã€åœ°ç†ä½ç½®ç­‰æƒé™ï¼‰ï¼›ä½ åœ¨è®¿é—®å¾®ä¿¡å°ç¨‹åºæ—¶ï¼Œå½“ç™»å½•æ—¶ï¼Œå°ç¨‹åºä¼šè¯¢é—®æ˜¯å¦å…è®¸æˆäºˆæƒé™ï¼ˆè·å–æ˜µç§°ã€å¤´åƒã€åœ°åŒºã€æ€§åˆ«ç­‰ä¸ªäººä¿¡æ¯ï¼‰</li><li>**å®ç°æˆæƒçš„æ–¹å¼æœ‰ï¼š**ä¸šç•Œé€šå¸¸åŸºäº R(role/resource)BAC å®ç°æˆæƒï¼š(1)åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆ2ï¼‰åŸºäºèµ„æºï¼ˆæƒé™ï¼‰çš„è®¿é—®æ§åˆ¶ï¼Œç³»ç»Ÿè®¾è®¡æ—¶å®šä¹‰å¥½æŸé¡¹æ“ä½œçš„æƒé™æ ‡è¯†ï¼Œç³»ç»Ÿæ‰©å±•æ€§å¥½ã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯å‡­è¯ï¼ˆCredentialsï¼‰"><strong>ä»€ä¹ˆæ˜¯å‡­è¯ï¼ˆCredentialsï¼‰</strong></h3><ul><li><strong>å®ç°è®¤è¯å’Œæˆæƒçš„å‰æ</strong>æ˜¯éœ€è¦ä¸€ç§<strong>åª’ä»‹ï¼ˆè¯ä¹¦ï¼‰</strong> æ¥æ ‡è®°è®¿é—®è€…çš„èº«ä»½ã€‚</li><li>ä¾‹å¦‚ï¼šåœ¨æˆ˜å›½æ—¶æœŸï¼Œå•†é…å˜æ³•ï¼Œå‘æ˜äº†ç…§èº«å¸–ã€‚ç…§èº«å¸–ç”±å®˜åºœå‘æ”¾ï¼Œæ˜¯ä¸€å—æ‰“ç£¨å…‰æ»‘ç»†å¯†çš„ç«¹æ¿ï¼Œä¸Šé¢åˆ»æœ‰æŒæœ‰äººçš„å¤´åƒå’Œç±è´¯ä¿¡æ¯ã€‚å›½äººå¿…é¡»æŒæœ‰ï¼Œå¦‚è‹¥æ²¡æœ‰å°±è¢«è®¤ä¸ºæ˜¯é»‘æˆ·ï¼Œæˆ–è€…é—´è°ä¹‹ç±»çš„ã€‚åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæ¯ä¸ªäººéƒ½ä¼šæœ‰ä¸€å¼ ä¸“å±çš„å±…æ°‘èº«ä»½è¯ï¼Œæ˜¯ç”¨äºè¯æ˜æŒæœ‰äººèº«ä»½çš„ä¸€ç§æ³•å®šè¯ä»¶ã€‚é€šè¿‡èº«ä»½è¯ï¼Œæˆ‘ä»¬å¯ä»¥åŠç†æ‰‹æœºå¡/é“¶è¡Œå¡/ä¸ªäººè´·æ¬¾/äº¤é€šå‡ºè¡Œç­‰ç­‰ï¼Œè¿™å°±æ˜¯<strong>è®¤è¯çš„å‡­è¯ã€‚</strong></li><li>åœ¨äº’è”ç½‘åº”ç”¨ä¸­ï¼Œä¸€èˆ¬ç½‘ç«™ä¼šæœ‰ä¸¤ç§æ¨¡å¼ï¼Œæ¸¸å®¢æ¨¡å¼å’Œç™»å½•æ¨¡å¼ã€‚æ¸¸å®¢æ¨¡å¼ä¸‹ï¼Œå¯ä»¥æ­£å¸¸æµè§ˆç½‘ç«™ä¸Šé¢çš„æ–‡ç« ï¼Œä¸€æ—¦æƒ³è¦ç‚¹èµ/æ”¶è—/åˆ†äº«æ–‡ç« ï¼Œå°±éœ€è¦ç™»å½•æˆ–è€…æ³¨å†Œè´¦å·ã€‚å½“ç”¨æˆ·ç™»å½•æˆåŠŸåï¼ŒæœåŠ¡å™¨ä¼šç»™è¯¥ç”¨æˆ·ä½¿ç”¨çš„æµè§ˆå™¨é¢å‘ä¸€ä¸ª<strong>ä»¤ç‰Œï¼ˆtokenï¼‰</strong>ï¼Œè¿™ä¸ªä»¤ç‰Œç”¨æ¥è¡¨æ˜ä½ çš„èº«ä»½ï¼Œæ¯æ¬¡æµè§ˆå™¨å‘é€è¯·æ±‚æ—¶ä¼šå¸¦ä¸Šè¿™ä¸ªä»¤ç‰Œï¼Œå°±å¯ä»¥ä½¿ç”¨æ¸¸å®¢æ¨¡å¼ä¸‹æ— æ³•ä½¿ç”¨çš„åŠŸèƒ½ã€‚</li></ul><h2 id="Cookie-ä¸-Session"><strong>Cookie ä¸ Session</strong></h2><h3 id="ä»€ä¹ˆæ˜¯-Cookieï¼Ÿ">ä»€ä¹ˆæ˜¯ Cookieï¼Ÿ</h3><ul><li><strong>HTTP æ˜¯æ— çŠ¶æ€çš„åè®®ï¼ˆå¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œæ¯æ¬¡å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼šè¯å®Œæˆæ—¶ï¼ŒæœåŠ¡ç«¯ä¸ä¼šä¿å­˜ä»»ä½•ä¼šè¯ä¿¡æ¯</strong>ï¼‰ï¼šæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼ŒæœåŠ¡ç«¯æ— æ³•ç¡®è®¤å½“å‰è®¿é—®è€…çš„èº«ä»½ä¿¡æ¯ï¼Œæ— æ³•åˆ†è¾¨ä¸Šä¸€æ¬¡çš„è¯·æ±‚å‘é€è€…å’Œè¿™ä¸€æ¬¡çš„å‘é€è€…æ˜¯ä¸æ˜¯åŒä¸€ä¸ªäººã€‚æ‰€ä»¥æœåŠ¡å™¨ä¸æµè§ˆå™¨ä¸ºäº†è¿›è¡Œ<strong>ä¼šè¯è·Ÿè¸ª</strong>ï¼ˆçŸ¥é“æ˜¯è°åœ¨è®¿é—®æˆ‘ï¼‰ï¼Œå°±å¿…é¡»ä¸»åŠ¨çš„å»ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯å‰åä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€æµè§ˆå™¨ã€‚è€Œ<strong>è¿™ä¸ªçŠ¶æ€éœ€è¦é€šè¿‡ cookie æˆ–è€… session å»å®ç°ã€‚</strong></li><li><strong>cookie å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼š</strong> cookie æ˜¯æœåŠ¡å™¨å‘é€åˆ°ç”¨æˆ·æµè§ˆå™¨å¹¶ä¿å­˜åœ¨æœ¬åœ°çš„ä¸€å°å—æ•°æ®ï¼Œå®ƒä¼šåœ¨æµè§ˆå™¨ä¸‹æ¬¡å‘åŒä¸€æœåŠ¡å™¨å†å‘èµ·è¯·æ±‚æ—¶è¢«æºå¸¦å¹¶å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚</li><li><strong>cookie æ˜¯ä¸å¯è·¨åŸŸçš„ï¼š</strong> æ¯ä¸ª cookie éƒ½ä¼šç»‘å®šå•ä¸€çš„åŸŸåï¼Œæ— æ³•åœ¨åˆ«çš„åŸŸåä¸‹è·å–ä½¿ç”¨ï¼Œ<strong>ä¸€çº§åŸŸåå’ŒäºŒçº§åŸŸåä¹‹é—´æ˜¯å…è®¸å…±äº«ä½¿ç”¨çš„</strong>ï¼ˆ<strong>é çš„æ˜¯ domainï¼‰</strong>ã€‚</li></ul><p><strong>cookie é‡è¦çš„å±æ€§</strong></p><h3 id="ä»€ä¹ˆæ˜¯-Session"><strong>ä»€ä¹ˆæ˜¯ Session</strong></h3><ul><li><strong>session æ˜¯å¦ä¸€ç§è®°å½•æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¼šè¯çŠ¶æ€çš„æœºåˆ¶</strong>ï¼Œå³å‘Šè¯‰æœåŠ¡ç«¯å‰åä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼ŒçŸ¥é“è°åœ¨è®¿é—®æˆ‘ã€‚<strong>å› ä¸º http æœ¬èº«æ˜¯æ— çŠ¶æ€åè®®</strong>ï¼Œè¿™æ ·ï¼Œæ— æ³•ç¡®å®šä½ çš„æœ¬æ¬¡è¯·æ±‚å’Œä¸Šæ¬¡è¯·æ±‚æ˜¯ä¸æ˜¯ä½ å‘é€çš„ã€‚å¦‚æœè¦è¿›è¡Œç±»ä¼¼è®ºå›ç™»é™†ç›¸å…³çš„æ“ä½œï¼Œå°±å®ç°ä¸äº†äº†ã€‚</li><li><strong>session æ˜¯åŸºäº cookie å®ç°çš„ï¼Œsession å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼ŒsessionId ä¼šè¢«å­˜å‚¨åˆ°å®¢æˆ·ç«¯çš„ cookie ä¸­</strong>ã€‚psï¼šè¿˜æœ‰ä¸€ç§æ˜¯æµè§ˆå™¨ç¦ç”¨äº† cookie æˆ–ä¸æ”¯æŒ cookieï¼Œè¿™ç§å¯ä»¥é€šè¿‡ URL é‡å†™çš„æ–¹å¼å‘åˆ°æœåŠ¡å™¨ï¼›</li></ul><p><strong>session è®¤è¯æµç¨‹ï¼ˆå¦‚ä¸Šå›¾ï¼‰ï¼š</strong></p><ul><li>ç”¨æˆ·ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨æ ¹æ®ç”¨æˆ·æäº¤çš„ç›¸å…³ä¿¡æ¯ï¼Œ<strong>åˆ›å»ºå¯¹åº”çš„ Session</strong></li><li>è¯·æ±‚è¿”å›æ—¶å°†æ­¤ Session çš„<strong>å”¯ä¸€æ ‡è¯†ä¿¡æ¯ SessionID</strong> è¿”å›ç»™æµè§ˆå™¨</li><li>æµè§ˆå™¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›çš„ SessionID ä¿¡æ¯åï¼Œä¼š<strong>å°†æ­¤ä¿¡æ¯å­˜å…¥åˆ° Cookie ä¸­ï¼ŒåŒæ—¶ Cookie è®°å½•æ­¤ SessionID å±äºå“ªä¸ªåŸŸå</strong></li><li><strong>å½“ç”¨æˆ·ç¬¬äºŒæ¬¡è®¿é—®æœåŠ¡å™¨çš„æ—¶å€™ï¼Œè¯·æ±‚ä¼šè‡ªåŠ¨åˆ¤æ–­æ­¤åŸŸåä¸‹æ˜¯å¦å­˜åœ¨ Cookie ä¿¡æ¯</strong>ï¼Œå¦‚æœå­˜åœ¨è‡ªåŠ¨å°† Cookie ä¿¡æ¯ä¹Ÿå‘é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¼šä» Cookie ä¸­è·å– SessionIDï¼Œå†æ ¹æ® SessionID æŸ¥æ‰¾å¯¹åº”çš„ Session ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°è¯´æ˜ç”¨æˆ·æ²¡æœ‰ç™»å½•æˆ–è€…ç™»å½•å¤±æ•ˆï¼Œå¦‚æœæ‰¾åˆ° Session è¯æ˜ç”¨æˆ·å·²ç»ç™»å½•å¯æ‰§è¡Œåé¢æ“ä½œã€‚</li></ul><p>æ ¹æ®ä»¥ä¸Šæµç¨‹å¯çŸ¥ï¼Œ<strong>SessionID æ˜¯è¿æ¥ Cookie å’Œ Session çš„ä¸€é“æ¡¥æ¢</strong>ï¼Œå¤§éƒ¨åˆ†ç³»ç»Ÿä¹Ÿæ˜¯æ ¹æ®æ­¤åŸç†æ¥<strong>éªŒè¯ç”¨æˆ·ç™»å½•çŠ¶æ€ã€‚</strong></p><p>åŸºäº Session çš„è®¤è¯æœºåˆ¶ç”± Servlet è§„èŒƒå®šåˆ¶ï¼ŒServlet å®¹å™¨å·²ç»å®ç°ï¼Œç”¨æˆ·é€šè¿‡ HttpSession çš„æ“ä½œæ–¹æ³•å¯ä»¥å®ç°ï¼š</p><h3 id="Cookie-å’Œ-Session-çš„åŒºåˆ«"><strong>Cookie å’Œ Session çš„åŒºåˆ«</strong></h3><ul><li>**å®‰å…¨æ€§ï¼š**Session æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯çš„ï¼ŒCookie æ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„ã€‚æ‰€ä»¥ Session ç›¸æ¯” Cookie å®‰å…¨ï¼Œ</li><li><strong>å­˜å–å€¼çš„ç±»å‹ä¸åŒ</strong>ï¼šCookie åªæ”¯æŒå­˜å­—ç¬¦ä¸²æ•°æ®ï¼Œæƒ³è¦è®¾ç½®å…¶ä»–ç±»å‹çš„æ•°æ®ï¼Œéœ€è¦å°†å…¶è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ŒSession å¯ä»¥å­˜ä»»æ„æ•°æ®ç±»å‹ã€‚</li><li><strong>æœ‰æ•ˆæœŸä¸åŒï¼š</strong> Cookie å¯è®¾ç½®ä¸ºé•¿æ—¶é—´ä¿æŒï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„é»˜è®¤ç™»å½•åŠŸèƒ½ï¼ŒSession ä¸€èˆ¬å¤±æ•ˆæ—¶é—´è¾ƒçŸ­ï¼Œå®¢æˆ·ç«¯å…³é—­ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰æˆ–è€… Session è¶…æ—¶éƒ½ä¼šå¤±æ•ˆã€‚</li><li><strong>å­˜å‚¨å¤§å°ä¸åŒï¼š</strong> å•ä¸ª Cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼ŒSession å¯å­˜å‚¨æ•°æ®è¿œé«˜äº Cookieï¼Œä½†æ˜¯å½“è®¿é—®é‡è¿‡å¤šï¼Œä¼šå ç”¨è¿‡å¤šçš„æœåŠ¡å™¨èµ„æºã€‚</li></ul><h3 id="æ‹“å±•ï¼šSession-ç—›ç‚¹">æ‹“å±•ï¼šSession ç—›ç‚¹</h3><p>çœ‹èµ·æ¥é€šè¿‡ cookie + session çš„æ–¹å¼æ˜¯è§£å†³äº†é—®é¢˜ï¼Œ ä½†æ˜¯æˆ‘ä»¬å¿½ç•¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œä¸Šè¿°æƒ…å†µèƒ½æ­£å¸¸å·¥ä½œæ˜¯å› ä¸ºæˆ‘ä»¬å‡è®¾ server æ˜¯å•æœºå·¥ä½œçš„ï¼Œä½†å®é™…åœ¨ç”Ÿäº§ä¸Šï¼Œä¸ºäº†ä¿éšœé«˜å¯ç”¨ï¼Œä¸€èˆ¬æœåŠ¡å™¨è‡³å°‘éœ€è¦ä¸¤å°æœºå™¨ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼æ¥å†³å®šåˆ°åº•è¯·æ±‚è¯¥æ‰“åˆ°å“ªå°æœºå™¨ä¸Šã€‚</p><p>å‡è®¾ç™»å½•è¯·æ±‚æ‰“åˆ°äº† A æœºå™¨ï¼ŒA æœºå™¨ç”Ÿæˆäº† session å¹¶åœ¨ cookie é‡Œæ·»åŠ  sessionId è¿”å›ç»™äº†æµè§ˆå™¨ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼šä¸‹æ¬¡æ·»åŠ è´­ç‰©è½¦æ—¶å¦‚æœè¯·æ±‚æ‰“åˆ°äº† B æˆ–è€… Cï¼Œç”±äº session æ˜¯åœ¨ A æœºå™¨ç”Ÿæˆçš„ï¼Œæ­¤æ—¶çš„ B,C æ˜¯æ‰¾ä¸åˆ° session çš„ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç”Ÿæ— æ³•æ·»åŠ è´­ç‰©è½¦çš„é”™è¯¯ï¼Œå°±å¾—é‡æ–°ç™»å½•äº†ï¼Œæ­¤æ—¶è¯·é—®è¯¥æ€ä¹ˆåŠã€‚ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š</p><p>ï¼ˆ1 ï¼‰session å¤åˆ¶</p><p>A ç”Ÿæˆ session åå¤åˆ¶åˆ° B, Cï¼Œè¿™æ ·æ¯å°æœºå™¨éƒ½æœ‰ä¸€ä»½ sessionï¼Œæ— è®ºæ·»åŠ è´­ç‰©è½¦çš„è¯·æ±‚æ‰“åˆ°å“ªå°æœºå™¨ï¼Œç”±äº session éƒ½èƒ½æ‰¾åˆ°ï¼Œæ•…ä¸ä¼šæœ‰é—®é¢˜</p><p>è¿™ç§æ–¹å¼è™½ç„¶å¯è¡Œï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š</p><ul><li>åŒä¸€æ ·çš„ä¸€ä»½ session ä¿å­˜äº†å¤šä»½ï¼Œæ•°æ®å†—ä½™</li><li>å¦‚æœèŠ‚ç‚¹å°‘è¿˜å¥½ï¼Œä½†å¦‚æœèŠ‚ç‚¹å¤šçš„è¯ï¼Œç‰¹åˆ«æ˜¯åƒé˜¿é‡Œï¼Œå¾®ä¿¡è¿™ç§ç”±äº DAU ä¸Šäº¿ï¼Œå¯èƒ½éœ€è¦éƒ¨ç½²æˆåƒä¸Šä¸‡å°æœºå™¨ï¼Œè¿™æ ·èŠ‚ç‚¹å¢å¤šå¤åˆ¶é€ æˆçš„æ€§èƒ½æ¶ˆè€—ä¹Ÿä¼šå¾ˆå¤§ã€‚</li></ul><p>ï¼ˆ2ï¼‰session ç²˜è¿</p><p>è¿™ç§æ–¹å¼æ˜¯è®©æ¯ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åªæ‰“åˆ°å›ºå®šçš„ä¸€å°æœºå™¨ä¸Šï¼Œæ¯”å¦‚æµè§ˆå™¨ç™»å½•è¯·æ±‚æ‰“åˆ° A æœºå™¨åï¼Œåç»­æ‰€æœ‰çš„æ·»åŠ è´­ç‰©è½¦è¯·æ±‚ä¹Ÿéƒ½æ‰“åˆ° A æœºå™¨ä¸Šï¼ŒNginx çš„ sticky æ¨¡å—å¯ä»¥æ”¯æŒè¿™ç§æ–¹å¼ï¼Œæ”¯æŒæŒ‰ ip æˆ– cookie ç²˜è¿ç­‰ç­‰ï¼Œå¦‚æŒ‰ ip ç²˜è¿æ–¹å¼å¦‚ä¸‹</p><p>è¿™æ ·çš„è¯æ¯ä¸ª client è¯·æ±‚åˆ°è¾¾ Nginx åï¼Œåªè¦å®ƒçš„ ip ä¸å˜ï¼Œæ ¹æ® ip hash ç®—å‡ºæ¥çš„å€¼ä¼šæ‰“åˆ°å›ºå®šçš„æœºå™¨ä¸Šï¼Œä¹Ÿå°±ä¸å­˜åœ¨ session æ‰¾ä¸åˆ°çš„é—®é¢˜äº†ï¼Œå½“ç„¶ä¸éš¾çœ‹å‡ºè¿™ç§æ–¹å¼ç¼ºç‚¹ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾ï¼Œå¯¹åº”çš„æœºå™¨æŒ‚äº†æ€ä¹ˆåŠï¼Ÿ</p><p>ï¼ˆ3ï¼‰session å…±äº«</p><p>è¿™ç§æ–¹å¼ä¹Ÿæ˜¯ç›®å‰å„å¤§å…¬å¸æ™®éé‡‡ç”¨çš„æ–¹æ¡ˆï¼Œå°† session ä¿å­˜åœ¨ redisï¼Œmemcached ç­‰ä¸­é—´ä»¶ä¸­ï¼Œè¯·æ±‚åˆ°æ¥æ—¶ï¼Œå„ä¸ªæœºå™¨å»è¿™äº›ä¸­é—´ä»¶å–ä¸€ä¸‹ session å³å¯ã€‚</p><p>ç¼ºç‚¹å…¶å®ä¹Ÿä¸éš¾å‘ç°ï¼Œå°±æ˜¯æ¯ä¸ªè¯·æ±‚éƒ½è¦å» redis å–ä¸€ä¸‹ sessionï¼Œå¤šäº†ä¸€æ¬¡å†…éƒ¨è¿æ¥ï¼Œæ¶ˆè€—äº†ä¸€ç‚¹æ€§èƒ½ï¼Œå¦å¤–ä¸ºäº†ä¿è¯ redis çš„é«˜å¯ç”¨ï¼Œå¿…é¡»åšé›†ç¾¤ï¼Œå½“ç„¶äº†å¯¹äºå¤§å…¬å¸æ¥è¯´, redis é›†ç¾¤åŸºæœ¬éƒ½ä¼šéƒ¨ç½²ï¼Œæ‰€ä»¥è¿™æ–¹æ¡ˆå¯ä»¥è¯´æ˜¯å¤§å…¬å¸çš„é¦–é€‰äº†ã€‚</p><h2 id="Tokenï¼ˆä»¤ç‰Œï¼‰ä¸-JWTï¼ˆè·¨åŸŸè®¤è¯ï¼‰"><strong>Tokenï¼ˆä»¤ç‰Œï¼‰ä¸</strong> JWTï¼ˆè·¨åŸŸè®¤è¯ï¼‰</h2><h3 id="Token-æ¦‚è¿°ï¼ˆno-session-ï¼‰">Token æ¦‚è¿°ï¼ˆno session!ï¼‰</h3><p>é€šè¿‡ä¸Šæ–‡åˆ†ææˆ‘ä»¬çŸ¥é“é€šè¿‡åœ¨æœåŠ¡ç«¯å…±äº« session çš„æ–¹å¼å¯ä»¥å®Œæˆç”¨æˆ·çš„èº«ä»½å®šä½ï¼Œä½†æ˜¯ä¸éš¾å‘ç°ä¹Ÿæœ‰ä¸€ä¸ªå°å°çš„ç‘•ç–µï¼šæä¸ªæ ¡éªŒæœºåˆ¶æˆ‘è¿˜å¾—æ­ä¸ª redis é›†ç¾¤ï¼Ÿå¤§å‚ç¡®å® redis ç”¨å¾—æ¯”è¾ƒæ™®éï¼Œä½†å¯¹äºå°å‚æ¥è¯´å¯èƒ½å®ƒçš„ä¸šåŠ¡é‡è¿˜æœªè¾¾åˆ°ç”¨ redis çš„ç¨‹åº¦ï¼Œæ‰€ä»¥æœ‰æ²¡æœ‰å…¶ä»–ä¸ç”¨ server å­˜å‚¨ session çš„ç”¨æˆ·èº«ä»½æ ¡éªŒæœºåˆ¶å‘¢ï¼Œä½¿ç”¨ tokenï¼</p><p>ç®€å•æ¥è¯´ï¼šé¦–å…ˆè¯·æ±‚æ–¹è¾“å…¥è‡ªå·±çš„ç”¨æˆ·åï¼Œå¯†ç ï¼Œç„¶å server æ®æ­¤ç”Ÿæˆ tokenï¼Œå®¢æˆ·ç«¯æ‹¿åˆ° token åä¼šä¿å­˜åˆ°æœ¬åœ°ï¼ˆtoken å­˜å‚¨åœ¨æµè§ˆå™¨ç«¯ï¼‰ï¼Œä¹‹åå‘ server è¯·æ±‚æ—¶åœ¨è¯·æ±‚å¤´å¸¦ä¸Šæ­¤ token å³å¯ï¼ˆserver æœ‰æ ¡éªŒæœºåˆ¶ï¼Œæ£€éªŒ token åˆæ³•æ€§ï¼ŒåŒæ—¶ server é€šè¿‡ token ä¸­æºå¸¦çš„ uid ç¡®å®šæ˜¯è°åœ¨è®¿é—®å®ƒï¼‰ã€‚</p><p><img src="images/token.webp" alt="token.webp"><br>å¯ä»¥çœ‹åˆ° token ä¸»è¦ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ul><li>headerï¼šæŒ‡å®šäº†ç­¾åç®—æ³•</li><li>payloadï¼šå¯ä»¥æŒ‡å®šç”¨æˆ· idï¼Œè¿‡æœŸæ—¶é—´ç­‰éæ•æ„Ÿæ•°æ®</li><li>Signature: ç­¾åï¼Œserver æ ¹æ® header çŸ¥é“å®ƒè¯¥ç”¨å“ªç§ç­¾åç®—æ³•ï¼Œå†ç”¨å¯†é’¥æ ¹æ®æ­¤ç­¾åç®—æ³•å¯¹ head + payload ç”Ÿæˆç­¾åï¼Œè¿™æ ·ä¸€ä¸ª token å°±ç”Ÿæˆäº†ã€‚</li></ul><p>å½“ server æ”¶åˆ°æµè§ˆå™¨ä¼ è¿‡æ¥çš„ token æ—¶ï¼Œå®ƒä¼šé¦–å…ˆå–å‡º token ä¸­çš„ header + payloadï¼Œæ ¹æ®å¯†é’¥ç”Ÿæˆç­¾åï¼Œç„¶åå†ä¸ token ä¸­çš„ç­¾åæ¯”å¯¹ï¼Œå¦‚æœæˆåŠŸåˆ™è¯´æ˜ç­¾åæ˜¯åˆæ³•çš„ï¼Œå³ token æ˜¯åˆæ³•çš„ã€‚è€Œä¸”ä½ ä¼šå‘ç° payload ä¸­å­˜æœ‰æˆ‘ä»¬çš„ userIdï¼Œæ‰€ä»¥æ‹¿åˆ° token åç›´æ¥åœ¨ payload ä¸­å°±å¯è·å– useridï¼Œé¿å…äº†<strong>åƒ session é‚£æ ·è¦ä» redis å»å–çš„å¼€é”€</strong>ã€‚</p><p>ä½ ä¼šå‘ç°è¿™ç§æ–¹å¼ç¡®å®å¾ˆå¦™ï¼Œåªè¦ server ä¿è¯å¯†é’¥ä¸æ³„éœ²ï¼Œé‚£ä¹ˆç”Ÿæˆçš„ token å°±æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå¦‚æœä¼ªé€  token çš„è¯åœ¨ç­¾åéªŒè¯ç¯èŠ‚æ˜¯æ— æ³•é€šè¿‡çš„ï¼Œå°±æ­¤å³å¯åˆ¤å®š token éæ³•ã€‚</p><p>å¯ä»¥çœ‹åˆ°é€šè¿‡è¿™ç§æ–¹å¼æœ‰æ•ˆåœ°é¿å…äº† token å¿…é¡»ä¿å­˜åœ¨ server çš„å¼Šç«¯ï¼Œå®ç°äº†åˆ†å¸ƒå¼å­˜å‚¨ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œtoken ä¸€æ—¦ç”± server ç”Ÿæˆï¼Œå®ƒå°±æ˜¯æœ‰æ•ˆçš„ï¼Œç›´åˆ°è¿‡æœŸï¼Œæ— æ³•è®© token å¤±æ•ˆï¼Œé™¤éåœ¨ server ä¸º token è®¾ç«‹ä¸€ä¸ªé»‘åå•ï¼Œåœ¨æ ¡éªŒ token å‰å…ˆè¿‡ä¸€éæ­¤é»‘åå•ï¼Œå¦‚æœåœ¨é»‘åå•é‡Œåˆ™æ­¤ token å¤±æ•ˆï¼Œä½†ä¸€æ—¦è¿™æ ·åšçš„è¯ï¼Œé‚£å°±æ„å‘³ç€é»‘åå•å°±å¿…é¡»ä¿å­˜åœ¨ serverï¼Œè¿™åˆå›åˆ°äº† session çš„æ¨¡å¼ï¼Œé‚£ç›´æ¥ç”¨ session ä¸é¦™å—ã€‚æ‰€ä»¥ä¸€èˆ¬çš„åšæ³•æ˜¯å½“å®¢æˆ·ç«¯ç™»å‡ºè¦è®© token å¤±æ•ˆæ—¶ï¼Œç›´æ¥åœ¨æœ¬åœ°ç§»é™¤ token å³å¯ï¼Œä¸‹æ¬¡ç™»å½•é‡æ–°ç”Ÿæˆ token å°±å¥½ã€‚</p><p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ <strong>token ä¸€èˆ¬æ˜¯æ”¾åœ¨ header çš„ Authorization è‡ªå®šä¹‰å¤´é‡Œï¼Œä¸æ˜¯æ”¾åœ¨ Cookie é‡Œçš„ï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†è§£å†³è·¨åŸŸä¸èƒ½å…±äº« Cookie çš„é—®é¢˜</strong></p><p><strong>æ€»ç»“ï¼štoken è§£å†³ä»€ä¹ˆé—®é¢˜ï¼ˆä¸ºä»€ä¹ˆè¦ç”¨ tokenï¼‰ï¼Ÿ</strong></p><ul><li><strong>å®Œå…¨ç”±åº”ç”¨ç®¡ç†ï¼Œå¯ä»¥é¿å¼€åŒæºç­–ç•¥</strong></li><li><strong>æ”¯æŒè·¨åŸŸè®¿é—®ï¼Œcookie ä¸æ”¯æŒ</strong>ï¼Œ Cookie è·¨ç«™æ˜¯ä¸èƒ½å…±äº«çš„ï¼Œè¿™æ ·çš„è¯å¦‚æœä½ è¦å®ç°å¤šåº”ç”¨ï¼ˆå¤šç³»ç»Ÿï¼‰çš„å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ï¼Œä½¿ç”¨ Cookie æ¥åšéœ€è¦çš„è¯å°±å¾ˆå›°éš¾äº†ã€‚ä½†å¦‚æœç”¨ token æ¥å®ç° SSO ä¼šéå¸¸ç®€å•ï¼Œåªè¦åœ¨ header ä¸­çš„ authorize å­—æ®µï¼ˆæˆ–å…¶ä»–è‡ªå®šä¹‰ï¼‰åŠ ä¸Š token å³å¯å®Œæˆæ‰€æœ‰è·¨åŸŸç«™ç‚¹çš„è®¤è¯ã€‚</li><li><strong>token æ˜¯æ— çŠ¶æ€çš„ï¼Œå¯ä»¥åœ¨å¤šä¸ªæœåŠ¡å™¨é—´å…±äº«</strong></li><li><strong>token å¯ä»¥é¿å… CSRF æ”»å‡»ï¼ˆè·¨ç«™è¯·æ±‚æ”»å‡»ï¼‰</strong></li><li>æ˜“äºæ‰©å±•ï¼Œåœ¨ç§»åŠ¨ç«¯åŸç”Ÿè¯·æ±‚æ˜¯æ²¡æœ‰ cookie ä¹‹è¯´çš„ï¼Œè€Œ sessionid ä¾èµ–äº cookieï¼Œsessionid å°±ä¸èƒ½ç”¨ cookie æ¥ä¼ äº†ï¼Œå¦‚æœç”¨ token çš„è¯ï¼Œç”±äºå®ƒæ˜¯éšç€ header çš„ authoriize ä¼ è¿‡æ¥çš„ï¼Œä¹Ÿå°±ä¸å­˜åœ¨æ­¤é—®é¢˜ï¼Œæ¢å¥è¯è¯´ token å¤©ç”Ÿæ”¯æŒç§»åŠ¨å¹³å°ï¼Œå¯æ‰©å±•æ€§å¥½</li></ul><blockquote><p><strong>æ‹“å±• 1ï¼šé‚£å•¥æ˜¯ CSRF å‘¢ï¼Ÿ</strong></p></blockquote><p>æ”»å‡»è€…é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å»è®¿é—®ä¸€ä¸ªè‡ªå·±æ›¾ç»è®¤è¯è¿‡çš„ç½‘ç«™å¹¶è¿è¡Œä¸€äº›æ“ä½œï¼ˆå¦‚å‘é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç”šè‡³è´¢äº§æ“ä½œå¦‚è½¬è´¦å’Œè´­ä¹°å•†å“ï¼‰ã€‚<strong>ç”±äºæµè§ˆå™¨æ›¾ç»è®¤è¯è¿‡ï¼ˆcookie é‡Œå¸¦æ¥ sessionId ç­‰èº«ä»½è®¤è¯çš„ä¿¡æ¯ï¼‰ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç½‘ç«™ä¼šè®¤ä¸ºæ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»è¿è¡Œã€‚</strong></p><p>é‚£ä¹ˆå¦‚æœæ­£å¸¸çš„ç”¨æˆ·è¯¯ç‚¹äº†ä¸Šé¢è¿™å¼ å›¾ç‰‡ï¼Œç”±äºç›¸åŒåŸŸåçš„è¯·æ±‚ä¼šè‡ªåŠ¨å¸¦ä¸Š cookieï¼Œè€Œ cookie é‡Œå¸¦æœ‰æ­£å¸¸ç™»å½•ç”¨æˆ·çš„ sessionidï¼Œç±»ä¼¼ä¸Šé¢è¿™æ ·çš„è½¬è´¦æ“ä½œåœ¨ server å°±ä¼šæˆåŠŸï¼Œä¼šé€ æˆæå¤§çš„å®‰å…¨é£é™©</p><p><strong>CSRF æ”»å‡»çš„æ ¹æœ¬åŸå› åœ¨äºå¯¹äºåŒæ ·åŸŸåçš„æ¯ä¸ªè¯·æ±‚æ¥è¯´ï¼Œå®ƒçš„ cookie éƒ½ä¼šè¢«è‡ªåŠ¨å¸¦ä¸Šï¼Œè¿™ä¸ªæ˜¯æµè§ˆå™¨çš„æœºåˆ¶å†³å®šçš„ï¼</strong></p><p>è‡³äºå®Œæˆä¸€æ¬¡ CSRF æ”»å‡»å¿…è¦çš„ä¸¤ä¸ªæ­¥éª¤ï¼š</p><p>1ã€é¦–å…ˆç™»äº†ä¸€ä¸ªæ­£å¸¸çš„ç½‘ç«™ Aï¼Œå¹¶ä¸”åœ¨æœ¬åœ°ç”Ÿæˆäº† cookie<br>2ã€åœ¨ cookie æœ‰æ•ˆæ—¶é—´å†…ï¼Œè®¿é—®äº†å±é™©ç½‘ç«™ Bï¼ˆå°±è·å–äº†èº«ä»½ä¿¡æ¯ï¼‰</p><p>Qï¼šé‚£æˆ‘ä¸è®¿é—®å±é™©ç½‘ç«™å°±å®Œäº†å‘—ï¼Ÿ<br><strong>Aï¼šå±é™©ç½‘ç«™ä¹Ÿè®¸åªæ˜¯ä¸ªå­˜åœ¨æ¼æ´çš„å¯ä¿¡ä»»ç½‘ç«™ï¼</strong></p><p>Qï¼šé‚£æˆ‘è®¿é—®å®Œæ­£å¸¸ç½‘ç«™ï¼Œå…³äº†æµè§ˆå™¨å°±å¥½äº†å‘€ï¼Ÿ<br><strong>Aï¼šå³ä½¿å…³é—­æµè§ˆå™¨ï¼Œcookie ä¹Ÿä¸ä¿è¯ä¸€å®šç«‹å³å¤±æ•ˆï¼Œè€Œä¸”å…³é—­æµè§ˆå™¨å¹¶ä¸èƒ½ç»“æŸä¼šè¯ï¼Œsession çš„ç”Ÿå‘½å‘¨æœŸè·Ÿè¿™äº›éƒ½æ²¡å…³ç³»ã€‚</strong></p><blockquote><p><strong>æ‹“å±• 2ï¼šåŒæºç­–ç•¥ï¼Ÿ</strong></p></blockquote><ul><li>å°±æ˜¯ä¸åŒæºçš„å®¢æˆ·ç«¯è„šæœ¬åœ¨æ²¡æœ‰æ˜ç¡®æˆæƒæƒ…å†µä¸‹ï¼Œä¸å‡†è¯»å†™å¯¹æ–¹çš„èµ„æºï¼</li><li><strong>åŒæºå°±æ˜¯ï¼šåè®®ã€åŸŸåä¸ç«¯å£å·éƒ½ç›¸åŒã€‚</strong></li><li>åŒæºç­–ç•¥æ˜¯ç”± Netscape æå‡ºçš„è‘—åå®‰å…¨ç­–ç•¥ï¼Œæ˜¯æµè§ˆå™¨æœ€æ ¸å¿ƒã€åŸºæœ¬çš„å®‰å…¨åŠŸèƒ½ï¼Œå®ƒé™åˆ¶äº†ä¸€ä¸ªæºä¸­åŠ è½½è„šæœ¬ä¸æ¥è‡ªå…¶ä»–æºä¸­èµ„æºçš„äº¤äº’æ–¹å¼ã€‚</li></ul><blockquote><p><strong>æ‹“å±• 3ï¼šä»€ä¹ˆæ˜¯è·¨åŸŸï¼Œå¦‚ä½•è§£å†³ï¼Ÿ</strong></p></blockquote><ul><li><p>å½“æµè§ˆå™¨æ‰§è¡Œè„šæœ¬æ—¶ä¼š<strong>æ£€æŸ¥æ˜¯å¦åŒæº</strong>ï¼Œåªæœ‰åŒæºçš„è„šæœ¬æ‰ä¼šæ‰§è¡Œï¼Œå¦‚æœä¸åŒæºå³ä¸ºè·¨åŸŸã€‚</p></li><li><p><strong>äº§ç”ŸåŸå› </strong>ï¼šå®ƒæ˜¯ç”±<strong>æµè§ˆå™¨çš„åŒæºç­–ç•¥</strong>é€ æˆçš„ï¼Œæ˜¯æµè§ˆå™¨å¯¹ JavaScript å®æ–½çš„å®‰å…¨é™åˆ¶ã€‚</p></li><li><p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p><ul><li><strong>nginxï¼ˆé™æ€æœåŠ¡å™¨ï¼‰åå‘ä»£ç†è§£å†³è·¨åŸŸ</strong>ï¼ˆå‰ç«¯å¸¸ç”¨ï¼‰ï¼Œ<strong>a æ˜ç¡®è®¿é—® c ä»£ç†æœåŠ¡å™¨</strong>ï¼Œä½†æ˜¯ä¸çŸ¥é“ c çš„å†…å®¹ä»å“ªé‡Œæ¥ï¼Œc åå‘ä»åˆ«çš„åœ°æ–¹æ‹¿æ¥æ•°æ®ã€‚(å¿½ç•¥çš„æ˜¯ç›®æ ‡åœ°å€)ï¼Œ<strong>æµè§ˆå™¨å¯ä»¥è®¿é—® a,è€ŒæœåŠ¡å™¨ä¹‹é—´ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜</strong>ï¼Œæµè§ˆå™¨å…ˆè®¿é—® a çš„æœåŠ¡å™¨ cï¼Œè®© c æœåŠ¡å™¨ä½œä¸ºä»£ç†å»è®¿é—® b æœåŠ¡å™¨,æ‹¿åˆ°ä¹‹åå†è¿”å›æ•°æ®ç»™ aã€‚</li><li>jsonpï¼šé€šå¸¸ä¸ºäº†å‡è½» web æœåŠ¡å™¨çš„è´Ÿè½½ï¼Œæˆ‘ä»¬æŠŠ jsã€cssã€å›¾ç‰‡ç­‰é™æ€èµ„æºåˆ†ç¦»åˆ°å¦ä¸€å°ç‹¬ç«‹åŸŸåçš„æœåŠ¡å™¨ä¸Šï¼Œåœ¨ html é¡µé¢ä¸­å†é€šè¿‡ç›¸åº”çš„æ ‡ç­¾ä»ä¸åŒåŸŸåä¸‹åŠ è½½é™æ€èµ„æºï¼Œè€Œè¢«æµè§ˆå™¨å…è®¸ã€‚</li><li>æ·»åŠ å“åº”å¤´</li></ul></li></ul><blockquote><p>æ‹“å±• 4ï¼šæ˜“äºæ‰©å±•ï¼Ÿ</p></blockquote><ul><li>æ¯”å¦‚æœ‰å¤šå°æœåŠ¡å™¨ï¼Œä½¿ç”¨<strong>è´Ÿè½½å‡è¡¡</strong>ï¼Œç¬¬ä¸€æ¬¡ç™»å½•è½¬å‘åˆ°äº† Aï¼ŒA ä¸­ seesion ç¼“å­˜äº†ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼Œç¬¬äºŒæ¬¡ç™»å½•è½¬å‘åˆ°äº† Bï¼Œè¿™æ—¶å€™å°±ä¸¢å¤±äº†ç™»å½•çŠ¶æ€ï¼Œå½“ç„¶è¿™æ ·ä¹Ÿæ˜¯æœ‰è§£å†³æ–¹æ¡ˆå¯ä»¥å…±äº« sessionï¼Œä½†<strong>token åªéœ€è¦æ‰€æœ‰çš„æœåŠ¡å™¨ä½¿ç”¨ç›¸åŒçš„è§£å¯†æ‰‹æ®µå³å¯ã€‚</strong></li></ul><blockquote><p>æ‹“å±• 5ï¼šæ— çŠ¶æ€ï¼Ÿ</p></blockquote><ul><li>æœåŠ¡ç«¯ä¸ä¿å­˜å®¢æˆ·ç«¯è¯·æ±‚è€…çš„ä»»ä½•ä¿¡æ¯ï¼Œ<strong>å®¢æˆ·ç«¯æ¯æ¬¡è¯·æ±‚å¿…é¡»è‡ªå¤‡æè¿°ä¿¡æ¯ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯æ¥è¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ã€‚æœåŠ¡ç«¯åªéœ€è¦ç¡®è®¤è¯¥ token æ˜¯å¦æ˜¯è‡ªå·±äº²è‡ªç­¾å‘å³å¯ï¼Œç­¾å‘å’ŒéªŒè¯éƒ½åœ¨æœåŠ¡ç«¯è¿›è¡Œã€‚</strong></li></ul><blockquote><p><strong>æ‹“å±• 6ï¼šä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•ï¼Ÿ</strong></p></blockquote><ul><li>æ‰€è°“å•ç‚¹ç™»å½•ï¼Œæ˜¯æŒ‡åœ¨å¤šä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡å°±å¯ä»¥è®¿é—®æ‰€æœ‰ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚</li></ul><h4 id="Acesss-Token">Acesss Token</h4><ul><li><strong>è®¿é—®èµ„æºæ¥å£ï¼ˆAPIï¼‰æ—¶æ‰€éœ€è¦çš„èµ„æºå‡­è¯</strong></li><li><strong>ç®€å• token çš„ç»„æˆï¼š</strong> uid(ç”¨æˆ·å”¯ä¸€çš„èº«ä»½æ ‡è¯†)ã€time(å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³)ã€signï¼ˆç­¾åï¼Œtoken çš„å‰å‡ ä½ä»¥å“ˆå¸Œç®—æ³•å‹ç¼©æˆçš„ä¸€å®šé•¿åº¦çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼‰</li></ul><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li><strong>æœåŠ¡ç«¯æ— çŠ¶æ€åŒ–ã€å¯æ‰©å±•æ€§å¥½</strong></li><li><strong>æ”¯æŒç§»åŠ¨ç«¯è®¾å¤‡</strong></li><li>å®‰å…¨æ€§é«˜</li><li>æ”¯æŒè·¨ç¨‹åºè°ƒç”¨</li></ul><p><strong>token çš„èº«ä»½éªŒè¯æµç¨‹ï¼š</strong></p><ol><li>å®¢æˆ·ç«¯ä½¿ç”¨ç”¨æˆ·åè·Ÿå¯†ç è¯·æ±‚ç™»å½•</li><li>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œå»éªŒè¯ç”¨æˆ·åä¸å¯†ç </li><li><strong>éªŒè¯æˆåŠŸåï¼ŒæœåŠ¡ç«¯ä¼šç­¾å‘ä¸€ä¸ª token å¹¶æŠŠè¿™ä¸ª token å‘é€ç»™å®¢æˆ·ç«¯</strong></li><li>å®¢æˆ·ç«¯æ”¶åˆ° token ä»¥åï¼Œä¼šæŠŠå®ƒå­˜å‚¨èµ·æ¥ï¼Œæ¯”å¦‚æ”¾åœ¨ cookie é‡Œæˆ–è€… localStorage é‡Œ</li><li>å®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡ç«¯è¯·æ±‚èµ„æºçš„æ—¶å€™éœ€è¦å¸¦ç€æœåŠ¡ç«¯ç­¾å‘çš„ token</li><li>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚ï¼Œç„¶åå»éªŒè¯å®¢æˆ·ç«¯è¯·æ±‚é‡Œé¢å¸¦ç€çš„ token ï¼Œ<strong>å¦‚æœéªŒè¯æˆåŠŸï¼Œå°±å‘å®¢æˆ·ç«¯è¿”å›è¯·æ±‚çš„æ•°æ®</strong></li></ol><p><strong>æ³¨æ„ç‚¹</strong>ï¼š</p><ul><li><strong>æ¯ä¸€æ¬¡è¯·æ±‚éƒ½éœ€è¦æºå¸¦ tokenï¼Œéœ€è¦æŠŠ token æ”¾åˆ° HTTP çš„ Header é‡Œ</strong></li><li><strong>åŸºäº token çš„ç”¨æˆ·è®¤è¯æ˜¯ä¸€ç§æœåŠ¡ç«¯æ— çŠ¶æ€çš„è®¤è¯æ–¹å¼ï¼ŒæœåŠ¡ç«¯ä¸ç”¨å­˜æ”¾ token æ•°æ®ã€‚ç”¨è§£æ token çš„è®¡ç®—æ—¶é—´æ¢å– session çš„å­˜å‚¨ç©ºé—´ï¼Œä»è€Œå‡è½»æœåŠ¡å™¨çš„å‹åŠ›ï¼Œå‡å°‘é¢‘ç¹çš„æŸ¥è¯¢æ•°æ®åº“</strong></li><li><strong>token å®Œå…¨ç”±åº”ç”¨ç®¡ç†ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é¿å¼€åŒæºç­–ç•¥</strong></li></ul><h4 id="Refresh-Token"><strong>Refresh Token</strong></h4><ul><li>å¦å¤–ä¸€ç§ tokenâ€”â€”refresh token</li><li>refresh token æ˜¯ä¸“ç”¨äºåˆ·æ–° access token çš„ tokenã€‚å¦‚æœæ²¡æœ‰ refresh tokenï¼Œä¹Ÿå¯ä»¥åˆ·æ–° access tokenï¼Œä½†æ¯æ¬¡åˆ·æ–°éƒ½è¦ç”¨æˆ·è¾“å…¥ç™»å½•ç”¨æˆ·åä¸å¯†ç ï¼Œä¼šå¾ˆéº»çƒ¦ã€‚æœ‰äº† refresh tokenï¼Œå¯ä»¥å‡å°‘è¿™ä¸ªéº»çƒ¦ï¼Œå®¢æˆ·ç«¯ç›´æ¥ç”¨ refresh token å»æ›´æ–° access tokenï¼Œæ— éœ€ç”¨æˆ·è¿›è¡Œé¢å¤–çš„æ“ä½œã€‚</li></ul><p><strong>ä¸¤è€…åŒºåˆ«</strong>ï¼š</p><ul><li>Access Token çš„æœ‰æ•ˆæœŸæ¯”è¾ƒçŸ­ï¼Œå½“ Acesss Token ç”±äºè¿‡æœŸè€Œå¤±æ•ˆæ—¶ï¼Œä½¿ç”¨ Refresh Token å°±å¯ä»¥è·å–åˆ°æ–°çš„ Tokenï¼Œå¦‚æœ Refresh Token ä¹Ÿå¤±æ•ˆäº†ï¼Œç”¨æˆ·å°±åªèƒ½é‡æ–°ç™»å½•äº†ã€‚</li><li>Refresh Token åŠè¿‡æœŸæ—¶é—´æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨çš„æ•°æ®åº“ä¸­ï¼Œåªæœ‰åœ¨ç”³è¯·æ–°çš„ Acesss Token æ—¶æ‰ä¼šéªŒè¯ï¼Œä¸ä¼šå¯¹ä¸šåŠ¡æ¥å£å“åº”æ—¶é—´é€ æˆå½±å“ï¼Œä¹Ÿä¸éœ€è¦å‘ Session ä¸€æ ·ä¸€ç›´ä¿æŒåœ¨å†…å­˜ä¸­ä»¥åº”å¯¹å¤§é‡çš„è¯·æ±‚ã€‚</li></ul><h3 id="Token-çš„ç¼ºç‚¹"><strong>Token çš„ç¼ºç‚¹</strong></h3><p>é‚£æœ‰äººå°±é—®äº†ï¼Œæ—¢ç„¶ token è¿™ä¹ˆå¥½ï¼Œé‚£ä¸ºä»€ä¹ˆå„ä¸ªå¤§å…¬å¸å‡ ä¹éƒ½é‡‡ç”¨å…±äº« session çš„æ–¹å¼å‘¢ï¼Œå¯èƒ½å¾ˆå¤šäººæ˜¯ç¬¬ä¸€æ¬¡å¬åˆ° tokenï¼Œtoken ä¸é¦™å—? token æœ‰ä»¥ä¸‹ä¸¤ç‚¹åŠ£åŠ¿ï¼š</p><ul><li>token å¤ªé•¿äº†ï¼š<strong>token æ˜¯ header, payload ç¼–ç åçš„æ ·å¼ï¼Œæ‰€ä»¥ä¸€èˆ¬è¦æ¯” sessionId é•¿å¾ˆå¤š</strong>ï¼Œå¾ˆæœ‰å¯èƒ½è¶…å‡º cookie çš„å¤§å°é™åˆ¶ï¼ˆcookie ä¸€èˆ¬æœ‰å¤§å°é™åˆ¶çš„ï¼Œå¦‚ 4kbï¼‰ï¼Œå¦‚æœä½ åœ¨ token ä¸­å­˜å‚¨çš„ä¿¡æ¯è¶Šé•¿ï¼Œé‚£ä¹ˆ token æœ¬èº«ä¹Ÿä¼šè¶Šé•¿ï¼Œè¿™æ ·çš„è¯ç”±äºä½ æ¯æ¬¡è¯·æ±‚éƒ½ä¼šå¸¦ä¸Š tokenï¼Œå¯¹è¯·æ±‚æ¥æ˜¯ä¸ªä¸å°çš„è´Ÿæ‹…</li><li>ä¸å¤ªå®‰å…¨ï¼šç½‘ä¸Šå¾ˆå¤šæ–‡ç« è¯´ token æ›´å®‰å…¨ï¼Œå…¶å®ä¸ç„¶ï¼Œç»†å¿ƒçš„ä½ å¯èƒ½å‘ç°äº†ï¼Œæˆ‘ä»¬è¯´ token æ˜¯å­˜åœ¨æµè§ˆå™¨çš„ï¼Œå†ç»†é—®ï¼Œå­˜åœ¨æµè§ˆå™¨çš„å“ªé‡Œï¼Ÿæ—¢ç„¶å®ƒå¤ªé•¿æ”¾åœ¨ cookie é‡Œå¯èƒ½å¯¼è‡´ cookie è¶…é™ï¼Œé‚£å°±åªå¥½æ”¾åœ¨ local storage é‡Œï¼Œè¿™æ ·ä¼šé€ æˆå®‰å…¨éšæ‚£ï¼Œ<strong>å› ä¸º local storage è¿™ç±»çš„æœ¬åœ°å­˜å‚¨æ˜¯å¯ä»¥è¢« JS ç›´æ¥è¯»å–çš„ï¼Œå¦å¤–ç”±ä¸Šæ–‡ä¹Ÿæåˆ°ï¼Œtoken ä¸€æ—¦ç”Ÿæˆæ— æ³•è®©å…¶å¤±æ•ˆï¼Œå¿…é¡»ç­‰åˆ°å…¶è¿‡æœŸæ‰è¡Œï¼Œè¿™æ ·çš„è¯å¦‚æœæœåŠ¡ç«¯æ£€æµ‹åˆ°äº†ä¸€ä¸ªå®‰å…¨å¨èƒï¼Œä¹Ÿæ— æ³•ä½¿ç›¸å…³çš„ token å¤±æ•ˆã€‚</strong></li></ul><p><strong>æ‰€ä»¥ token æ›´é€‚åˆä¸€æ¬¡æ€§çš„å‘½ä»¤è®¤è¯ï¼Œè®¾ç½®ä¸€ä¸ªæ¯”è¾ƒçŸ­çš„æœ‰æ•ˆæœŸï¼ï¼ï¼</strong></p><p>æ‹“å±•ï¼šä¸ç®¡æ˜¯ cookie è¿˜æ˜¯ tokenï¼Œ<strong>ä»å­˜å‚¨è§’åº¦æ¥çœ‹å…¶å®éƒ½ä¸å®‰å…¨ï¼ˆå®é™…ä¸Šé˜²æŠ¤ CSRF æ”»å‡»çš„æ­£ç¡®æ–¹å¼æ˜¯ç”¨ CSRF tokenï¼‰ï¼Œéƒ½æœ‰æš´éœ²çš„é£é™©ï¼Œæˆ‘ä»¬æ‰€è¯´çš„å®‰å…¨æ›´å¤šçš„æ˜¯å¼ºè°ƒä¼ è¾“ä¸­çš„å®‰å…¨ï¼Œå¯ä»¥ç”¨ HTTPS åè®®æ¥ä¼ è¾“ï¼Œ è¿™æ ·çš„è¯è¯·æ±‚å¤´éƒ½èƒ½è¢«åŠ å¯†ï¼Œä¹Ÿå°±ä¿è¯äº†ä¼ è¾“ä¸­çš„å®‰å…¨ã€‚</strong></p><p>å…¶å®æˆ‘ä»¬æŠŠ cookie å’Œ token æ¯”è¾ƒæœ¬èº«å°±ä¸åˆç†ï¼Œä¸€ä¸ªæ˜¯å­˜å‚¨æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯éªŒè¯æ–¹å¼ï¼Œæ­£ç¡®çš„æ¯”è¾ƒåº”è¯¥æ˜¯ session vs tokenã€‚</p><h3 id="Token-å’Œ-Session-çš„åŒºåˆ«"><strong>Token å’Œ Session çš„åŒºåˆ«</strong></h3><p><strong>token å’Œ session å…¶å®éƒ½æ˜¯ä¸ºäº†èº«ä»½éªŒè¯ï¼Œsession ä¸€èˆ¬ç¿»è¯‘ä¸ºä¼šè¯ï¼Œè€Œ token æ›´å¤šçš„æ—¶å€™æ˜¯ç¿»è¯‘ä¸ºä»¤ç‰Œï¼›session å’Œ token éƒ½æ˜¯æœ‰è¿‡æœŸæ—¶é—´ä¸€è¯´ï¼Œéƒ½éœ€è¦å»ç®¡ç†è¿‡æœŸæ—¶é—´ï¼›</strong></p><ul><li>Session æ˜¯ä¸€ç§<strong>è®°å½•æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¼šè¯çŠ¶æ€çš„æœºåˆ¶ï¼Œä½¿æœåŠ¡ç«¯æœ‰çŠ¶æ€åŒ–ï¼Œå¯ä»¥è®°å½•ä¼šè¯ä¿¡æ¯</strong>ï¼ˆå¯èƒ½ä¿å­˜åœ¨ç¼“å­˜ã€æ–‡ä»¶æˆ–æ•°æ®åº“ï¼‰ã€‚è€Œ Token æ˜¯<strong>ä»¤ç‰Œ</strong>ï¼Œ<strong>è®¿é—®èµ„æºæ¥å£ï¼ˆAPIï¼‰æ—¶æ‰€éœ€è¦çš„èµ„æºå‡­è¯</strong>ã€‚Token <strong>ä½¿æœåŠ¡ç«¯æ— çŠ¶æ€åŒ–ï¼Œä¸ä¼šå­˜å‚¨ä¼šè¯ä¿¡æ¯ã€‚</strong></li><li>**å…¶å® token ä¸ session çš„é—®é¢˜æ˜¯ä¸€ç§æ—¶é—´ä¸ç©ºé—´çš„åšå¼ˆé—®é¢˜ï¼Œsession æ˜¯ç©ºé—´æ¢æ—¶é—´ï¼Œè€Œ token æ˜¯æ—¶é—´æ¢ç©ºé—´ã€‚ä¸¤è€…çš„é€‰æ‹©è¦çœ‹å…·ä½“æƒ…å†µè€Œå®šã€‚**è™½ç„¶ç¡®å®éƒ½æ˜¯â€œå®¢æˆ·ç«¯è®°å½•ï¼Œæ¯æ¬¡è®¿é—®æºå¸¦â€ï¼Œä½† token å¾ˆå®¹æ˜“è®¾è®¡ä¸ºè‡ªåŒ…å«çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåç«¯ä¸éœ€è¦è®°å½•ä»€ä¹ˆä¸œè¥¿ï¼Œæ¯æ¬¡ä¸€ä¸ªæ— çŠ¶æ€è¯·æ±‚ï¼Œæ¯æ¬¡è§£å¯†éªŒè¯ï¼Œæ¯æ¬¡å½“åœºå¾—å‡ºåˆæ³• /éæ³•çš„ç»“è®ºã€‚è¿™ä¸€åˆ‡åˆ¤æ–­ä¾æ®ï¼Œé™¤äº†å›ºåŒ–åœ¨ CS ä¸¤ç«¯çš„ä¸€äº›é€»è¾‘ä¹‹å¤–ï¼Œæ•´ä¸ªä¿¡æ¯æ˜¯è‡ªåŒ…å«çš„ã€‚è¿™æ‰æ˜¯çœŸæ­£çš„æ— çŠ¶æ€ã€‚ è€Œ sessionid ï¼Œä¸€èˆ¬éƒ½æ˜¯ä¸€æ®µéšæœºå­—ç¬¦ä¸²ï¼Œéœ€è¦åˆ°åç«¯å»æ£€ç´¢ id çš„æœ‰æ•ˆæ€§ã€‚ä¸‡ä¸€æœåŠ¡å™¨é‡å¯å¯¼è‡´å†…å­˜é‡Œçš„ session æ²¡äº†å‘¢ï¼Ÿä¸‡ä¸€ redis æœåŠ¡å™¨æŒ‚äº†å‘¢ï¼Ÿ</li><li>æ‰€è°“ Session è®¤è¯åªæ˜¯ç®€å•çš„æŠŠ User ä¿¡æ¯å­˜å‚¨åˆ° Session é‡Œï¼Œå› ä¸º SessionID çš„ä¸å¯é¢„æµ‹æ€§ï¼Œæš‚ä¸”è®¤ä¸ºæ˜¯å®‰å…¨çš„ã€‚è€Œ Token ï¼Œå¦‚æœæŒ‡çš„æ˜¯ OAuth Token æˆ–ç±»ä¼¼çš„æœºåˆ¶çš„è¯ï¼Œæä¾›çš„æ˜¯ è®¤è¯ å’Œ æˆæƒ ï¼Œè®¤è¯æ˜¯é’ˆå¯¹ç”¨æˆ·ï¼Œæˆæƒæ˜¯é’ˆå¯¹ App ã€‚<strong>å…¶ç›®çš„æ˜¯è®©æŸ App æœ‰æƒåˆ©è®¿é—®æŸç”¨æˆ·çš„ä¿¡æ¯</strong>ã€‚è¿™é‡Œçš„ Token æ˜¯å”¯ä¸€çš„ã€‚ä¸å¯ä»¥è½¬ç§»åˆ°å…¶å®ƒ App ä¸Šï¼Œä¹Ÿä¸å¯ä»¥è½¬åˆ°å…¶å®ƒç”¨æˆ·ä¸Šã€‚Session åªæä¾›ä¸€ç§ç®€å•çš„è®¤è¯ï¼Œå³åªè¦æœ‰æ­¤ SessionID ï¼Œå³è®¤ä¸ºæœ‰æ­¤ User çš„å…¨éƒ¨æƒåˆ©ã€‚æ˜¯éœ€è¦ä¸¥æ ¼ä¿å¯†çš„ï¼Œè¿™ä¸ªæ•°æ®åº”è¯¥åªä¿å­˜åœ¨ç«™æ–¹ï¼Œä¸åº”è¯¥å…±äº«ç»™å…¶å®ƒç½‘ç«™æˆ–è€…ç¬¬ä¸‰æ–¹ Appã€‚æ‰€ä»¥ç®€å•æ¥è¯´ï¼š<strong>å¦‚æœä½ çš„ç”¨æˆ·æ•°æ®å¯èƒ½éœ€è¦å’Œç¬¬ä¸‰æ–¹å…±äº«ï¼Œæˆ–è€…å…è®¸ç¬¬ä¸‰æ–¹è°ƒç”¨ API æ¥å£ï¼Œç”¨ Token ã€‚å¦‚æœæ°¸è¿œåªæ˜¯è‡ªå·±çš„ç½‘ç«™ï¼Œè‡ªå·±çš„ Appï¼Œç”¨ä»€ä¹ˆå°±æ— æ‰€è°“äº†ã€‚</strong></li></ul><h3 id="JWT-æ¦‚è¿°"><strong>JWT æ¦‚è¿°</strong></h3><ul><li>JSON Web Tokenï¼ˆç®€ç§° JWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„<strong>è·¨åŸŸè®¤è¯</strong>è§£å†³æ–¹æ¡ˆã€‚æ˜¯ä¸€ç§<strong>è®¤è¯æˆæƒæœºåˆ¶</strong>ã€‚</li><li>JWT æ˜¯ä¸ºäº†åœ¨ç½‘ç»œåº”ç”¨ç¯å¢ƒé—´<strong>ä¼ é€’å£°æ˜</strong>è€Œæ‰§è¡Œçš„ä¸€ç§åŸºäº JSON çš„å¼€æ”¾æ ‡å‡†ï¼ˆRFC 7519ï¼‰ã€‚JWT çš„å£°æ˜ä¸€èˆ¬è¢«ç”¨æ¥åœ¨èº«ä»½æä¾›è€…å’ŒæœåŠ¡æä¾›è€…é—´ä¼ é€’è¢«è®¤è¯çš„ç”¨æˆ·èº«ä»½ä¿¡æ¯ï¼Œä»¥ä¾¿äºä»èµ„æºæœåŠ¡å™¨è·å–èµ„æºã€‚æ¯”å¦‚ç”¨åœ¨ç”¨æˆ·ç™»å½•ä¸Šã€‚</li><li>å¯ä»¥ä½¿ç”¨ HMAC ç®—æ³•æˆ–è€…æ˜¯ RSA çš„å…¬/ç§ç§˜é’¥å¯¹ JWT è¿›è¡Œç­¾åã€‚å› ä¸ºæ•°å­—ç­¾åçš„å­˜åœ¨ï¼Œè¿™äº›ä¼ é€’çš„ä¿¡æ¯æ˜¯å¯ä¿¡çš„ã€‚</li><li><strong>é˜®ä¸€å³°è€å¸ˆçš„ JSON Web Token å…¥é—¨æ•™ç¨‹ è®²çš„éå¸¸é€šä¿—æ˜“æ‡‚ï¼Œè¿™é‡Œå°±ä¸å†ç­é—¨å¼„æ–§äº†</strong></li></ul><h4 id="ç”Ÿæˆ-JWT"><strong>ç”Ÿæˆ JWT</strong></h4><ul><li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fjwt.io%2F">https://jwt.io/</a></li><li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.jsonwebtoken.io%2F">https://www.jsonwebtoken.io/</a></li></ul><h4 id="JWT-çš„åŸç†"><strong>JWT çš„åŸç†</strong></h4><p><strong>JWT è®¤è¯æµç¨‹ï¼š</strong></p><ul><li><p>ç”¨æˆ·è¾“å…¥ç”¨æˆ·å/å¯†ç ç™»å½•ï¼Œ<strong>æœåŠ¡ç«¯è®¤è¯æˆåŠŸåï¼Œä¼šè¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ª JWT</strong></p></li><li><p>å®¢æˆ·ç«¯å°† token ä¿å­˜åˆ°æœ¬åœ°ï¼ˆé€šå¸¸ä½¿ç”¨ localstorageï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ cookieï¼‰</p></li><li><p>å½“ç”¨æˆ·å¸Œæœ›è®¿é—®ä¸€ä¸ªå—ä¿æŠ¤çš„è·¯ç”±æˆ–è€…èµ„æºçš„æ—¶å€™ï¼Œéœ€è¦è¯·æ±‚å¤´çš„ Authorization å­—æ®µä¸­ä½¿ç”¨ Bearer æ¨¡å¼æ·»åŠ  JWTï¼Œå…¶å†…å®¹çœ‹èµ·æ¥æ˜¯ä¸‹é¢è¿™æ ·</p><p>Authorization: Bearer <token></p></li><li><p>æœåŠ¡ç«¯çš„ä¿æŠ¤è·¯ç”±å°†ä¼šæ£€æŸ¥è¯·æ±‚å¤´ Authorization ä¸­çš„ JWT ä¿¡æ¯ï¼Œå¦‚æœåˆæ³•ï¼Œåˆ™å…è®¸ç”¨æˆ·çš„è¡Œä¸º</p></li><li><p>å› ä¸º JWT æ˜¯è‡ªåŒ…å«çš„ï¼ˆå†…éƒ¨åŒ…å«äº†ä¸€äº›ä¼šè¯ä¿¡æ¯ï¼‰ï¼Œå› æ­¤å‡å°‘äº†éœ€è¦æŸ¥è¯¢æ•°æ®åº“çš„éœ€è¦</p></li><li><p>å› ä¸º JWT å¹¶ä¸ä½¿ç”¨ Cookie çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•åŸŸåæä¾›ä½ çš„ API æœåŠ¡è€Œä¸éœ€è¦æ‹…å¿ƒè·¨åŸŸèµ„æºå…±äº«é—®é¢˜ï¼ˆCORSï¼‰</p></li><li><p>å› ä¸ºç”¨æˆ·çš„çŠ¶æ€ä¸å†å­˜å‚¨åœ¨æœåŠ¡ç«¯çš„å†…å­˜ä¸­ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ç§<strong>æ— çŠ¶æ€çš„è®¤è¯æœºåˆ¶</strong></p></li></ul><h4 id="JWT-çš„ä½¿ç”¨æ–¹å¼"><strong>JWT çš„ä½¿ç”¨æ–¹å¼</strong></h4><h4 id="æ–¹å¼ä¸€"><strong>æ–¹å¼ä¸€</strong></h4><ul><li><p><strong>å½“ç”¨æˆ·å¸Œæœ›è®¿é—®ä¸€ä¸ªå—ä¿æŠ¤çš„è·¯ç”±æˆ–è€…èµ„æºçš„æ—¶å€™</strong>ï¼Œå¯ä»¥æŠŠå®ƒæ”¾åœ¨ Cookie é‡Œé¢è‡ªåŠ¨å‘é€ï¼Œä½†æ˜¯è¿™æ ·ä¸èƒ½è·¨åŸŸï¼Œæ‰€ä»¥<strong>æ›´å¥½çš„åšæ³•æ˜¯æ”¾åœ¨ HTTP è¯·æ±‚å¤´ä¿¡æ¯çš„ Authorization å­—æ®µé‡Œï¼Œä½¿ç”¨ Bearer æ¨¡å¼æ·»åŠ  JWTã€‚</strong></p><p>GET /calendar/v1/events</p></li><li><p>ç”¨æˆ·çš„çŠ¶æ€ä¸ä¼šå­˜å‚¨åœ¨æœåŠ¡ç«¯çš„å†…å­˜ä¸­ï¼Œè¿™æ˜¯ä¸€ç§ <strong>æ— çŠ¶æ€çš„è®¤è¯æœºåˆ¶</strong></p></li><li><p>æœåŠ¡ç«¯çš„ä¿æŠ¤è·¯ç”±å°†ä¼šæ£€æŸ¥è¯·æ±‚å¤´ Authorization ä¸­çš„ JWT ä¿¡æ¯ï¼Œå¦‚æœåˆæ³•ï¼Œåˆ™å…è®¸ç”¨æˆ·çš„è¡Œä¸ºã€‚</p></li><li><p>ç”±äº JWT æ˜¯è‡ªåŒ…å«çš„ï¼Œå› æ­¤å‡å°‘äº†éœ€è¦æŸ¥è¯¢æ•°æ®åº“çš„éœ€è¦</p></li><li><p>JWT çš„è¿™äº›ç‰¹æ€§ä½¿å¾—æˆ‘ä»¬å¯ä»¥å®Œå…¨ä¾èµ–å…¶æ— çŠ¶æ€çš„ç‰¹æ€§æä¾›æ•°æ® API æœåŠ¡ï¼Œç”šè‡³æ˜¯åˆ›å»ºä¸€ä¸ªä¸‹è½½æµæœåŠ¡ã€‚</p></li><li><p>å› ä¸º JWT å¹¶ä¸ä½¿ç”¨ Cookie ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•åŸŸåæä¾›ä½ çš„ API æœåŠ¡è€Œ<strong>ä¸éœ€è¦æ‹…å¿ƒè·¨åŸŸèµ„æºå…±äº«é—®é¢˜</strong>ï¼ˆCORSï¼‰</p></li></ul><h4 id="æ–¹å¼äºŒ"><strong>æ–¹å¼äºŒ</strong></h4><ul><li>è·¨åŸŸçš„æ—¶å€™ï¼Œå¯ä»¥æŠŠ JWT æ”¾åœ¨ POST è¯·æ±‚çš„æ•°æ®ä½“é‡Œã€‚</li></ul><h4 id="æ–¹å¼ä¸‰"><strong>æ–¹å¼ä¸‰</strong></h4><ul><li><p>é€šè¿‡ URL ä¼ è¾“</p><p><a href="http://www.example.com/user?token=xxx">http://www.example.com/user?token=xxx</a></p></li></ul><h4 id="é¡¹ç›®ä¸­ä½¿ç”¨-JWT"><strong>é¡¹ç›®ä¸­ä½¿ç”¨ JWT</strong></h4><p>é¡¹ç›®åœ°å€ï¼š<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fyjdjiayou%2Fjwt-demo">https://github.com/yjdjiayou/jwt-demo</a></p><h4 id="Token-å’Œ-JWT-çš„åŒºåˆ«"><strong>Token å’Œ JWT çš„åŒºåˆ«</strong></h4><p><strong>ç›¸åŒï¼š</strong></p><ul><li>éƒ½æ˜¯<strong>è®¿é—®èµ„æºçš„ä»¤ç‰Œ</strong></li><li>éƒ½å¯ä»¥<strong>è®°å½•ç”¨æˆ·çš„ä¿¡æ¯</strong></li><li>éƒ½æ˜¯<strong>ä½¿æœåŠ¡ç«¯æ— çŠ¶æ€åŒ–</strong></li><li>éƒ½æ˜¯<strong>åªæœ‰éªŒè¯æˆåŠŸ</strong>åï¼Œ<strong>å®¢æˆ·ç«¯æ‰èƒ½è®¿é—®æœåŠ¡ç«¯ä¸Šå—ä¿æŠ¤çš„èµ„æº</strong></li></ul><p><strong>åŒºåˆ«ï¼š</strong></p><ul><li>Tokenï¼šæœåŠ¡ç«¯éªŒè¯å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„ Token æ—¶ï¼Œ<strong>è¿˜éœ€è¦æŸ¥è¯¢æ•°æ®åº“è·å–ç”¨æˆ·ä¿¡æ¯</strong>ï¼Œç„¶åéªŒè¯ Token æ˜¯å¦æœ‰æ•ˆã€‚</li><li>JWTï¼šå°† Token å’Œ Payload åŠ å¯†åå­˜å‚¨äºå®¢æˆ·ç«¯ï¼ŒæœåŠ¡ç«¯åªéœ€è¦ä½¿ç”¨å¯†é’¥è§£å¯†è¿›è¡Œæ ¡éªŒï¼ˆæ ¡éªŒä¹Ÿæ˜¯ JWT è‡ªå·±å®ç°çš„ï¼‰å³å¯ï¼Œ<strong>ä¸éœ€è¦æŸ¥è¯¢æˆ–è€…å‡å°‘æŸ¥è¯¢æ•°æ®åº“ï¼Œå› ä¸º JWT è‡ªåŒ…å«äº†ç”¨æˆ·ä¿¡æ¯å’ŒåŠ å¯†çš„æ•°æ®ã€‚</strong></li></ul><h2 id="å¸¸è§çš„å‰åç«¯é‰´æƒæ–¹å¼"><strong>å¸¸è§çš„å‰åç«¯é‰´æƒæ–¹å¼</strong></h2><ol><li>Session-Cookie</li><li>Token éªŒè¯ï¼ˆåŒ…æ‹¬ JWTï¼ŒSSOï¼‰</li><li>OAuth2.0ï¼ˆå¼€æ”¾æˆæƒï¼‰</li></ol><h2 id="å¸¸è§çš„åŠ å¯†ç®—æ³•"><strong>å¸¸è§çš„åŠ å¯†ç®—æ³•</strong></h2><h3 id="ä¸å¯é€†åŠ å¯†ï¼šã€Hash-åŠ å¯†ç®—æ³•-æ•£åˆ—ç®—æ³•-æ‘˜è¦ç®—æ³•ã€‘">ä¸å¯é€†åŠ å¯†ï¼šã€Hash åŠ å¯†ç®—æ³•/æ•£åˆ—ç®—æ³•/æ‘˜è¦ç®—æ³•ã€‘</h3><ul><li>ä¸€æ—¦åŠ å¯†å°±ä¸èƒ½åå‘è§£å¯†å¾—åˆ°å¯†ç åŸæ–‡ï¼Œä¸€èˆ¬ç”¨æ¥åŠ å¯†ç”¨æˆ·å¯†ç ,app çš„æœåŠ¡å™¨ç«¯æ•°æ®åº“é‡Œä¸€èˆ¬å­˜å‚¨çš„ä¹Ÿéƒ½æ˜¯åŠ å¯†åçš„ç”¨æˆ·å¯†ç ã€‚</li><li>åœ¨æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆæŠŠå¯†ç ç±»æ•°æ®ç»è¿‡ MD5 åŠ å¯†ç®—æ³•åŠ å¯†ï¼Œç„¶åå†åœ¨å¤–é¢ä½¿ç”¨å¯é€†çš„åŠ å¯†æ–¹å¼åŠ å¯†ä¸€æ¬¡ï¼Œè¿™æ ·åœ¨æ•°æ®ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œå³ä¾¿æ•°æ®è¢«æˆªè·äº†ï¼Œä½†æ˜¯æƒ³è¦å®Œå…¨ç ´è§£ï¼Œè¿˜æ˜¯å¾ˆéš¾çš„ã€‚</li><li>Hash ç®—æ³•ç‰¹åˆ«çš„åœ°æ–¹åœ¨äºå®ƒæ˜¯ä¸€ç§å•å‘ç®—æ³•ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ Hash ç®—æ³•å¯¹ç›®æ ‡ä¿¡æ¯ç”Ÿæˆä¸€æ®µç‰¹å®šé•¿åº¦çš„å”¯ä¸€çš„ Hash å€¼ï¼Œå´ä¸èƒ½é€šè¿‡è¿™ä¸ª Hash å€¼é‡æ–°è·å¾—ç›®æ ‡ä¿¡æ¯ã€‚å› æ­¤ Hash ç®—æ³•å¸¸ç”¨åœ¨ä¸å¯è¿˜åŸçš„å¯†ç å­˜å‚¨ã€ä¿¡æ¯å®Œæ•´æ€§æ ¡éªŒç­‰ã€‚</li><li>ç”¨é€”ï¼šä¸€èˆ¬ç”¨äºæ•ˆéªŒä¸‹è½½æ–‡ä»¶æ­£ç¡®æ€§ï¼Œä¸€èˆ¬åœ¨ç½‘ç«™ä¸Šä¸‹è½½æ–‡ä»¶éƒ½èƒ½è§åˆ°ï¼›å­˜å‚¨ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼Œå¦‚å¯†ç ã€ å¡å·ç­‰ä¸å¯è§£å¯†çš„ä¿¡æ¯ã€‚</li><li>å¸¸è§çš„ä¸å¯é€†åŠ å¯†ç®—æ³•æœ‰ï¼šMD5ã€SHAã€HMAC</li></ul><blockquote><p>MD5ï¼šMessage Digest Algorithm MD5ï¼ˆä¸­æ–‡åä¸ºæ¶ˆæ¯æ‘˜è¦ç®—æ³•ç¬¬äº”ç‰ˆï¼‰ä¸ºè®¡ç®—æœºå®‰å…¨é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„ä¸€ç§æ•£åˆ—å‡½æ•°ï¼Œç”¨ä»¥æä¾›æ¶ˆæ¯çš„å®Œæ•´æ€§ä¿æŠ¤ã€‚è¯¥ç®—æ³•çš„æ–‡ä»¶å·ä¸º RFC 1321ï¼ˆR.Rivest,MIT Laboratory for Computer Science and RSA Data Security Inc. April 1992ï¼‰ã€‚ MD5 å³ Message-Digest Algorithm 5ï¼ˆä¿¡æ¯-æ‘˜è¦ç®—æ³• 5ï¼‰ï¼Œç”¨äºç¡®ä¿ä¿¡æ¯ä¼ è¾“å®Œæ•´ä¸€è‡´ã€‚æ˜¯è®¡ç®—æœºå¹¿æ³›ä½¿ç”¨çš„æ‚å‡‘ç®—æ³•ä¹‹ä¸€ï¼ˆåˆè¯‘æ‘˜è¦ç®—æ³•ã€å“ˆå¸Œç®—æ³•ï¼‰ï¼Œä¸»æµç¼–ç¨‹è¯­è¨€æ™®éå·²æœ‰ MD5 å®ç°ã€‚å°†æ•°æ®ï¼ˆå¦‚æ±‰å­—ï¼‰è¿ç®—ä¸ºå¦ä¸€å›ºå®šé•¿åº¦å€¼ï¼Œæ˜¯æ‚å‡‘ç®—æ³•çš„åŸºç¡€åŸç†ï¼ŒMD5 çš„å‰èº«æœ‰ MD2ã€MD3 å’Œ MD4ã€‚</p><p>MD5 ç®—æ³•å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š 1ã€å‹ç¼©æ€§ï¼šä»»æ„é•¿åº¦çš„æ•°æ®ï¼Œç®—å‡ºçš„ MD5 å€¼é•¿åº¦éƒ½æ˜¯å›ºå®šçš„ã€‚ 2ã€å®¹æ˜“è®¡ç®—ï¼šä»åŸæ•°æ®è®¡ç®—å‡º MD5 å€¼å¾ˆå®¹æ˜“ã€‚ 3ã€æŠ—ä¿®æ”¹æ€§ï¼šå¯¹åŸæ•°æ®è¿›è¡Œä»»ä½•æ”¹åŠ¨ï¼Œå“ªæ€•åªä¿®æ”¹ 1 ä¸ªå­—èŠ‚ï¼Œæ‰€å¾—åˆ°çš„ MD5 å€¼éƒ½æœ‰å¾ˆå¤§åŒºåˆ«ã€‚ 4ã€å¼ºæŠ—ç¢°æ’ï¼šå·²çŸ¥åŸæ•°æ®å’Œå…¶ MD5 å€¼ï¼Œæƒ³æ‰¾åˆ°ä¸€ä¸ªå…·æœ‰ç›¸åŒ MD5 å€¼çš„æ•°æ®ï¼ˆå³ä¼ªé€ æ•°æ®ï¼‰æ˜¯éå¸¸å›°éš¾çš„ã€‚ MD5 çš„ä½œç”¨æ˜¯è®©å¤§å®¹é‡ä¿¡æ¯åœ¨ç”¨æ•°å­—ç­¾åè½¯ä»¶ç­¾ç½²ç§äººå¯†é’¥å‰è¢«&quot;å‹ç¼©&quot;æˆä¸€ç§ä¿å¯†çš„æ ¼å¼ï¼ˆå°±æ˜¯æŠŠä¸€ä¸ªä»»æ„é•¿åº¦çš„å­—èŠ‚ä¸²å˜æ¢æˆä¸€å®šé•¿çš„åå…­è¿›åˆ¶æ•°å­—ä¸²ï¼‰ã€‚é™¤äº† MD5 ä»¥å¤–ï¼Œå…¶ä¸­æ¯”è¾ƒæœ‰åçš„è¿˜æœ‰ sha-1ã€RIPEMD ä»¥åŠ Haval ç­‰ã€‚</p></blockquote><blockquote><p>SHA1 ï¼šå®‰å…¨å“ˆå¸Œç®—æ³•ï¼ˆSecure Hash Algorithmï¼‰ä¸»è¦é€‚ç”¨äºæ•°å­—ç­¾åæ ‡å‡† ï¼ˆDigital Signature Standard DSSï¼‰é‡Œé¢å®šä¹‰çš„æ•°å­—ç­¾åç®—æ³•ï¼ˆDigital Signature Algorithm DSAï¼‰ã€‚å¯¹äºé•¿åº¦å°äº 2^64 ä½çš„æ¶ˆæ¯ï¼ŒSHA1 ä¼šäº§ç”Ÿä¸€ä¸ª 160 ä½çš„æ¶ˆæ¯æ‘˜è¦ã€‚å½“æ¥æ”¶åˆ°æ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿™ä¸ªæ¶ˆæ¯æ‘˜è¦å¯ä»¥ç”¨æ¥éªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®å¾ˆå¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆè¿™æ—¶å€™å°±ä¼šäº§ç”Ÿä¸åŒçš„æ¶ˆæ¯æ‘˜è¦ã€‚ SHA1 æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š 1.ä¸å¯ä»¥ä»æ¶ˆæ¯æ‘˜è¦ä¸­å¤åŸä¿¡æ¯ï¼› 2.ä¸¤ä¸ªä¸åŒçš„æ¶ˆæ¯ä¸ä¼šäº§ç”ŸåŒæ ·çš„æ¶ˆæ¯æ‘˜è¦,(ä½†ä¼šæœ‰ 1x10 ^ 48 åˆ†ä¹‹ä¸€çš„æœºç‡å‡ºç°ç›¸åŒçš„æ¶ˆæ¯æ‘˜è¦,ä¸€èˆ¬ä½¿ç”¨æ—¶å¿½ç•¥)ã€‚</p></blockquote><h3 id="å¯é€†åŠ å¯†ï¼šå¯é€†åŠ å¯†æœ‰å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚">å¯é€†åŠ å¯†ï¼šå¯é€†åŠ å¯†æœ‰å¯¹ç§°åŠ å¯†å’Œéå¯¹ç§°åŠ å¯†ã€‚</h3><h4 id="å¯¹ç§°åŠ å¯†ï¼šã€æ–‡ä»¶åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå³åŠ å¯†å¯†é’¥ä¹Ÿå¯ä»¥ç”¨ä½œè§£å¯†å¯†é’¥ã€‘">å¯¹ç§°åŠ å¯†ï¼šã€æ–‡ä»¶åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ï¼Œå³åŠ å¯†å¯†é’¥ä¹Ÿå¯ä»¥ç”¨ä½œè§£å¯†å¯†é’¥ã€‘</h4><ul><li>åœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œæ•°æ®å‘ä¿¡æ–¹å°†æ˜æ–‡å’ŒåŠ å¯†å¯†é’¥ä¸€èµ·ç»è¿‡ç‰¹æ®Šçš„åŠ å¯†ç®—æ³•å¤„ç†åï¼Œä½¿å…¶å˜æˆå¤æ‚çš„åŠ å¯†å¯†æ–‡å‘é€å‡ºå»ï¼Œæ”¶ä¿¡æ–¹æ”¶åˆ°å¯†æ–‡åï¼Œè‹¥æƒ³è§£è¯»å‡ºåŸæ–‡ï¼Œåˆ™éœ€è¦ä½¿ç”¨åŠ å¯†æ—¶ç”¨çš„å¯†é’¥ä»¥åŠç›¸åŒåŠ å¯†ç®—æ³•çš„é€†ç®—æ³•å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œæ‰èƒ½ä½¿å…¶å›å¤æˆå¯è¯»æ˜æ–‡ã€‚åœ¨å¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œä½¿ç”¨çš„å¯†é’¥åªæœ‰ä¸€ä¸ªï¼Œæ”¶å‘åŒæ–¹éƒ½ä½¿ç”¨è¿™ä¸ªå¯†é’¥ï¼Œè¿™å°±éœ€è¦è§£å¯†æ–¹äº‹å…ˆçŸ¥é“åŠ å¯†å¯†é’¥ã€‚</li><li>å¯¹ç§°åŠ å¯†ç®—æ³•çš„ä¼˜ç‚¹æ˜¯ç®—æ³•å…¬å¼€ã€è®¡ç®—é‡å°ã€åŠ å¯†é€Ÿåº¦å¿«ã€åŠ å¯†æ•ˆç‡é«˜ã€‚</li><li>ç”¨é€”ï¼š<strong>ä¸€èˆ¬ç”¨äºä¿å­˜ç”¨æˆ·æ‰‹æœºå·ã€èº«ä»½è¯ç­‰æ•æ„Ÿä½†èƒ½è§£å¯†çš„ä¿¡æ¯ã€‚</strong></li><li>å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ AESï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰ã€<strong>DESï¼ˆæ•°æ®åŠ å¯†ç®—æ³•ï¼‰</strong>ã€3DESã€Blowfishã€IDEAã€RC4ã€RC5ã€RC6</li></ul><h4 id="éå¯¹ç§°åŠ å¯†ï¼šã€ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼Œå…¬æœ‰å¯†é’¥åŠ å¯†ï¼Œç§æœ‰å¯†é’¥è§£å¯†ã€‘">éå¯¹ç§°åŠ å¯†ï¼šã€ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼Œå…¬æœ‰å¯†é’¥åŠ å¯†ï¼Œç§æœ‰å¯†é’¥è§£å¯†ã€‘</h4><ul><li>éå¯¹ç§°åŠ å¯†ç®—æ³•æ˜¯ä¸€ç§å¯†é’¥çš„ä¿å¯†æ–¹æ³•ã€‚éå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼šå…¬å¼€å¯†é’¥ï¼ˆpublickeyï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekeyï¼‰ã€‚å…¬å¼€å¯†é’¥ä¸ç§æœ‰å¯†é’¥æ˜¯ä¸€å¯¹ï¼Œå¦‚æœç”¨å…¬å¼€å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œåªæœ‰ç”¨å¯¹åº”çš„ç§æœ‰å¯†é’¥æ‰èƒ½è§£å¯†ï¼›å¦‚æœç”¨ç§æœ‰å¯†é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé‚£ä¹ˆåªæœ‰ç”¨å¯¹åº”çš„å…¬å¼€å¯†é’¥æ‰èƒ½è§£å¯†ã€‚å› ä¸ºåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚</li><li>éå¯¹ç§°åŠ å¯†ç®—æ³•å®ç°æœºå¯†ä¿¡æ¯äº¤æ¢çš„åŸºæœ¬è¿‡ç¨‹æ˜¯ï¼šç”²æ–¹ç”Ÿæˆä¸€å¯¹å¯†é’¥å¹¶å°†å…¶ä¸­çš„ä¸€æŠŠä½œä¸ºå…¬ç”¨å¯†é’¥å‘å…¶å®ƒæ–¹å…¬å¼€ï¼›å¾—åˆ°è¯¥å…¬ç”¨å¯†é’¥çš„ä¹™æ–¹ä½¿ç”¨è¯¥å¯†é’¥å¯¹æœºå¯†ä¿¡æ¯è¿›è¡ŒåŠ å¯†åå†å‘é€ç»™ç”²æ–¹ï¼›ç”²æ–¹å†ç”¨è‡ªå·±ä¿å­˜çš„å¦ä¸€æŠŠä¸“ç”¨å¯†é’¥å¯¹åŠ å¯†åçš„ä¿¡æ¯è¿›è¡Œè§£å¯†ã€‚</li><li>æœåŠ¡å™¨å­˜ç§é’¥ï¼Œå®¢æˆ·ç«¯æ‹¿å…¬é’¥ï¼Œå®¢æˆ·ç«¯åŠ è§£å¯†ç®—æ³•å¯ä»¥åšæˆ so åº“ã€‚</li><li>éå¯¹ç§°åŠ å¯†ä¸å¯¹ç§°åŠ å¯†ç›¸æ¯”ï¼Œå…¶å®‰å…¨æ€§æ›´å¥½ï¼›éå¯¹ç§°åŠ å¯†çš„ç¼ºç‚¹æ˜¯åŠ å¯†å’Œè§£å¯†èŠ±è´¹æ—¶é—´é•¿ã€é€Ÿåº¦æ…¢ï¼Œåªé€‚åˆå¯¹å°‘é‡æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚</li><li>ç”¨é€”ï¼š<strong>ä¸€èˆ¬ç”¨äºç­¾åå’Œè®¤è¯ã€‚</strong></li><li>å¸¸è§çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰ï¼šRSAï¼ˆå…¬é’¥åŠ å¯†ç®—æ³•ï¼‰ã€DSAï¼ˆæ•°å­—ç­¾åç”¨ï¼‰ã€ECCï¼ˆç§»åŠ¨è®¾å¤‡ç”¨ï¼‰ã€Diffie-Hellmanã€El Gamal</li></ul><h2 id="å¸¸è§é—®é¢˜"><strong>å¸¸è§é—®é¢˜</strong></h2><h3 id="ä½¿ç”¨-cookie-æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜"><strong>ä½¿ç”¨ cookie æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</strong></h3><ul><li>å› ä¸ºå­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œå®¹æ˜“è¢«å®¢æˆ·ç«¯ç¯¡æ”¹ï¼Œ<strong>ä½¿ç”¨å‰éœ€è¦éªŒè¯åˆæ³•æ€§</strong>ï¼Œæ‰€ä»¥ï¼Œ<strong>ä¸è¦å­˜å‚¨æ•æ„Ÿæ•°æ®</strong>ï¼Œæ¯”å¦‚ç”¨æˆ·å¯†ç ï¼Œè´¦æˆ·ä½™é¢ï¼›ä½¿ç”¨ <strong>httpOnly</strong> åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜å®‰å…¨æ€§</li><li><strong>å°½é‡å‡å°‘ cookie çš„ä½“ç§¯</strong>ï¼Œèƒ½å­˜å‚¨çš„æ•°æ®é‡ä¸èƒ½è¶…è¿‡ 4kbï¼›ä¸€ä¸ªæµè§ˆå™¨é’ˆå¯¹ä¸€ä¸ªç½‘ç«™æœ€å¤šå­˜ 20 ä¸ª Cookieï¼Œæµè§ˆå™¨ä¸€èˆ¬åªå…è®¸å­˜æ”¾ 300 ä¸ª Cookie</li><li>è®¾ç½®æ­£ç¡®çš„ domain å’Œ pathï¼Œå‡å°‘æ•°æ®ä¼ è¾“</li><li><strong>cookie æ— æ³•è·¨åŸŸ</strong>ï¼ˆæ¯ä¸ª cookie éƒ½ä¼šç»‘å®šå•ä¸€çš„åŸŸåï¼Œæ— æ³•åœ¨åˆ«çš„åŸŸåä¸‹è·å–ä½¿ç”¨ï¼‰</li><li><strong>ç§»åŠ¨ç«¯å¯¹ cookie çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œè€Œ session éœ€è¦åŸºäº cookie å®ç°ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯å¸¸ç”¨çš„æ˜¯ token</strong></li></ul><h3 id="ä½¿ç”¨-session-æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜"><strong>ä½¿ç”¨ session æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</strong></h3><ul><li>å°† session å­˜å‚¨åœ¨æœåŠ¡å™¨é‡Œé¢ï¼Œ<strong>å½“ç”¨æˆ·åŒæ—¶åœ¨çº¿é‡æ¯”è¾ƒå¤šæ—¶</strong>ï¼Œè¿™äº› session ä¼šå æ®è¾ƒå¤šçš„å†…å­˜ï¼Œéœ€è¦<strong>åœ¨æœåŠ¡ç«¯å®šæœŸçš„å»æ¸…ç†è¿‡æœŸçš„ session</strong></li><li>å½“ç½‘ç«™é‡‡ç”¨<strong>é›†ç¾¤éƒ¨ç½²</strong>çš„æ—¶å€™ï¼Œä¼šé‡åˆ°<strong>å¤šå° web æœåŠ¡å™¨ä¹‹é—´å¦‚ä½•åš session å…±äº«çš„é—®é¢˜</strong>ã€‚å› ä¸º session æ˜¯ç”±å•ä¸ªæœåŠ¡å™¨åˆ›å»ºçš„ï¼Œä½†æ˜¯å¤„ç†ç”¨æˆ·è¯·æ±‚çš„æœåŠ¡å™¨ä¸ä¸€å®šæ˜¯é‚£ä¸ªåˆ›å»º session çš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆè¯¥æœåŠ¡å™¨å°±æ— æ³•æ‹¿åˆ°ä¹‹å‰å·²ç»æ”¾å…¥åˆ° session ä¸­çš„ç™»å½•å‡­è¯ä¹‹ç±»çš„ä¿¡æ¯äº†ã€‚<strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå†™å®¢æˆ·ç«¯ cookie çš„æ–¹å¼ã€æœåŠ¡å™¨ä¹‹é—´ session æ•°æ®åŒæ­¥ã€ç”¨ mysql æ•°æ®åº“å…±äº« session æ•°æ®ã€‚</li><li>å½“å¤šä¸ªåº”ç”¨è¦å…±äº« session æ—¶ï¼Œé™¤äº†ä»¥ä¸Šé—®é¢˜ï¼Œè¿˜ä¼šé‡åˆ°è·¨åŸŸé—®é¢˜ï¼Œå› ä¸ºä¸åŒçš„åº”ç”¨å¯èƒ½éƒ¨ç½²çš„ä¸»æœºä¸ä¸€æ ·ï¼Œéœ€è¦åœ¨<strong>å„ä¸ªåº”ç”¨åšå¥½ cookie è·¨åŸŸçš„å¤„ç†</strong>ã€‚</li><li><strong>sessionId æ˜¯å­˜å‚¨åœ¨ cookie ä¸­çš„ï¼Œå‡å¦‚æµè§ˆå™¨ç¦æ­¢ cookie æˆ–ä¸æ”¯æŒ cookie æ€ä¹ˆåŠï¼Ÿ</strong> ä¸€èˆ¬ä¼šæŠŠ sessionId è·Ÿåœ¨ url å‚æ•°åé¢å³é‡å†™ urlï¼Œæ‰€ä»¥ session ä¸ä¸€å®šéå¾—éœ€è¦é  cookie å®ç°</li><li><strong>ç§»åŠ¨ç«¯å¯¹ cookie çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œè€Œ session éœ€è¦åŸºäº cookie å®ç°ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯å¸¸ç”¨çš„æ˜¯ token</strong></li></ul><h3 id="ä½¿ç”¨-token-æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜"><strong>ä½¿ç”¨ token æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</strong></h3><ul><li>å¦‚æœä½ è®¤ä¸ºç”¨æ•°æ®åº“æ¥å­˜å‚¨ token ä¼šå¯¼è‡´æŸ¥è¯¢æ—¶é—´å¤ªé•¿ï¼Œå¯ä»¥é€‰æ‹©æ”¾åœ¨å†…å­˜å½“ä¸­ã€‚æ¯”å¦‚ redis å¾ˆé€‚åˆä½ å¯¹ token æŸ¥è¯¢çš„éœ€æ±‚ã€‚</li><li><strong>token å®Œå…¨ç”±åº”ç”¨ç®¡ç†ï¼Œæ‰€ä»¥å®ƒå¯ä»¥é¿å¼€åŒæºç­–ç•¥</strong></li><li><strong>token å¯ä»¥é¿å… CSRF æ”»å‡»(å› ä¸ºä¸éœ€è¦ cookie äº†)</strong></li><li><strong>ç§»åŠ¨ç«¯å¯¹ cookie çš„æ”¯æŒä¸æ˜¯å¾ˆå¥½ï¼Œè€Œ session éœ€è¦åŸºäº cookie å®ç°ï¼Œæ‰€ä»¥ç§»åŠ¨ç«¯å¸¸ç”¨çš„æ˜¯ token</strong></li></ul><h3 id="ä½¿ç”¨-JWT-æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜"><strong>ä½¿ç”¨ JWT æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</strong></h3><ul><li>å› ä¸º <strong>JWT å¹¶ä¸ä¾èµ– Cookie</strong> çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•åŸŸåæä¾›ä½ çš„ API æœåŠ¡è€Œä¸éœ€è¦æ‹…å¿ƒè·¨åŸŸèµ„æºå…±äº«é—®é¢˜ï¼ˆCORSï¼‰</li><li>JWT é»˜è®¤æ˜¯ä¸åŠ å¯†ï¼Œä½†ä¹Ÿæ˜¯å¯ä»¥åŠ å¯†çš„ã€‚ç”ŸæˆåŸå§‹ Token ä»¥åï¼Œå¯ä»¥ç”¨å¯†é’¥å†åŠ å¯†ä¸€æ¬¡ã€‚</li><li>JWT ä¸åŠ å¯†çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å°†ç§˜å¯†æ•°æ®å†™å…¥ JWTã€‚</li><li>JWT ä¸ä»…å¯ä»¥ç”¨äºè®¤è¯ï¼Œä¹Ÿå¯ä»¥ç”¨äºäº¤æ¢ä¿¡æ¯ã€‚æœ‰æ•ˆä½¿ç”¨ JWTï¼Œå¯ä»¥é™ä½æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®åº“çš„æ¬¡æ•°ã€‚</li><li><strong>JWT æœ€å¤§çš„ä¼˜åŠ¿æ˜¯æœåŠ¡å™¨ä¸å†éœ€è¦å­˜å‚¨ Sessionï¼Œä½¿å¾—æœåŠ¡å™¨è®¤è¯é‰´æƒä¸šåŠ¡å¯ä»¥æ–¹ä¾¿æ‰©å±•</strong>ã€‚ä½†è¿™ä¹Ÿæ˜¯ JWT æœ€å¤§çš„ç¼ºç‚¹ï¼šç”±äºæœåŠ¡å™¨ä¸éœ€è¦å­˜å‚¨ Session çŠ¶æ€ï¼Œå› æ­¤**ä½¿ç”¨è¿‡ç¨‹ä¸­æ— æ³•åºŸå¼ƒæŸä¸ª Token æˆ–è€…æ›´æ”¹ Token çš„æƒé™ã€‚**ä¹Ÿå°±æ˜¯è¯´ä¸€æ—¦ JWT ç­¾å‘äº†ï¼Œåˆ°æœŸä¹‹å‰å°±ä¼šå§‹ç»ˆæœ‰æ•ˆï¼Œé™¤éæœåŠ¡å™¨éƒ¨ç½²é¢å¤–çš„é€»è¾‘ã€‚</li><li><strong>JWT æœ¬èº«åŒ…å«äº†è®¤è¯ä¿¡æ¯ï¼Œä¸€æ—¦æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—è¯¥ä»¤ç‰Œçš„æ‰€æœ‰æƒé™</strong>ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT çš„æœ‰æ•ˆæœŸåº”è¯¥è®¾ç½®å¾—æ¯”è¾ƒçŸ­ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒé‡è¦çš„æƒé™ï¼Œä½¿ç”¨æ—¶åº”è¯¥å†æ¬¡å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ã€‚</li><li><strong>JWT é€‚åˆä¸€æ¬¡æ€§çš„å‘½ä»¤è®¤è¯ï¼Œé¢å‘ä¸€ä¸ªæœ‰æ•ˆæœŸæçŸ­çš„ JWT</strong>ï¼Œå³ä½¿æš´éœ²äº†å±é™©ä¹Ÿå¾ˆå°ï¼Œç”±äºæ¯æ¬¡æ“ä½œéƒ½ä¼šç”Ÿæˆæ–°çš„ JWTï¼Œå› æ­¤ä¹Ÿæ²¡å¿…è¦ä¿å­˜ JWTï¼ŒçœŸæ­£å®ç°æ— çŠ¶æ€ã€‚</li><li><strong>ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWT ä¸åº”è¯¥ä½¿ç”¨ HTTP åè®®æ˜ç ä¼ è¾“ï¼Œè¦ä½¿ç”¨ HTTPS åè®®ä¼ è¾“ã€‚</strong></li></ul><h3 id="ä½¿ç”¨åŠ å¯†ç®—æ³•æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜"><strong>ä½¿ç”¨åŠ å¯†ç®—æ³•æ—¶éœ€è¦è€ƒè™‘çš„é—®é¢˜</strong></h3><ul><li>ç»ä¸è¦ä»¥<strong>æ˜æ–‡å­˜å‚¨</strong>å¯†ç </li><li><strong>æ°¸è¿œä½¿ç”¨ å“ˆå¸Œç®—æ³• æ¥å¤„ç†å¯†ç ï¼Œç»ä¸è¦ä½¿ç”¨ Base64 æˆ–å…¶ä»–ç¼–ç æ–¹å¼æ¥å­˜å‚¨å¯†ç ï¼Œè¿™å’Œä»¥æ˜æ–‡å­˜å‚¨å¯†ç æ˜¯ä¸€æ ·çš„ï¼Œä½¿ç”¨å“ˆå¸Œï¼Œè€Œä¸è¦ä½¿ç”¨ç¼–ç </strong>ã€‚ç¼–ç ä»¥åŠåŠ å¯†ï¼Œéƒ½æ˜¯åŒå‘çš„è¿‡ç¨‹ï¼Œè€Œå¯†ç æ˜¯ä¿å¯†çš„ï¼Œåº”è¯¥åªè¢«å®ƒçš„æ‰€æœ‰è€…çŸ¥é“ï¼Œ è¿™ä¸ªè¿‡ç¨‹å¿…é¡»æ˜¯å•å‘çš„ã€‚å“ˆå¸Œæ­£æ˜¯ç”¨äºåšè¿™ä¸ªçš„ï¼Œä»æ¥æ²¡æœ‰è§£å“ˆå¸Œè¿™ç§è¯´æ³•ï¼Œ ä½†æ˜¯ç¼–ç å°±å­˜åœ¨è§£ç ï¼ŒåŠ å¯†å°±å­˜åœ¨è§£å¯†ã€‚</li><li>ç»ä¸è¦ä½¿ç”¨å¼±å“ˆå¸Œæˆ–å·²è¢«ç ´è§£çš„å“ˆå¸Œç®—æ³•ï¼Œåƒ MD5 æˆ– SHA1 ï¼Œåªä½¿ç”¨å¼ºå¯†ç å“ˆå¸Œç®—æ³•ã€‚</li><li>ç»ä¸è¦ä»¥æ˜æ–‡å½¢å¼æ˜¾ç¤ºæˆ–å‘é€å¯†ç ï¼Œå³ä½¿æ˜¯å¯¹å¯†ç çš„æ‰€æœ‰è€…ä¹Ÿåº”è¯¥è¿™æ ·ã€‚å¦‚æœä½ éœ€è¦ â€œå¿˜è®°å¯†ç â€ çš„åŠŸèƒ½ï¼Œå¯ä»¥éšæœºç”Ÿæˆä¸€ä¸ªæ–°çš„ <strong>ä¸€æ¬¡æ€§çš„</strong>ï¼ˆè¿™ç‚¹å¾ˆé‡è¦ï¼‰å¯†ç ï¼Œç„¶åæŠŠè¿™ä¸ªå¯†ç å‘é€ç»™ç”¨æˆ·ã€‚</li></ul><h3 id="åˆ†å¸ƒå¼æ¶æ„ä¸‹-session-å…±äº«æ–¹æ¡ˆ"><strong>åˆ†å¸ƒå¼æ¶æ„ä¸‹ session å…±äº«æ–¹æ¡ˆ</strong></h3><h4 id="1-session-å¤åˆ¶"><strong>1. session å¤åˆ¶</strong></h4><ul><li>ä»»ä½•ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ session å‘ç”Ÿæ”¹å˜ï¼ˆå¢åˆ æ”¹ï¼‰ï¼Œè¯¥èŠ‚ç‚¹ä¼šæŠŠè¿™ä¸ª session çš„æ‰€æœ‰å†…å®¹åºåˆ—åŒ–ï¼Œç„¶åå¹¿æ’­ç»™æ‰€æœ‰å…¶å®ƒèŠ‚ç‚¹ï¼Œä¸ç®¡å…¶ä»–æœåŠ¡å™¨éœ€ä¸éœ€è¦ session ï¼Œä»¥æ­¤æ¥ä¿è¯ session åŒæ­¥</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong> å¯å®¹é”™ï¼Œå„ä¸ªæœåŠ¡å™¨é—´ session èƒ½å¤Ÿå®æ—¶å“åº”ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong> ä¼šå¯¹ç½‘ç»œè´Ÿè·é€ æˆä¸€å®šå‹åŠ›ï¼Œå¦‚æœ session é‡å¤§çš„è¯å¯èƒ½ä¼šé€ æˆç½‘ç»œå µå¡ï¼Œæ‹–æ…¢æœåŠ¡å™¨æ€§èƒ½ã€‚</p><h4 id="2-ç²˜æ€§-session-IP-ç»‘å®šç­–ç•¥"><strong>2. ç²˜æ€§ session /IP ç»‘å®šç­–ç•¥</strong></h4><ul><li><strong>é‡‡ç”¨ Ngnix ä¸­çš„ ip_hash æœºåˆ¶ï¼Œå°†æŸä¸ª ip çš„æ‰€æœ‰è¯·æ±‚éƒ½å®šå‘åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå³å°†ç”¨æˆ·ä¸æœåŠ¡å™¨ç»‘å®šã€‚</strong> ç”¨æˆ·ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œè´Ÿè½½å‡è¡¡å™¨å°†ç”¨æˆ·çš„è¯·æ±‚è½¬å‘åˆ°äº† A æœåŠ¡å™¨ä¸Šï¼Œå¦‚æœè´Ÿè½½å‡è¡¡å™¨è®¾ç½®äº†ç²˜æ€§ session çš„è¯ï¼Œé‚£ä¹ˆç”¨æˆ·ä»¥åçš„æ¯æ¬¡è¯·æ±‚éƒ½ä¼šè½¬å‘åˆ° A æœåŠ¡å™¨ä¸Šï¼Œç›¸å½“äºæŠŠç”¨æˆ·å’Œ A æœåŠ¡å™¨ç²˜åˆ°äº†ä¸€å—ï¼Œè¿™å°±æ˜¯ç²˜æ€§ session æœºåˆ¶ã€‚</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong> ç®€å•ï¼Œä¸éœ€è¦å¯¹ session åšä»»ä½•å¤„ç†ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong> ç¼ºä¹å®¹é”™æ€§ï¼Œå¦‚æœå½“å‰è®¿é—®çš„æœåŠ¡å™¨å‘ç”Ÿæ•…éšœï¼Œç”¨æˆ·è¢«è½¬ç§»åˆ°ç¬¬äºŒä¸ªæœåŠ¡å™¨ä¸Šæ—¶ï¼Œä»–çš„ session ä¿¡æ¯éƒ½å°†å¤±æ•ˆã€‚</p><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å‘ç”Ÿæ•…éšœå¯¹å®¢æˆ·äº§ç”Ÿçš„å½±å“è¾ƒå°ï¼›æœåŠ¡å™¨å‘ç”Ÿæ•…éšœæ˜¯ä½æ¦‚ç‡äº‹ä»¶ ã€‚</p><p><strong>å®ç°æ–¹å¼ï¼š</strong> ä»¥ Nginx ä¸ºä¾‹ï¼Œåœ¨ upstream æ¨¡å—é…ç½® ip_hash å±æ€§å³å¯å®ç°ç²˜æ€§ sessionã€‚</p><h4 id="3-session-å…±äº«ï¼ˆå¸¸ç”¨ï¼‰"><strong>3. session å…±äº«ï¼ˆå¸¸ç”¨ï¼‰</strong></h4><ul><li><p>ä½¿ç”¨åˆ†å¸ƒå¼ç¼“å­˜æ–¹æ¡ˆæ¯”å¦‚ Memcached ã€Redis æ¥ç¼“å­˜ sessionï¼Œ<strong>ä½†æ˜¯è¦æ±‚ Memcached æˆ– Redis å¿…é¡»æ˜¯é›†ç¾¤</strong></p></li><li><p>æŠŠ session æ”¾åˆ° Redis ä¸­å­˜å‚¨ï¼Œè™½ç„¶æ¶æ„ä¸Šå˜å¾—å¤æ‚ï¼Œå¹¶ä¸”éœ€è¦å¤šè®¿é—®ä¸€æ¬¡ Redis ï¼Œä½†æ˜¯è¿™ç§æ–¹æ¡ˆå¸¦æ¥çš„å¥½å¤„ä¹Ÿæ˜¯å¾ˆå¤§çš„ï¼š</p><ul><li>å®ç°äº† session å…±äº«ï¼›</li><li>å¯ä»¥æ°´å¹³æ‰©å±•ï¼ˆå¢åŠ  Redis æœåŠ¡å™¨ï¼‰ï¼›</li><li>æœåŠ¡å™¨é‡å¯ session ä¸ä¸¢å¤±ï¼ˆä¸è¿‡ä¹Ÿè¦æ³¨æ„ session åœ¨ Redis ä¸­çš„åˆ·æ–°/å¤±æ•ˆæœºåˆ¶ï¼‰ï¼›</li><li>ä¸ä»…å¯ä»¥è·¨æœåŠ¡å™¨ session å…±äº«ï¼Œç”šè‡³å¯ä»¥è·¨å¹³å°ï¼ˆä¾‹å¦‚ç½‘é¡µç«¯å’Œ APP ç«¯ï¼‰</li></ul></li></ul><h4 id="4-session-æŒä¹…åŒ–"><strong>4. session æŒä¹…åŒ–</strong></h4><ul><li>å°† session å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä¿è¯ session çš„æŒä¹…åŒ–</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong> æœåŠ¡å™¨å‡ºç°é—®é¢˜ï¼Œsession ä¸ä¼šä¸¢å¤±</p><p><strong>ç¼ºç‚¹ï¼š</strong> å¦‚æœç½‘ç«™çš„è®¿é—®é‡å¾ˆå¤§ï¼ŒæŠŠ session å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œä¼šå¯¹æ•°æ®åº“é€ æˆå¾ˆå¤§å‹åŠ›ï¼Œè¿˜éœ€è¦å¢åŠ é¢å¤–çš„å¼€é”€ç»´æŠ¤æ•°æ®åº“ã€‚</p><h3 id="åªè¦å…³é—­æµè§ˆå™¨-ï¼Œsession-çœŸçš„å°±æ¶ˆå¤±äº†ï¼Ÿ"><strong>åªè¦å…³é—­æµè§ˆå™¨ ï¼Œsession çœŸçš„å°±æ¶ˆå¤±äº†ï¼Ÿ</strong></h3><p>ä¸å¯¹ã€‚<strong>å¯¹ session æ¥è¯´ï¼Œé™¤éç¨‹åºé€šçŸ¥æœåŠ¡å™¨åˆ é™¤ä¸€ä¸ª sessionï¼Œå¦åˆ™æœåŠ¡å™¨ä¼šä¸€ç›´ä¿ç•™</strong>ï¼Œç¨‹åºä¸€èˆ¬éƒ½æ˜¯åœ¨ç”¨æˆ·åš log off çš„æ—¶å€™å‘ä¸ªæŒ‡ä»¤å»åˆ é™¤ sessionã€‚</p><p>ç„¶è€Œæµè§ˆå™¨ä»æ¥ä¸ä¼šä¸»åŠ¨åœ¨å…³é—­ä¹‹å‰é€šçŸ¥æœåŠ¡å™¨å®ƒå°†è¦å…³é—­ï¼Œå› æ­¤æœåŠ¡å™¨æ ¹æœ¬ä¸ä¼šæœ‰æœºä¼šçŸ¥é“æµè§ˆå™¨å·²ç»å…³é—­ï¼Œä¹‹æ‰€ä»¥ä¼šæœ‰è¿™ç§é”™è§‰ï¼Œæ˜¯<strong>å¤§éƒ¨åˆ† session æœºåˆ¶éƒ½ä½¿ç”¨ä¼šè¯ cookie æ¥ä¿å­˜ session idï¼Œè€Œå…³é—­æµè§ˆå™¨åè¿™ä¸ª session id å°±æ¶ˆå¤±äº†ï¼Œå†æ¬¡è¿æ¥æœåŠ¡å™¨æ—¶ä¹Ÿå°±æ— æ³•æ‰¾åˆ°åŸæ¥çš„ session</strong>ã€‚</p><p>å¦‚æœæœåŠ¡å™¨è®¾ç½®çš„ cookie è¢«ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œæˆ–è€…ä½¿ç”¨æŸç§æ‰‹æ®µæ”¹å†™æµè§ˆå™¨å‘å‡ºçš„ HTTP è¯·æ±‚å¤´ï¼ŒæŠŠåŸæ¥çš„ session id å‘é€ç»™æœåŠ¡å™¨ï¼Œåˆ™å†æ¬¡æ‰“å¼€æµè§ˆå™¨ä»ç„¶èƒ½å¤Ÿæ‰“å¼€åŸæ¥çš„ sessionã€‚</p><p>æ°æ°æ˜¯<strong>ç”±äºå…³é—­æµè§ˆå™¨ä¸ä¼šå¯¼è‡´ session è¢«åˆ é™¤ï¼Œè¿«ä½¿æœåŠ¡å™¨ä¸º session è®¾ç½®äº†ä¸€ä¸ªå¤±æ•ˆæ—¶é—´ï¼Œå½“è·ç¦»å®¢æˆ·ç«¯ä¸Šä¸€æ¬¡ä½¿ç”¨ session çš„æ—¶é—´è¶…è¿‡è¿™ä¸ªå¤±æ•ˆæ—¶é—´æ—¶ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å·²ç»åœæ­¢äº†æ´»åŠ¨ï¼Œæ‰ä¼šæŠŠ session åˆ é™¤ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚</strong></p><h2 id="é¡¹ç›®åœ°å€"><strong>é¡¹ç›®åœ°å€</strong></h2><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fyjdjiayou%2Fjwt-demo">https://github.com/yjdjiayou/jwt-demo</a></p><h2 id="å·¨äººçš„è‚©è†€ï¼š">å·¨äººçš„è‚©è†€ï¼š</h2><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fjuejin.im%2Fpost%2F6844904034181070861">https://juejin.im/post/6844904034181070861</a><br><a href="https://www.jianshu.com/p/b2e23939ad46">https://www.jianshu.com/p/b2e23939ad46</a><br><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fblog.51cto.com%2Fjamesfancy%2F2065665">https://blog.51cto.com/jamesfancy/2065665</a><br><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fblog.csdn.net%2Fkaixuansui%2Farticle%2Fdetails%2F94433920">https://blog.csdn.net/kaixuansui/article/details/94433920</a><br><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cnblogs.com%2Fyuki-nana%2Fp%2F14001600.html">https://www.cnblogs.com/yuki-nana/p/14001600.html</a><br><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cnblogs.com%2Fxiaozhang2014%2Fp%2F7750200.html">https://www.cnblogs.com/xiaozhang2014/p/7750200.html</a><br><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fmp.weixin.qq.com%2Fs%2Fj-6ngGKRJvB3gfY4VJaU4A">https://mp.weixin.qq.com/s/j-6ngGKRJvB3gfY4VJaU4A</a></p>]]></content>
    
    
    <summary type="html">Cookieã€Sessionã€Token ä¸ JWT è§£æ</summary>
    
    
    
    <category term="Webè®¤è¯" scheme="https://jahaw.github.io/categories/Web%E8%AE%A4%E8%AF%81/"/>
    
    
    <category term="Cookieã€Sessionã€Token ä¸ JWT è§£æ" scheme="https://jahaw.github.io/tags/Cookie%E3%80%81Session%E3%80%81Token-%E4%B8%8E-JWT-%E8%A7%A3%E6%9E%90/"/>
    
  </entry>
  
  <entry>
    <title>Cookie</title>
    <link href="https://jahaw.github.io/posts/8d4cbf50.html"/>
    <id>https://jahaw.github.io/posts/8d4cbf50.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Cookie">Cookie</h3><p><strong>Cookieæ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><ul><li>ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡ŒSessionè·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±å®¢æˆ·ç«¯æš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯ã€‚</li></ul><p><strong>Cookieå·¥ä½œåŸç†</strong></p><ul><li>æœåŠ¡å™¨é¢å‘ç»™å®¢æˆ·ç«¯çš„å”¯ä¸€é€šè¡Œè¯ï¼Œç”¨æ¥è¯†åˆ«å®¢æˆ·ç«¯èº«ä»½</li></ul><p><strong>Cookieç‰¹ç‚¹</strong></p><ul><li>Cookieå­˜å‚¨çš„æ•°æ®é‡æœ‰é™ï¼Œæµè§ˆå™¨ä¸­çš„Cookieå­˜å‚¨çš„æ•°æ®ä¸€èˆ¬ä¸è¶…è¿‡4KB(è¶…å‡ºçš„è¯ï¼Œæœ€æ—©åˆ›å»ºçš„ä¼šè¢«åˆ é™¤)</li><li>æµè§ˆå™¨å¯ä»¥ç¦ç”¨Cookie</li></ul><p><strong>Cookie ç§ç±»</strong></p><ul><li>ä¼šè¯Cookie: å­˜å‚¨åœ¨æµè§ˆå™¨å†…å­˜ä¸­ï¼Œæµè§ˆå™¨åœ¨å…³é—­ä¹‹åè¯¥ Cookie å¤±æ•ˆ(é»˜è®¤: Max-Age: -1)</li><li>æŒä¹…Cookie: å­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„æœ¬åœ°ç£ç›˜ä¸Š,ç”¨äºé•¿ä¹…ä¿æŒç”¨æˆ·ç™»å½•çŠ¶æ€(Max-Age &gt; 0)</li><li>Cookieå¯¹è±¡æœ‰ä¸€ä¸ªMax-Ageå±æ€§ï¼ŒMax-Ageå±æ€§çš„å€¼å°±æ˜¯Cookieçš„ç”Ÿå­˜å‘¨æœŸï¼Œåœ¨è¿™ä¸ªå‘¨æœŸå†…Cookieæœ‰æ•ˆï¼Œè¶…å‡ºå‘¨æœŸCookieå°±ä¼šè¢«æ¸…é™¤</li></ul><p><strong>åº”ç”¨åœºæ™¯</strong></p><ul><li>å¯¹å®‰å…¨è¦æ±‚ä¸é«˜</li><li>ä¸éœ€è¦å­˜å‚¨å¤§é‡æ•°æ®</li><li>ä¸»è¦åº”ç”¨åœºæ™¯<ul><li>ä¼šè¯çŠ¶æ€ç®¡ç†<ul><li>ç”¨æˆ·ç™»å½•çŠ¶æ€<ul><li>æœåŠ¡å™¨åœ¨Cookieä¸­å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ã€å¹¶è®¾ç½®è¿‡æœŸæ—¶é—´</li></ul></li><li>è´­ç‰©è½¦</li><li>æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯</li></ul></li><li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li><li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰<br><img src="images/session/set-cookie.png" alt="set-cookie.png"></li></ul></li></ul><p><strong>Cookieä»€ä¹ˆæ—¶å€™è¢«åˆ›å»ºåŠæ€ä¹ˆæ‰‹åŠ¨åˆ›å»º</strong></p><ul><li>é»˜è®¤åˆ›å»º<ol><li>å½“ç”¨æˆ·è®¿é—®çš„æ˜¯JSPè¿™ç±»æŠ€æœ¯ç¼–å†™çš„é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨ä¸ºè¯¥æµè§ˆå™¨åˆ›å»ºä¸€ä¸ªä¼šè¯Cookie</li><li>å½“ç”¨æˆ·è¯·æ±‚ä¸€ä¸ªservletå¹¶ä¸”è¯¥servletä¸­è°ƒç”¨äº†request.getSession()æ–¹æ³•æ—¶ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨ä¸ºè¯¥æµè§ˆå™¨åˆ›å»ºä¸€ä¸ªä¼šè¯Cookie(æ ¼å¼:JSESSIONID: sessionId)</li></ol></li></ul><h3 id="Sessionè¯¦è§£å®ç°æŒä¹…åŒ–ç”¨æˆ·ç™»å½•çŠ¶æ€">Sessionè¯¦è§£å®ç°æŒä¹…åŒ–ç”¨æˆ·ç™»å½•çŠ¶æ€</h3><p><strong>ä»€ä¹ˆæ˜¯ä¼šè¯</strong></p><ul><li>ä»æœåŠ¡å™¨åˆ›å»ºSessionåˆ°Session è¿‡æœŸçš„è¿‡ç¨‹</li></ul><p><strong>ä»€ä¹ˆæ˜¯Sessionï¼Ÿ</strong></p><ul><li>æœåŠ¡å™¨å‘é€ç»™å®¢æˆ·ç«¯ä¸€ä¸ªä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œä¸Šæœ‰å”¯ä¸€æ ‡è¯†çš„IDï¼Œæ¯æ¬¡è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œæµè§ˆå™¨å‡ºç¤ºè¯¥ä»¤ç‰Œï¼ŒæœåŠ¡å™¨é€šè¿‡ä»¤ç‰Œä¸Šçš„IDæ¥æ‰¾åˆ°å¯¹åº”çš„ç”¨æˆ·</li><li>Sessinoä¿æŒåœ¨æœåŠ¡å™¨ç«¯ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨å¤§é‡æ•°æ®</li></ul><p><strong>Sessionä»€ä¹ˆæ—¶å€™è¢«åˆ›å»ºï¼Ÿ</strong></p><ul><li>å½“ç”¨æˆ·è®¿é—®çš„æ˜¯JSPè¿™ç±»æŠ€æœ¯ç¼–å†™çš„é¡µé¢æ—¶ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨ä¸ºè¯¥æµè§ˆå™¨åˆ›å»ºå”¯ä¸€ä¸€ä¸ªsession</li><li>å¦‚æœè¯·æ±‚çš„æ˜¯servlet,ä¸”è¯¥servletä¸­è°ƒç”¨äº†request.getSession()æ–¹æ³•æ—¶ï¼ŒæœåŠ¡å™¨è‡ªåŠ¨ä¸ºè¯¥æµè§ˆå™¨åˆ›å»ºå”¯ä¸€ä¸€ä¸ªsession</li><li>å¦‚æœæœåŠ¡å™¨æ²¡æœ‰ä¸ºå‘é€è¯·æ±‚çš„æµè§ˆå™¨åˆ›å»ºSessionæ—¶ï¼Œrequest.getSession()ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªSeessionå¹¶è¿”å›;å¦‚æœæœ‰çš„è¯ï¼Œè¯¥æ–¹æ³•ä¼šæ‰¾åˆ°è¿™ä¸ªSessionå¹¶è¿”å›</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å®¢æˆ·ç«¯çš„session,å¦‚æœä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª</span></span><br><span class="line"><span class="type">HttpSession</span> <span class="variable">session</span> <span class="operator">=</span> req.getSession();</span><br><span class="line"> <span class="comment">//è®¾ç½®sessionçš„æœ€å¤§å­˜æ´»æ—¶é—´ä¸º1000s</span></span><br><span class="line">session.setMaxInactiveInterval(<span class="number">1000</span>);</span><br><span class="line"><span class="comment">//é”€æ¯session</span></span><br><span class="line"><span class="comment">//session.invalidate();</span></span><br></pre></td></tr></table></figure><p><strong>è®¾ç½®Cookie?</strong></p><ul><li>é€šè¿‡set-cookie åœ¨è¯¥æ¬¡å“åº”å¤´ä¸­è®¾ç½®session ID ï¼Œå¹¶è¿”å›è¯¥å“åº”å¤´ç»™å®¢æˆ·ç«¯</li></ul><p><strong>Sessionä¸Cookieç»“åˆä½¿ç”¨</strong></p><ul><li>å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ç«¯å‘é€äº†ä¸€ä¸ªæºæœ‰Cookieè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šæŠŠæ­¤ Cookies æ”¾åˆ°è¯·æ±‚å¤´ä¸€èµ·æäº¤ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡æ­¤Cookies çš„valueå±æ€§å€¼æ¥æ‰¾åˆ°å¯¹åº”çš„Sessionï¼Œ ç„¶åå†é€šè¿‡è¯¥ Session æ¥è·å¾—å­˜åœ¨è¯¥å¯¹è±¡ä¸­çš„ä¿¡æ¯</li></ul><p><strong>Cookie å’Œ Session æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</strong></p><ol><li>ä½œç”¨èŒƒå›´ä¸åŒï¼ŒCookie ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ï¼ŒSession ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯ã€‚</li><li>å­˜å–æ–¹å¼çš„ä¸åŒï¼ŒCookie åªèƒ½ä¿å­˜ ASCIIï¼ŒSession å¯ä»¥å­˜ä»»æ„æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥åœ¨ Session ä¸­ä¿æŒä¸€äº›å¸¸ç”¨å˜é‡ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ UserId ç­‰ã€‚</li><li>æœ‰æ•ˆæœŸä¸åŒï¼ŒCookie å¯è®¾ç½®ä¸ºé•¿æ—¶é—´ä¿æŒï¼Œæ¯”å¦‚æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„é»˜è®¤ç™»å½•åŠŸèƒ½ï¼ŒSession ä¸€èˆ¬å¤±æ•ˆæ—¶é—´è¾ƒçŸ­ï¼Œå®¢æˆ·ç«¯å…³é—­æˆ–è€… Session è¶…æ—¶éƒ½ä¼šå¤±æ•ˆã€‚</li></ol>]]></content>
    
    
    <summary type="html">Cookie</summary>
    
    
    
    <category term="Webè®¤è¯" scheme="https://jahaw.github.io/categories/Web%E8%AE%A4%E8%AF%81/"/>
    
    
    <category term="Cookie" scheme="https://jahaw.github.io/tags/Cookie/"/>
    
  </entry>
  
  <entry>
    <title>Token</title>
    <link href="https://jahaw.github.io/posts/9ef68e3f.html"/>
    <id>https://jahaw.github.io/posts/9ef68e3f.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<p>Tokençš„å®šä¹‰ï¼š</p><ol><li>Tokenæ˜¯æœåŠ¡ç«¯ç”Ÿæˆçš„ä¸€ä¸ªå­—ç¬¦ä¸²</li><li>ç”¨ä½œå®¢æˆ·ç«¯è¯·æ±‚æ•°æ®éªŒè¯ï¼Œé¿å…æ•°æ®åº“çš„é¢‘é“æŸ¥è¯¢ï¼Œç”Ÿæˆåå­˜å‚¨åœ¨sessionä¸­</li></ol><p>ä½¿ç”¨Tokençš„ç›®çš„ï¼š<br>éªŒè¯ç”¨æˆ·ç™»é™†æƒ…å†µã€å‡è½»æœåŠ¡å™¨æŸ¥è¯¢å‹åŠ›(ä»redis ä¸­ æŸ¥è¯¢session å‹åŠ›)</p><p>JWT:<br>ä¸€ä¸ªTokenå­—ç¬¦ä¸²,ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå¤´éƒ¨ã€è½½è·ä¸ç­¾å<br>çº¢è‰²çš„ä¸ºå¤´éƒ¨Header<br>ç´«è‰²çš„ä¸ºè½½è·playload<br>è“è‰²çš„ä¸ºç­¾åSignature</p><p>Header: ç­¾åçš„ç®—æ³•ç±»å‹HS256+JWT<br>Payload: åŒ…å«è¿‡æœŸæ—¶é—´ã€ç­¾å‘æ—¶é—´ã€ç”¨æˆ·IDç­‰ä¿¡æ¯<br>Signatureï¼šå¯¹ä¸Šè¾¹ä¸¤å­—ç¬¦ä¸²è¿›è¡ŒäºŒæ¬¡åŠ å¯†ï¼ˆé˜²æ­¢tokenè¢«ç¯¡æ”¹ï¼‰</p>]]></content>
    
    
    <summary type="html">Token</summary>
    
    
    
    <category term="Webè®¤è¯" scheme="https://jahaw.github.io/categories/Web%E8%AE%A4%E8%AF%81/"/>
    
    
    <category term="Token" scheme="https://jahaw.github.io/tags/Token/"/>
    
  </entry>
  
  <entry>
    <title>w3cschoolSql</title>
    <link href="https://jahaw.github.io/posts/a68635.html"/>
    <id>https://jahaw.github.io/posts/a68635.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.328Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  @<span class="variable">@FOREIGN_KEY_CHECKS</span>;</span><br><span class="line">use w3cschool;</span><br><span class="line"><span class="keyword">SET</span> NAMES utf8;</span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `w3cschool_tbl`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> w3cschool_tbl(</span><br><span class="line">   w3cschool_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">   w3cschool_title <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   w3cschool_author <span class="type">VARCHAR</span>(<span class="number">40</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">   submission_date <span class="type">DATE</span>,</span><br><span class="line">   <span class="keyword">PRIMARY</span> KEY ( w3cschool_id )</span><br><span class="line">  ) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> w3cschool_tbl </span><br><span class="line">     (w3cschool_title, w3cschool_author, submission_date)</span><br><span class="line">     <span class="keyword">VALUES</span></span><br><span class="line">     (&quot;Learn PHP&quot;, &quot;John Poul&quot;, NOW()),</span><br><span class="line"> (&quot;Learn MySQL&quot;, &quot;Abdul S&quot;, NOW()),</span><br><span class="line"> (&quot;JAVA Tutorial&quot;, &quot;Sanjay&quot;, <span class="string">&#x27;2007-05-06&#x27;</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">--  Table structure for `employee_tbl`</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `employee_tbl`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employee_tbl` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `name` <span class="type">char</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  `<span class="type">date</span>` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `singin` tinyint(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;ç™»å½•æ¬¡æ•°&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">--  Records of `employee_tbl`</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `employee_tbl` <span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="string">&#x27;2016-04-22 15:25:33&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;å°ç‹&#x27;</span>, <span class="string">&#x27;2016-04-20 15:25:47&#x27;</span>, <span class="string">&#x27;3&#x27;</span>), (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;å°ä¸½&#x27;</span>, <span class="string">&#x27;2016-04-19 15:26:02&#x27;</span>, <span class="string">&#x27;2&#x27;</span>), (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;å°ç‹&#x27;</span>, <span class="string">&#x27;2016-04-07 15:26:14&#x27;</span>, <span class="string">&#x27;4&#x27;</span>), (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="string">&#x27;2016-04-11 15:26:40&#x27;</span>, <span class="string">&#x27;4&#x27;</span>), (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;å°æ˜&#x27;</span>, <span class="string">&#x27;2016-04-04 15:26:54&#x27;</span>, <span class="string">&#x27;2&#x27;</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tcount_tbl` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `w3cschool_author` <span class="type">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">`w3cschool_count` <span class="type">int</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tcount_tbl` (w3cschool_author, w3cschool_count) </span><br><span class="line">  <span class="keyword">VALUES</span> (<span class="string">&#x27;mahran&#x27;</span>, <span class="number">20</span>),(<span class="string">&#x27;mahnaz&#x27;</span>, <span class="number">10</span>),(<span class="string">&#x27;Jen&#x27;</span>, <span class="number">60</span>),(<span class="string">&#x27;Gill&#x27;</span>, <span class="number">45</span>),(<span class="string">&#x27;John Poul&#x27;</span>, <span class="number">5</span>),(<span class="string">&#x27;Sanjay&#x27;</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> FOREIGN_KEY_CHECKS <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> tables;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> name ,<span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">from</span> employee_tbl <span class="keyword">GROUP</span> <span class="keyword">BY</span> name;</span><br><span class="line"><span class="keyword">SELECT</span> name, <span class="built_in">SUM</span>(singin) <span class="keyword">as</span> singin_count <span class="keyword">from</span> employee_tbl <span class="keyword">GROUP</span> <span class="keyword">BY</span> name <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">coalesce</span>(name, <span class="string">&#x27;æ€»æ•°&#x27;</span>), <span class="built_in">SUM</span>(singin) <span class="keyword">as</span> singin_count <span class="keyword">from</span> employee_tbl <span class="keyword">GROUP</span> <span class="keyword">BY</span> name <span class="keyword">WITH</span> <span class="keyword">ROLLUP</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> a.w3cschool_id, a.w3cschool_author, b.w3cschool_count <span class="keyword">FROM</span> w3cschool_tbl a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> tcount_tbl b <span class="keyword">ON</span> a.w3cschool_author <span class="operator">=</span> b.w3cschool_author;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">w3cschool.sql</summary>
    
    
    
    <category term="SQL" scheme="https://jahaw.github.io/categories/SQL/"/>
    
    
    <category term="SQL" scheme="https://jahaw.github.io/tags/SQL/"/>
    
  </entry>
  
  <entry>
    <title>ç¬¬ä¸‰æ–¹Cookie</title>
    <link href="https://jahaw.github.io/posts/304cbca6.html"/>
    <id>https://jahaw.github.io/posts/304cbca6.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<h3 id="ç¬¬ä¸‰æ–¹Cookie">ç¬¬ä¸‰æ–¹Cookie</h3><p><strong>Cookie ä½œç”¨</strong></p><ol><li>è®°å½•ç½‘é¡µä¸Šç”¨æˆ·çŠ¶æ€ã€æµè§ˆæ´»åŠ¨</li><li>ä¾¿äºè¿›è¡Œç”¨æˆ·ç”»åƒè®¾å®š</li><li>ç½‘ç«™ä¸€å®šæœŸé™å†…å…ç™»å½•</li></ol><p><strong>åœºæ™¯</strong></p><ul><li>ç”¨æˆ·è®¿é—® <a href="http://www.baidu.com">www.baidu.com</a>, è¿”å›é¡µé¢ä¸­å†…åµŒ ç¬¬ä¸‰æ–¹å¹¿å‘Šä¿¡æ¯ï¼Œæ¯”å¦‚ç“œå­äºŒæ‰‹è½¦(ç›®æ ‡ç«™ç‚¹è®¿é—®äº†ç¬¬ä¸‰æ–¹åŸŸåæä¾›çš„åŠŸèƒ½)</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€æ–¹cookieï¼š ç”±ç™¾åº¦æœåŠ¡å™¨åˆ›å»º</span><br><span class="line">ç¬¬ä¸‰æ–¹cookieï¼š ç”±ç“œå­äºŒæ‰‹è½¦æœåŠ¡å™¨åˆ›å»º</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰æ–¹cookieè®°å½•äº†å½“å‰ç”¨æˆ·çš„æµè§ˆè®°å½•åŠå–œå¥½ï¼Œå½“ä½ è®¿é—®ç¬¬ä¸‰æ–¹åŸŸåæ—¶ï¼Œå¯¹ç”¨æˆ·è¿›è¡Œä¸ªæ€§åŒ–å¹¿å‘Šæ¨è</span><br></pre></td></tr></table></figure><p>ç¦ç”¨åç¬¬ä¸€æ–¹cookieå­˜å‚¨çš„ç”¨æˆ·æ•°æ® ä»·å€¼æ›´å¤§<br>å¯»æ‰¾æ–°çš„å¹¿å‘Šæ¨èæ›¿ä»£cookie</p><p>ä¾èµ–ç¬¬ä¸‰æ–¹cookieå°å…¬å¸é¢ä¸´å€’é—­ï¼Œå„å¤§æœç´¢å¼•æ“å‚å•†å½¢æˆå„æ–­</p><p>æ–°çš„å¹¿å‘Šæ¨èæ–¹æ¡ˆï¼š</p><ol><li>å°†ç›¸åŒå–œå¥½çš„ç”¨æˆ·å½’ç»„ï¼Œè¿›è¡Œé›†ä½“æ¨è</li></ol><p>ç§»åŠ¨ç«¯ï¼š<br>æ‰‹æœºAPPç´¢è¦çš„å„ç§æƒé™ã€éšç§æ¡æ¬¾éƒ½è¢«ç”¨æ¥è¿›è¡Œç”¨æˆ·ç”»åƒè®¾å®š</p><p>å¦‚æœç¦äº†ç¬¬ä¸‰æ–¹cookieï¼Œé‚£ä¹ˆå¹¿å‘Šæ¨é€æŠ€æœ¯å°±åªå‰©ä¸‹äº†ä¸€ç§ï¼šç¬¬ä¸€æ–¹æ¨é€ç”¨æˆ·æ•°æ®ç»™å¹¿å‘Šå•†ï¼Œå¹¿å‘Šå•†å†åˆ†ææ•°æ®æ¨é€å¹¿å‘Šã€‚<br>å¥½å¤„ï¼š<br>è´£ä»»æ˜ç¡®ï¼Œç”¨æˆ·éœ€è¦å…è®¸æ¨é€çš„éšç§å†…å®¹<br>ç¬¬ä¸€æ–¹åªèƒ½æ¨é€ç”¨æˆ·å…è®¸æ¨é€çš„éšç§å†…å®¹<br>ç¬¬ä¸‰æ–¹æ— æ³•æ“…è‡ªè·å¾—ç”¨æˆ·éšç§</p>]]></content>
    
    
    <summary type="html">ç¬¬ä¸‰æ–¹Cookie</summary>
    
    
    
    <category term="Webè®¤è¯" scheme="https://jahaw.github.io/categories/Web%E8%AE%A4%E8%AF%81/"/>
    
    
    <category term="ç¬¬ä¸‰æ–¹Cookie" scheme="https://jahaw.github.io/tags/%E7%AC%AC%E4%B8%89%E6%96%B9Cookie/"/>
    
  </entry>
  
  <entry>
    <title>ä¸´æ—¶è®°å½•</title>
    <link href="https://jahaw.github.io/posts/b916a8dc.html"/>
    <id>https://jahaw.github.io/posts/b916a8dc.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<h3 id="Hadoop-é›†ç¾¤è¿è¡Œjar-åŒ…">Hadoop é›†ç¾¤è¿è¡Œjar åŒ…</h3><p><a href="https://blog.csdn.net/weixin_49429575/article/details/109599272">https://blog.csdn.net/weixin_49429575/article/details/109599272</a></p><h3 id="å¤§æ•°æ®å¹³å°æ˜¯å¦æ›´åº”è¯¥å®¹å™¨åŒ–">å¤§æ•°æ®å¹³å°æ˜¯å¦æ›´åº”è¯¥å®¹å™¨åŒ–</h3><p><a href="https://blog.csdn.net/rlnlo2pnefx9c/article/details/107171331">https://blog.csdn.net/rlnlo2pnefx9c/article/details/107171331</a></p><p>ç”µè¯ˆè®¿é—®åœ°å€ï¼š<br><a href="https://www.gaoxin-fraud.9sdata.cn/management.html">https://www.gaoxin-fraud.9sdata.cn/management.html</a></p><p>æ¸­å—é¡¹ç›®è®¿é—®åœ°å€ï¼š<br><a href="https://www.service-bj.9sdata.cn/">https://www.service-bj.9sdata.cn/</a></p><p>3d earth:<br><a href="https://2050.earth/?ref=sheui.com">https://2050.earth/?ref=sheui.com</a><br><a href="https://zhuanlan.zhihu.com/p/35120118">https://zhuanlan.zhihu.com/p/35120118</a><br><a href="https://wow.techbrood.com/fiddle/38828">https://wow.techbrood.com/fiddle/38828</a></p><p>ä¸€äº›ä½ä»£ç äº§å“å’Œå¹³å°<br><a href="http://boot.jeecg.com/user/login">http://boot.jeecg.com/user/login</a><br><a href="http://demo.ruoyi.vip/index">http://demo.ruoyi.vip/index</a><br><a href="https://www.mingdao.com/app/my">https://www.mingdao.com/app/my</a><br><a href="https://www.jiandaoyun.com/dashboard#/">https://www.jiandaoyun.com/dashboard#/</a></p><h2 id="UIè®¾è®¡ç½‘ç«™">UIè®¾è®¡ç½‘ç«™</h2><ol><li><a href="https://js.design/">https://js.design/</a></li><li><a href="https://codesign.qq.com/app/design">https://codesign.qq.com/app/design</a></li><li>figma</li><li>è“æ¹–</li></ol><p>export JAVA_HOME=/usr/java/jdk1.7.0_67<br>export JAVA_BIN=/usr/java/jdk1.7.0_67/bin<br>export PATH=$PATH:$JAVA_HOME/bin<br>export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar<br>export JAVA_HOMEJAVA_BINPATHCLASSPATH</p><p>#set hadoop path<br>export HADOOP_HOME=/home/hadoop/software/hadoop<br>export PATH=$PATH:$HADOOP_HOME/bin</p><p>#set scala path<br>export SCALA_HOME=/home/hadoop/software/scala-2.11.4<br>export PATH=$PATH:$SCALA_HOME/bin</p><p>#set spark path<br>export SPARK_HOME=/home/hadoop/software/spark-1.6.1-bin-hadoop2.6<br>export PATH=$PATH:$SPARK_HOME/bin</p><p>export  YARN_CONF_DIR=/home/hadoop/platform-config<br>export HADOOP_CONF_DIR=/home/hadoop/platform-config</p><h2 id="dom-æµç•…æ»šåŠ¨">dom æµç•…æ»šåŠ¨</h2><p>element.scrollIntoView({block:â€˜startâ€™,behavior:â€˜smoothâ€™})<br>element.scrollTo(0, 0)</p><h2 id="ä¿®æ­£-å•é¡µåº”ç”¨åœ¨-ie-ä¸‹ä¸å…¼å®¹é—®é¢˜">ä¿®æ­£ å•é¡µåº”ç”¨åœ¨ ie ä¸‹ä¸å…¼å®¹é—®é¢˜</h2><p>config.entry.app = [â€˜babel-polyfillâ€™, â€˜eventsource-polyfillâ€™, â€˜./src/main.jsâ€™];</p><p>@yanhaijing/console_js// console åœ¨ ä½ç‰ˆæœ¬ ie ä¸‹ ä¸º undefined<br>autoprefixer      // postcss è‡ªåŠ¨å¡«å…… å‰ç¼€<br>es6-promise<br>ie-placeholder  // å¤„ç† IE ä¸‹ input placeholder é—®é¢˜<br>element-dataset// ä¿®æ­£ HTMLElement.dataset å±æ€§</p><ul><li><p>å¯è§†åŒ–</p><ul><li>3d åœ°çƒ</li><li>BI å¯è§†åŒ–</li><li>çŸ¥è¯†å›¾è°±</li><li>åœ¨çº¿ excel ç¼–è¾‘å™¨</li></ul><p>quest 1: å¦‚ä½•å®ç° class åªèƒ½è¢« new ä¸èƒ½è¢« ç›´æ¥è°ƒç”¨</p></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Parent</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">a</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">filed1</span> = a;</span><br><span class="line">  &#125;</span><br><span class="line">  filed2 = <span class="number">2</span>;</span><br><span class="line">  func1 = <span class="keyword">function</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">babel ç¼–è¯‘å</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">_classCallCheck</span>(<span class="params">instance, Constructor</span>) &#123;</span><br><span class="line">ã€€<span class="comment">// instanceof æ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚</span></span><br><span class="line">  <span class="keyword">if</span> (!(instance <span class="keyword">instanceof</span> <span class="title class_">Constructor</span>)) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">TypeError</span>(<span class="string">&quot;Cannot call a class as a function&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> _Parent = <span class="keyword">function</span> <span class="title function_">Parent</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  <span class="title function_">_classCallCheck</span>(<span class="variable language_">this</span>, _Parent);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">filed2</span> = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">func1</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">filed1</span> = a;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡ new æ“ä½œç¬¦ åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> instance = <span class="keyword">new</span> <span class="title class_">Parent</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;instance&#x27;</span>, instance);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›´æ¥è°ƒç”¨</span></span><br><span class="line"><span class="title class_">Parent</span>();</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ä¸´æ—¶è®°å½•</summary>
    
    
    
    <category term="ä¸´æ—¶è®°å½•" scheme="https://jahaw.github.io/categories/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="ä¸´æ—¶è®°å½•" scheme="https://jahaw.github.io/tags/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
  <entry>
    <title>ISOã€GMTã€UTCåŒºåˆ«</title>
    <link href="https://jahaw.github.io/posts/7e38c7f4.html"/>
    <id>https://jahaw.github.io/posts/7e38c7f4.html</id>
    <published>2023-06-21T07:31:42.000Z</published>
    <updated>2023-07-18T13:37:03.329Z</updated>
    
    <content type="html"><![CDATA[<p><strong>ISOã€GMTã€UTCåŒºåˆ«</strong></p><ul><li>ISO å›½é™…æ ‡å‡†åŒ–ç»„ç»‡çš„æ—¥æœŸå’Œæ—¶é—´çš„è¡¨ç¤ºæ–¹æ³•</li></ul><blockquote><p>å­—æ¯Tï¼šæ—¥æœŸå’Œæ—¶é—´çš„åˆ†éš”ç¬¦<br>å­—æ¯Zï¼šè¡¨ç¤ºUTCæ—¶é—´ï¼ˆå¯ç®€å•ç†è§£ä¸ºæ˜¯0æ—¶åŒºï¼‰ï¼›ä¹Ÿå¯ç”¨4ä½æ•°å­—æ ¼å¼çš„æ—¶é—´åç§»é‡ä»£æ›¿ï¼›ä¸å†™çš„æ—¶å€™è¡¨ç¤ºä¸åç§»(å½“å‰æ—¶åŒº)</p></blockquote><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¾‹å­ï¼š</span></span><br><span class="line"><span class="attribute">2019</span>-<span class="number">09</span>-<span class="number">26</span>T03:<span class="number">45</span>:<span class="number">36</span>.<span class="number">656</span>ZÂ Â     //Â <span class="number">0</span>æ—¶åŒºçš„<span class="number">2019</span>å¹´<span class="number">9</span>æœˆ<span class="number">26</span>æ—¥<span class="number">3</span>ç‚¹<span class="number">45</span>åˆ†<span class="number">36</span>ç§’<span class="number">656</span>æ¯«ç§’</span><br><span class="line"><span class="attribute">2019</span>-<span class="number">09</span>-<span class="number">26</span>T03:<span class="number">45</span>:<span class="number">36</span>.<span class="number">656</span>-<span class="number">0800</span>Â  //Â è¥¿å…«åŒºçš„<span class="number">2019</span>å¹´<span class="number">9</span>æœˆ<span class="number">26</span>æ—¥<span class="number">3</span>ç‚¹<span class="number">45</span>åˆ†<span class="number">36</span>ç§’<span class="number">656</span>æ¯«ç§’</span><br><span class="line"><span class="attribute">2019</span>-<span class="number">09</span>-<span class="number">26</span>T03:<span class="number">45</span>:<span class="number">36</span>.<span class="number">656</span>+<span class="number">0800</span>Â  //Â ä¸œå…«åŒºçš„<span class="number">2019</span>å¹´<span class="number">9</span>æœˆ<span class="number">26</span>æ—¥<span class="number">3</span>ç‚¹<span class="number">45</span>åˆ†<span class="number">36</span>ç§’<span class="number">656</span>æ¯«ç§’</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»¥ä¸‹æ˜¯ISOæ ¼å¼çš„å„ç§æƒ…å†µè½¬æ¢ä¸º GMT+0800ï¼ˆä¸œ8åŒºæ—¶é—´ï¼‰ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">new</span> Date(&#x27;<span class="number">2019</span>-<span class="number">09</span>-<span class="number">25</span>T18:<span class="number">00</span>:<span class="number">14</span>&#x27;);      // ä¸å†™z</span><br><span class="line"></span><br><span class="line"><span class="attribute">Wed</span> Sep <span class="number">25</span> <span class="number">2019</span> <span class="number">18</span>:<span class="number">00</span>:<span class="number">14</span> GMT+<span class="number">0800</span> (ä¸­å›½æ ‡å‡†æ—¶é—´)</span><br><span class="line"></span><br><span class="line"><span class="attribute">new</span> Date(&#x27;<span class="number">2019</span>-<span class="number">09</span>-<span class="number">25</span>T18:<span class="number">00</span>:<span class="number">14</span>z&#x27;);    // ç»“å°¾æ˜¯z</span><br><span class="line"></span><br><span class="line"><span class="attribute">Thu</span> Sep <span class="number">26</span> <span class="number">2019</span> <span class="number">02</span>:<span class="number">00</span>:<span class="number">14</span> GMT+<span class="number">0800</span> (ä¸­å›½æ ‡å‡†æ—¶é—´)</span><br><span class="line"></span><br><span class="line"><span class="attribute">new</span> Date(&#x27;<span class="number">2019</span>-<span class="number">09</span>-<span class="number">25</span>T18:<span class="number">00</span>:<span class="number">14</span>+<span class="number">0000</span>&#x27;);  // <span class="number">0</span>æ—¶åŒº</span><br><span class="line"></span><br><span class="line"><span class="attribute">Thu</span> Sep <span class="number">26</span> <span class="number">2019</span> <span class="number">02</span>:<span class="number">00</span>:<span class="number">14</span> GMT+<span class="number">0800</span> (ä¸­å›½æ ‡å‡†æ—¶é—´)</span><br><span class="line"></span><br><span class="line"><span class="attribute">new</span> Date(&#x27;<span class="number">2019</span>-<span class="number">09</span>-<span class="number">25</span>T18:<span class="number">00</span>:<span class="number">14</span>+<span class="number">0800</span>&#x27;);  // ä¸œ<span class="number">8</span>åŒº</span><br><span class="line"></span><br><span class="line"><span class="attribute">Wed</span> Sep <span class="number">25</span> <span class="number">2019</span> <span class="number">18</span>:<span class="number">00</span>:<span class="number">14</span> GMT+<span class="number">0800</span> (ä¸­å›½æ ‡å‡†æ—¶é—´)</span><br><span class="line"></span><br><span class="line"><span class="attribute">new</span> Date(&#x27;<span class="number">2019</span>-<span class="number">09</span>-<span class="number">25</span>T18:<span class="number">00</span>:<span class="number">14</span>-<span class="number">0800</span>&#x27;);  // è¥¿<span class="number">8</span>åŒº</span><br><span class="line"></span><br><span class="line"><span class="attribute">Thu</span> Sep <span class="number">26</span> <span class="number">2019</span> <span class="number">10</span>:<span class="number">00</span>:<span class="number">14</span> GMT+<span class="number">0800</span> (ä¸­å›½æ ‡å‡†æ—¶é—´)</span><br></pre></td></tr></table></figure><ul><li><p>GMT æ ¼æ—å¨æ²»æ—¶é—´ï¼ˆ0æ—¶åŒºæ—¶é—´ï¼‰</p></li><li><p>UTC ä¸–ç•Œæ ‡å‡†æ—¶ï¼ˆæ ¹æ®GMTæ—¶é—´è®¡ç®—å¾—æ¥ï¼Œæ¯”GMTæ›´åŠ ç²¾ç¡®ï¼Œè¯¯å·®åœ¨0.9ç§’ä»¥å†…ï¼‰</p></li></ul>]]></content>
    
    
    <summary type="html">ISOã€GMTã€UTCåŒºåˆ«</summary>
    
    
    
    <category term="ä¸´æ—¶è®°å½•" scheme="https://jahaw.github.io/categories/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="ä¸´æ—¶è®°å½•" scheme="https://jahaw.github.io/tags/%E4%B8%B4%E6%97%B6%E8%AE%B0%E5%BD%95/"/>
    
  </entry>
  
</feed>
